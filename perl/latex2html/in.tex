%LaTeX
\documentclass[11pt,draft,openany,oneside]{book}
\usepackage{czech,latexsym}
\pagestyle{headings}

%\usepackage{graphics,amssymb,eucal,xy}
%\xyoption{all}
%\xyoption{ps}
%\UsePSspecials{Textures}

\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{theorem}[lemma]{Vìta}
\newtheorem{proposition}[lemma]{Tvrzení}
\newtheorem{corollary}[lemma]{Dùsledek}
\newtheorem{claim}{Claim}

\newtheorem{definition}[lemma]{Definice}
\newtheorem{example}[lemma]{Pøíklad}
\newtheorem{cviceni}{Cvièení}[chapter]
\newtheorem{uloha}{Úloha}[chapter]
\setcounter{chapter}{0}

\newenvironment{proof}{\textbf{Dùkaz.}}{~$\Box$\smallskip}
\newenvironment{reseni}{\textbf{Øe¹ení.}}{~$\Box$\smallskip}

\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\BB}{\mathbf{B}}
\newcommand{\bAA}{\mathbf{A}}
\newcommand{\DD}{\mathbf{D}}
\newcommand{\TT}{\mathbf{T}}
\newcommand{\UU}{\mathbf{U}}
\newcommand{\II}{\mathbf{I}}
\newcommand{\LL}{\mathbf{L}}
\newcommand{\MM}{\mathbf{M}}
\newcommand{\NN}{\mathbf{N}}
\newcommand{\PP}{\mathbf{P}}
\newcommand{\bQQ}{\mathbf{Q}}
\newcommand{\OO}{\mathbf{O}}
\newcommand{\EE}{\mathbf{E}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\GG}{\mathbf{G}}
\newcommand{\veu}{\mathbf{u}}
\newcommand{\vev}{\mathbf{v}}
\newcommand{\vew}{\mathbf{w}}
\newcommand{\vex}{\mathbf{x}}
\newcommand{\vey}{\mathbf{y}}
\newcommand{\vez}{\mathbf{z}}
\newcommand{\veb}{\mathbf{b}}
\newcommand{\ved}{\mathbf{d}}
\newcommand{\vea}{\mathbf{a}}
\newcommand{\cc}{\mathbf{c}}
\newcommand{\ee}{\mathbf{e}}
\newcommand{\veh}{\mathbf{h}}
\newcommand{\vep}{\mathbf{p}}
\newcommand{\veq}{\mathbf{q}}
\newcommand{\ver}{\mathbf{r}}
\newcommand{\nul}{\mathbf{0}}

\newcommand{\RRR}{\mathcal{R}}
\newcommand{\SSS}{\mathcal{S}}
\newcommand{\TTT}{\mathcal{T}}
\newcommand{\QQQ}{\mathcal{Q}}
\newcommand{\CCC}{\mathcal{C}}
\newcommand{\ZZZ}{\mathcal{Z}}
\newcommand{\UUU}{\mathcal{U}}
\newcommand{\VVV}{\mathcal{V}}
\newcommand{\WWW}{\mathcal{W}}
\newcommand{\NNN}{\mathcal{N}}
\newcommand{\LLL}{\mathcal{L}}
\newcommand{\MMM}{\mathcal{M}}

\newcommand{\ZZn}{\mathbf{Z}_n}
\newcommand{\quo}{\,\mathrm{quo}\,}
\newcommand{\rem}{\,\mathrm{rem}\,}
\newcommand{\mod}{\,\mathrm{mod}\,}

\newcommand{\Txp}{\TT[x]/(p)}

\begin{document}

\title{\textbf{\Huge Lineární algebra I}}
\author{\textbf{\Large Jiøí Tùma}}
\maketitle

\chapter{Lineární rovnice a jejich soustavy}

\begin{uloha}\label{U:kvadrat}
Najdìte kvadratickou funkci $ax^2+bx+c=y$, její¾ graf prochází body $(0,3)$, $(1,2)$ a $(2,3)$.
\end{uloha}

\begin{reseni}
Tøi uvedené body musí vyhovovat rovnici $y=ax^2+bx+c$. Musí proto platit
\begin{eqnarray*}
a0\,+\,b0\,+\,c\,=&3,\\
a1\,+\,b1\,+\,c\,=&2,\\
a4\,+\,b2\,+\,c\,=&3.
\end{eqnarray*}
Neznámé koeficienty $a,b,c$ tak najdeme jako øe¹ení soustavy tøí lineárních rovnic o tøech neznámých
\begin{eqnarray*}
0a\,+\,0b\,+\,1c\,\,=&3,\\
1a\,+\,1b\,+\,1c\,\,=&2,\\
4a\,+\,2b\,+\,1c\,\,=&3.
\end{eqnarray*}
První rovnice urèuje koeficient $c=3$ a po dosazení do zbývajících dvou rovnic dostaneme
\begin{eqnarray*}
1a\,+\,1b\,\,=&-1\\
4a\,+\,2b\,\,=&0.
\end{eqnarray*}
Odeètením ètyønásobku druhé rovnice od tøetí dostaneme
\[
-2\,b\,\,=\,\,4,
\]
tj. $b=-2$ a dosazením do druhé rovnice najdeme poslední koøen $a=1$. Hledaná kvadratická funkce se rovná
\[
y=x^2-2x+3.
\]
\end{reseni}

Rovnice, které jsme øe¹ili, se nazývají \emph{lineární}, proto¾e obsahují pouze první mocniny neznámých a neobsahují ani ¾ádný souèin neznámých. Rovnice $2x^2=3$, $x+y^{-1}=2$ nebo $x+xy=5z$ \emph{nejsou} lineární.

K øe¹ení soustav lineárních rovnic vedou i jiné úlohy, které na první pohled lineární nejsou.

\begin{uloha}\label{U:kruznice}
Najdìte rovnici kru¾nice, která prochází body $(x_1,y_1)$, $(x_2,y_2)$ a $(x_3,y_3)$.
\end{uloha}

\begin{reseni}
Obecná rovnice kru¾nice v kartézských souøadnicích je 
\[
(x-a)^2+(y-b)^2=c^2,
\] 
kde $(a,b)$ jsou souøadnice støedu kru¾nice a $c>0$ je její polomìr. Dosadíme-li do této rovnice souøadnice bodù $(x_1,y_1)$, $(x_2,y_2)$ a $(x_3,y_3)$, dostaneme soustavu rovnic
\begin{eqnarray*}
(x_1-a)^2\,+\,(y_1-b)^2\,\,=&c^2,\\
(x_2-a)^2\,+\,(y_2-b)^2\,\,=&c^2,\\
(x_3-a)^2\,+\,(y_3-b)^2\,\,=&c^2.
\end{eqnarray*}
Po roznásobení dostaneme pro neznámé $a,b,c$ rovnice
\begin{eqnarray*}
x_1^2-2x_1a+a^2+y_1^2-2y_1b+b^2&=&c^2,\\
x_2^2-2x_2a+a^2+y_2^2-2y_2b+b^2&=&c^2,\\
x_3^2-2x_3a+a^2+y_3^2-2y_3b+b^2&=&c^2.
\end{eqnarray*}
Toto není soustava lineárních rovnic, nicménì výpoèet souøadnic $(a,b)$ støedu hledané kru¾nice mù¾eme pøevést na øe¹ení soustavy dvou lineárních rovnic o dvou neznámých tím, ¾e postupnì odeèteme druhou rovnici od první a potom tøetí rovnici od druhé. Dostaneme tak soustavu
\begin{eqnarray*}
x_1^2-x_2^2-2(x_1-x_2)a+y_1^2-y_2^2-2(y_1-y_2)b&=&0,\\
x_2^2-x_3^2-2(x_2-x_3)a+y_2^2-y_3^2-2(y_2-y_3)b&=&0,\\
x_3^2-2x_3a+a^2+y_3^2-2y_3b+b^2&=&c^2.
\end{eqnarray*}
První dvì rovnice tvoøí soustavu dvou lineárních rovnic o dvou neznámých $a,b$. Jejím øe¹ením najdeme souøadnice $(a,b)$ støedu hledané kru¾nice a po jejich dosazení do tøetí rovnice také její polomìr $c$. 
\end{reseni}

\bigskip
Úlohu~\ref{U:kruznice} mù¾eme také øe¹it geometricky. Jsou-li v¹echny tøi body $(x_1,y_1)$, $(x_2,y_2)$ a $(x_3,y_3)$ rùzné, sestrojíme napøed osu úseèky spojující první dva body, a poté osu úseèky spojující druhý a tøetí bod. Pokud se tyto osy protnou, jejich prùseèík je støedem hledané kru¾nice a úloha má v tomto pøípadì jediné øe¹ení. To nastane právì kdy¾ tøi dané body nele¾í na jedné pøímce. Pokud le¾í na jedné pøímce (a jsou navzájem rùzné), osy se neprotnou a úloha nemá ¾ádné øe¹ení. Pokud se aspoò dva body rovnají, má úloha nekoneènì mnoho øe¹ení. 

Intuitivnì ale cítíme, ¾e úloha má ``ménì" øe¹ení, pokud se rovnají pouze dva z daných bodù a tøetí je od nich rùzný, ne¾ kdy¾ jsou si v¹echny  tøi body rovné. V prvním pøípadì støedy hledaných kru¾nic le¾í na ose úseèky spojující dvojici rùzných daných bodù a ka¾dý bod této pøímky urèuje právì jednu kru¾nici, která je øe¹ením na¹í úlohy. V pøípadì rovnosti v¹ech tøí bodù je ka¾dý bod roviny rùzný od daného bodu støedem právì jedné kru¾nice øe¹ící na¹i úlohu. Pokud bod pova¾ujeme za \emph{degenerovanou} kru¾nici s polomìrem $0$, pak je \emph{ka¾dý} bod roviny støedem právì jedné kru¾nice, která je øe¹ením úlohy. Mù¾eme tak øíct, ¾e v pøípadì rovnosti dvou daných bodù má mno¾ina v¹ech øe¹ení úlohy dimenzi $1$, v pøípadì rovnosti v¹ech tøí bodù má dimenzi $2$. Pokud jsou v¹echny tøi body navzájem rùzné, má mno¾ina v¹ech øe¹ení úlohy buï dimenzi $0$ (nele¾í-li body na pøímce) nebo je úloha neøe¹itelná (pokud na pøímce le¾í).

\bigskip
Tìmto geometrickým úvahám by také mìlo odpovídat algebraické øe¹ení úlohy. Soustava 
\begin{eqnarray*}
x_1^2-x_2^2-2(x_1-x_2)a+y_1^2-y_2^2-2(y_1-y_2)b&=&0,\\
x_2^2-x_3^2-2(x_2-x_3)a+y_2^2-y_3^2-2(y_2-y_3)b&=&0,\\
\end{eqnarray*}
její¾ øe¹ení udává souøadnice $(a,b)$ støedu hledané kru¾nice, by mìla mít buï jedno øe¹ení, nebo ¾ádné, nebo nekoneènì mnoho. Má-li jich nekoneènì mnoho, pak v jednom pøípadì tvoøí mno¾ina v¹ech øe¹ení pøímku v rovinì, ve druhém celou rovinu. 

\begin{cviceni}
Ovìøte si to konkrétní volbou bodù $(x_1,y_1)$, $(x_2,y_2)$ a $(x_3,y_3)$.
\end{cviceni}

Co se stane, máme-li najít kru¾nici, která prochází rùznými body $(x_1,y_1)$, $(x_2,y_2),\dots,(x_n,y_n)$ pro $n>3$? 
Ka¾dá trojice rùzných bodù urèí jednoznaènì nìjakou kru¾nici, která tyto tøi body obsahuje. Pro rùzné výbìry tøí bodù mohou být tyto kru¾nice rùzné a v naprosté vìt¹inì pøípadou také skuteènì rùzné budou. Existuje ale jednoznaènì urèená kru¾nice, která je v jistém dobøe definovaném smyslu ``nejblí¾e" k zadaným bodùm. Úlohu, jak tuto kru¾nici najít, øe¹ili astronomové na poèátku 19. století. 1.ledna 1801 objevil astronom Giuseppe Piazi v souhvìzdí Taurus ``novou hvìzdu". Dal¹í pozorování ukázala, ¾e se ``hvìzda" pohybuje, a byla proto pova¾ována za novì objevenou planetu. V polovinì února Piazi onemocnìl a pozdìji ji u¾ znovu nena¹el. 

Astronomové se sna¾ili z namìøených poloh vypoèítat kru¾nici, po které se ``planeta" mìla podle jejich pøedpokladù pohybovat. Nepodaøilo se jim ji ale na noèní obloze znovu objevit. Slavný nìmecký matematik Carl Friedrich Gauss (1777-1855) zkusil vypoèítat eliptickou dráhu, která namìøeným polohám ``planety" nejlépe odpovídala. K jejímu výpoètu vytvoøil metodu \emph{nejmen¹ích ètvercù}. Na základì svých výpoètù urèil v prosinci 1801 polohu ztracené ``planety" a pøedpovìdìl její dal¹í pohyb. ``Planeta", ve skuteènosti planetka Ceres, byla na Gaussem pøedpovìzeném místì skuteènì znovuobjevena. O metodì nejmen¹ích ètvercù si více øekneme pozdìji.

\bigskip
Jedna lineární rovnice o dvou neznámých
\[
ax+by=c
\]
je rovnicí pøímky v rovinì, pokud nejsou oba koeficienty $a,b$ souèasnì rovné~$0$. Znamená to, ¾e mno¾ina v¹ech øe¹ení této rovnice, tj. mno¾ina v¹ech uspoøádaných dvojic reálných èísel, které této rovnici vyhovují, tvoøí pøímku v rovinì. Z této rovnice ale bezprostøednì nepoznáme, jakými body pøímka v¹ech øe¹ení prochází. Tuté¾ pøímku mù¾eme také vyjádøit parametricky ve tvaru
\[
\{\veu+t\vev:t\in\RR\},
\] 
kde $\veu$ a $\vev$ jsou vhodné dvoudimenzionální vektory a $\RR$ oznaèuje mno¾inu v¹ech reálných èísel. Vektor $\veu$ urèuje jeden bod pøímky (pøi volbì parametru $t=0$) a vektor $\vev$ urèuje smìr této pøímky.

\begin{cviceni}
Najdìte pro nìjaká konkrétní èísla $a,b,c$ parametrické vyjádøení pøímky urèené rovnicí $ax+by=c$. 
\end{cviceni}

Podobnì lineární rovnice o tøech neznámých
\[
ax+by+cz=d
\]
je rovnicí roviny v prostoru, pokud nejsou v¹echny tøi koeficienty $a,b,c$ souèasnì rovné~$0$. To znamená, ¾e mno¾ina v¹ech uspoøádaných trojic reálných èísel $(x,y,z)$, které vyhovují poslední rovnici, tvoøí rovinu v tøídimenzionálním prostoru. Ka¾dá rovina má také parametrické vyjádøení ve tvaru
\[
\{\veu+r\vev+s\vew:r,s\in\RR\},
\]
kde $\veu,\vev,\vew$ jsou vhodné tøídimenzionální vektory.

\begin{cviceni}
Najdìte pro nìjaká konkrétní èísla $a,b,c,d$ parametrické vyjádøení roviny urèené rovnicí $ax+by+cz=d$. 
\end{cviceni}

\begin{cviceni}
Jsou-li 
\begin{eqnarray*}
a_1x+b_1y+c_1z&=&d_1,\\
a_2x+b_2y+c_2z&=&d_2,
\end{eqnarray*}
rovnice dvou rovin v prostoru, najdìte podmínku, jakou musí splòovat koeficienty $a_1,b_1,c_1,d_1$ a $a_2,b_2,c_2,d_2$,
aby roviny byly rùzné. Jakou podmínku musí navíc splòovat, aby obì roviny nebyly rovnobì¾né? Pokud koeficienty splòují obì tyto podmínky, mno¾ina bodù $(x,y,z)$, které vyhovují obìma rovnicím souèasnì, tvoøí pøímku v tøídimenzionálním prostoru. Zkuste najít parametrické vyjádøení této pøímky ve tvaru
\[
\{\veu+t\vev:t\in\RR\},
\]
kde $\veu$ a $\vev$ jsou vhodné tøídimenzionální vektory.
\end{cviceni}

Pro parametrická vyjádøení pøímek a rovin potøebujeme umìt poèítat s reálnými vektory. Musíme je umìt sèítat a násobit reálným èíslem. 

\begin{definition}\label{D:realvektory}
\emph{Reálný vektor} dimenze $n$ je uspoøádaná $n$-tice reálných èísel $(x_1,x_2,\dots,x_n)$. Èíslo $x_i$ nazýváme $i$-tá \emph{souøadnice} tohoto vektoru. Jsou-li $(x_1,x_2,\dots,x_n)$ a $(y_1,y_2,\dots,y_n)$ dva reálné vektory dimenze $n$, pak jejich \emph{souètem} rozumíme vektor
\[
(x_1,x_2,\dots,x_n)+(y_1,y_2,\dots,y_n)=(x_1+y_1,x_2+y_2,\dots,x_n+y_n).
\]
Souèet dvou reálných vektorù dimenze $n$ je tedy opìt reálný vektor dimenze $n$.

Je-li $a\in\RR$ reálné èíslo, pak \emph{souèinem} èísla $a$ a vektoru $(x_1,x_2,\dots,x_n)$ rozumíme vektor
\[
a(x_1,x_2,\dots,x_n)=(ax_1,ax_2,\dots,ax_n).
\]
Souèin reálného èísla a vektoru dimenze $n$ je proto opìt reálný vektor dimenze $n$.

Mno¾inu v¹ech reálných vektorù dimenze $n$ spolu s právì definovanými operacemi sèítání vektorù a násobení vektoru reálným èíslem nazýváme \emph{aritmetický reálný vektorový prostor} dimenze $n$. Oznaèovat jej budeme $\RRR^n$.  
\end{definition}

\emph{Souèin} dvou vektorù dimenze $n$ jsme \emph{nedefinovali}. Vektory zapisujeme buï øádkovì jako v Definici~\ref{D:realvektory} nebo sloupcovì ve tvaru
\[
\left(
\begin{array}{*{1}c}
x_1\\
x_2\\
\vdots\\
x_n
\end{array}
\right).
\]

Abychom u¹etøili místo, budeme sloupcové vektory zapisovat také následovnì
\[
(x_1,x_2,\dots,x_n)^T.
\]
Od øádkového zápisu se li¹í exponentem\ \  ${}^T$.

\bigskip
Soustavou $m$ lineárních rovnic o $n$ neznámých s reálnými koeficienty rozumíme soustavu rovnic tvaru
\begin{eqnarray*}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&b_1,\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&b_2,\\
&\vdots &\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&b_m.
\end{eqnarray*}

Reálná èísla $a_{ij}$ nazýváme \emph{koeficienty} soustavy, reálný sloupcový vektor $(b_1,b_2,\dots,b_m)^T$ dimenze $m$ nazýváme \emph{vektor pravých stran}. Hledané \emph{øe¹ení soustavy} je neznámý vektor $(x_1,x_2,\dots,x_n)^T\in\RRR^n$. Poloha koeficientu $a_{ij}$ je urèena indexy $i,j$. První index $i$ urèuje rovnici, druhý index $j$ pak neznámou, u které je koeficient $a_{ij}$. Koeficienty $a_{ij}$ tvoøí dvoudimenzionální systém èísel, pro který si zavedeme zvlá¹tní název.

\begin{definition}\label{D:matice}
\emph{Reálná matice} tvaru $m\times n$ je soubor $mn$ reálných èísel $a_{ij}$, kde $i=1,2,\dots m$ a $j=1,2,\dots,n$. Matice zapisujeme ve tvaru
\[
\MM=
\left(
\begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{array}
\right).
\]
Matici také budeme zapisovat struènì $\MM=(a_{ij})$. První index u prvku $a_{ij}$ je \emph{øádkový index}, druhý index je \emph{sloupcový index}. Øíkáme také, ¾e prvek $a_{ij}$ je na místì $(i,j)$ matice $\MM$. Vektor $(a_{i1},a_{i2},\dots,a_{in})\in\RRR^n$ nazýváme $i$-tý \emph{øádkový vektor} nebo jenom struènì $i$-tý \emph{øádek} matice $\MM$ a budeme jej oznaèovat $\MM_{i*}$. Podobnì $\MM_{*j}=(a_{1j},a_{2j},\dots,a_{mj})^T\in\RRR^m$ je $j$-tý \emph{sloupcový vektor (sloupec)} matice $\MM$. 

Je-li $m=n$, pak øíkáme, ¾e $\MM$ je \emph{ètvercová matice} øádu $n$.

Je-li dána soustava $m$ lineárních rovnic o $n$ neznámých s reálnými koeficienty
\begin{eqnarray*}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&b_1,\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&b_2,\\
&\vdots &\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&b_m,
\end{eqnarray*}
pak reálnou matici
\[
\left(
\begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{array}
\right)
\]
nazýváme \emph{matice soustavy} a matici
\[
\left(
\begin{array}{ccccc}
a_{11} & a_{12} & \cdots & a_{1n} & b_1\\
a_{21} & a_{22} & \cdots & a_{2n} & b_2\\
\vdots & \vdots & \ddots & \vdots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn} & b_m
\end{array}
\right),
\]
kde jsme pøidali sloupec pravých stran, nazýváme
\emph{roz¹íøená matice} této soustavy.
\end{definition}

Reálný sloupcový vektor dimenze $n$ mù¾eme pova¾ovat také za matici tvaru $n\times 1$. Zapí¹eme-li jej øádkovì, pak je to matice tvaru $1\times n$. A¾ se nauèíme násobit matice, budeme moci zapisovat soustavu $m$ lineárních rovnic o $n$ neznámých jednodu¹e ve tvaru
\[
\MM\vex=\veb,
\]
kde $\MM$ je matice této soustavy, $\vex\in\RRR^n$ neznámý vektor a $\veb\in\RRR^m$ vektor pravých stran.


Pøi øe¹ení obou úloh jsme pou¾ívali úpravy, které nemìní mno¾inu øe¹ení soustavy. Takovým úpravám soustavy rovnic øíkáme \emph{ekvivalentní úpravy}. Ukazuje se, ¾e pøi øe¹ení soustav lineárních rovnic vystaèíme s ekvivalentními úpravami tøí typù:

\begin{itemize}
	\item prohození dvou rovnic,
	\item vynásobení $i$-té rovnice \emph{nenulovým} reálným èíslem $k$, 
	\item pøiètení $k$-násobku $i$-té rovnice k $j$-té rovnici, pokud $i\ne j$.
\end{itemize}

Tìmto úpravám øíkáme \emph{elementární úpravy}. Elementární úpravy jsou \emph{vratné}, tj. z nové soustavy mù¾eme rekonstruovat pùvodní soustavu pomocí nìjaké elementární úpravy (jaké?). Pøi øe¹ení úloh jsme ¾ádné jiné úpravy nepou¾ívali (za jakou úpravu lze pova¾ovat dosazení $c=3$ do zbývajících dvou rovnic, které jsme pou¾ili pøi øe¹ení první úlohy?).

\begin{proposition}\label{T:ekvupravy}
Elementární úpravy soustavy lineárních rovnic nemìní mno¾inu v¹ech øe¹ení soustavy.
\end{proposition}

\begin{proof}
Oznaèíme $S$ mno¾inu v¹ech øe¹ení soustavy
\begin{eqnarray*}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&b_1,\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&b_2,\\
&\vdots &\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&b_m.
\end{eqnarray*}

Symbolem $R$ oznaèíme mno¾inu v¹ech øe¹ení soustavy, kterou dostaneme z této soustavy nìjakou elementární úpravou. 

Je-li $(x_1,x_2,\dots,x_n)^T\in S$, pak $(x_1,x_2,\dots,x_n)^T\in R$, pokud novou soustavu dostaneme z pùvodní první elementární úpravou, proto¾e rovnice v obou soustavách jsou stejné, li¹í se pouze poøadím. 

Pokud udìláme druhou elementární úpravu, pak z pøedpokladu, ¾e vektor $(x_1,x_2,\dots,x_n)^T\in S$ dostáváme
\[
a_{i1}x_1+a_{i2}x_2+\cdots+a_{in}x_n=b_i
\]
a tedy také
\[
ka_{i1}x_1+ka_{i2}x_2+\cdots+ka_{in}x_n=kb_i.
\]
Ostatní rovnice soustavy se nezmìnily, vektor $(x_1,x_2,\dots,x_n)^T$ je proto také øe¹ením nové soustavy. Tedy 
$(x_1,x_2,\dots,x_n)^T\in R$ rovnì¾ v pøípadì druhé elementární úpravy.

V pøípadì tøetí elementární úpravy z pøedpokladu $(x_1,x_2,\dots,x_n)^T\in S$ dostáváme
\begin{eqnarray*}
a_{i1}x_1+a_{i2}x_2+\cdots+a_{in}x_n&=&b_i,\\
a_{j1}x_1+a_{j2}x_2+\cdots+a_{jn}x_n&=&b_j,
\end{eqnarray*} 
proto rovnì¾
\begin{eqnarray*}
k(a_{i1}x_1+a_{i2}x_2+\cdots+a_{in}x_n)&=&kb_i,\\
a_{j1}x_1+a_{j2}x_2+\cdots+a_{jn}x_n&=&b_j.
\end{eqnarray*} 
Seètením obou rovností dostaneme
\begin{eqnarray*}
&k(a_{i1}x_1+a_{i2}x_2+\cdots+a_{in}x_n)+(a_{j1}x_1+a_{j2}x_2+\cdots+a_{jn}x_n)=\\
&(ka_{i1}+a_{j1})x_1+(ka_{i2}+a_{j2})x_2+\cdots+(ka_{in}+a_{jn})x_n=kb_i+b_j.
\end{eqnarray*}
Vektor $(x_1,x_2,\dots,x_n)^T$ je proto øe¹ením $j$-té rovnice upravené soustavy. Ostatní rovnice nové soustavy patøí také do pùvodní soustavy, proto je $(x_1,x_2,\dots,x_n)^T$ rovnì¾ øe¹ením tìchto rovnic. Také v pøípadì tøetí elementární úpravy tak platí $(x_1,x_2,\dots,x_n)^T\in R$. Tím jsme dokázali inkluzi
\[
S\subseteq R.
\] 

Proto¾e pùvodní soustavu dostaneme z nové soustavy také nìjakou elementární úpravou, platí podle první èásti dùkazu rovnì¾ opaèná inkluze
\[
R\subseteq S.
\]
Mno¾iny v¹ech øe¹ení pùvodní a nové soustavy se proto rovnají.
\end{proof}

\begin{cviceni}
Proè není ekvivalentní úpravou vynásobení nìjaké rovnice èíslem $0$? Jaký je vztah mezi mno¾inami v¹ech øe¹ení pùvodní a nové soustavy v pøípadì, ¾e vynásobíme nìkterou z rovnic èíslem $0$? Proè musíme pøi tøetí elementární úpravì pøedpokládat $i\ne j$? 
\end{cviceni}

Tøem  elementárním úpravám soustavy rovnic odpovídají \emph{elementární øádkové úpravy} matice soustavy. Matici nové soustavy dostaneme z matice pùvodní soustavy odpovídající úpravou matice:

\begin{itemize}
	\item prohozením dvou øádkù matice,
	\item vynásobením $i$-tého øádku matice \emph{nenulovým} èíslem,
	\item pøiètením $k$-násobku $i$-tého øádku k $j$-tému øádku, je-li $i\ne j$. 
\end{itemize}

Podobnì roz¹íøenou matici nové soustavy dostaneme z roz¹íøené matice pùvodní soustavy pomocí odpovídající elementární øádkové úpravy. Øe¹ení soustavy lineárních rovnic proto budeme hledat pomocí elementárních øádkových úprav roz¹íøené matice soustavy. 


\chapter{Gaussova eliminace}

Název druhé kapitoly je souèasnì názvem nejèastìji pou¾ívané metody (algoritmu) pro øe¹ení soustav lineárních rovnic. 
Gaussova eliminaèní metoda pro øe¹ení soustavy lineárních rovnic sestává ze dvou krokù:
\begin{itemize}
	\item pøevedení roz¹íøené matice soustavy pomocí elementárních øádkových úprav do \emph{øádkovì odstupòovaného tvaru} pomocí \emph{Gaussovy eliminace},
	\item nalezení v¹ech øe¹ení soustavy pomocí \emph{zpìtné substituce}.
\end{itemize}

Oba kroky si nyní podrobnì rozebereme. Zaèneme definicí øádkovì odstupòovaného tvaru.

\begin{definition}\label{D:REF}
Matice $\EE=(a_{ij})$ tvaru $m\times n$ je v \emph{øádkovì odstupòovaném tvaru}, jestli¾e splòuje dvì následující podmínky:
\begin{itemize}
	\item obsahuje-li $i$-tý øádek $\EE_{i*}$ samé nuly, pak v¹echny øádky pod $i$-tým øádkem jsou také nulové,
	\item je-li v $i$-tém øádku $\EE_{i*}$ první nenulový prvek v $j$-tém sloupci (tj. na místì $(i,j)$), pak v¹echny prvky, které le¾í v prvních $j$ sloupcích a souèasnì pod $i$-tým øádkem, se rovnají $0$. 
\end{itemize}
První nenulový prvek v ka¾dém øádku nazýváme \emph{pivot}. 
\end{definition}

První podmínka øíká, ¾e u matice v øádkovì odstupòovaném tvaru jsou v¹echny nulové øádky v dolní èásti matice. Z druhé podmínky vyplývá, ¾e matice v øádkovì odstupòovaném tvaru má tolik pivotù, kolik má nenulových øádkù. V ka¾dém nenulovém øádku je právì jeden pivot.

\begin{cviceni}\label{C:REF}
Rozhodnìte, které z následujících matic jsou a které nejsou v øádkovì odstupòovaném tvaru:

\parbox{6cm}
{\[\bAA=
\left(
\begin{array}{ccccc}
0& 1 & 2 & 0 & 3\\
1 & 0 & 2 & 4 & -1\\
0 & 0 & 2& 1 & 0 \\
0 & 0 & 0 & 3 & 0
\end{array}
\right)
\]}
\hfill
\parbox{5cm}
{\[\BB=
\left(
\begin{array}{ccccc}
1& 1 & 2 & 0 & 3\\
0 & 0 & 2 & 4 & -1\\
0 & 0 & 0& 1 & 0 \\
0 & 0 & 0 & 0 & 0
\end{array}
\right)
\]}

\parbox{6cm}
{\[\CC=
\left(
\begin{array}{cccccc}
0 & 1 & 2 & 0 & 3 & 0\\
0 & 0 & 2 & 4 & -1& 5\\
0 & 0 & 0& 1 & 0  & 2\\
0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & -1
\end{array}
\right)
\]}
\hfill
\parbox{5cm}
{\[\DD=
\left(
\begin{array}{cccc}
0 & 1 & 2 & 0 \\
0 & 1 & 2 & 4 \\
0 & 0 & 0 & 1 \\ 0 & 0 & 0 & 0 \\
\end{array}
\right)
\]}
Oznaète pivoty v tìch maticích, které jsou v øádkovì odstupòovaném tvaru.
\end{cviceni}

Gaussova eliminace -- algoritmus pro pøevedení libovolné matice do øádkovì odstupòovaného tvaru pomocí elementárních øádkových úprav -- spoèívá v nìkolikerém opakování jednoho a tého¾ cyklu na stále men¹í matice. Uká¾eme si jeden prùbìh cyklu. Nech» je dána matice $\bAA=(a_{kl})$ tvaru $m\times n$. Pøedpokládáme, ¾e cyklus Gaussovy eliminace ji¾ probìhl $(i-1)$-krát a z matice $\bAA$ jsme dostali matici $\BB=(b_{kl})$. Tento pøedpoklad také pøipou¹tí mo¾nost $i-1=0$, tj. ¾e výpoèet pomocí Gaussovy eliminace zaèíná s maticí $\BB=\bAA$. Cyklus sestává z následujících krokù:
\begin{itemize}
	\item prohlí¾íme sloupce matice $\BB$ zleva a najdeme první sloupec, který obsahuje nenulový prvek v $i$-tém øádku nebo v nìjakém øádku pod $i$-tým øádkem; pokud takový sloupec neexistuje, pokraèujeme posledním krokem,
	\item je-li první takový sloupec $\BB_{*j}$, oznaèíme si místo $(i,j)$ jako místo pro $i$-tý pivot,
	\item je-li prvek $b_{ij}$ na místì $(i,j)$ rovný $0$, pøesuneme pomocí první elementární øádkové úpravy na místo $i$-tého øádku libovolný øádek pod $i$-tým øádkem, ve kterém je prvek v $j$-tém sloupci nenulový; v opaèném pøípadì pokraèujeme hned následujícím krokem,
	\item pokud je na místì $(i,j)$ nenulové èíslo, pøièteme ke v¹em ostatním øádkùm pod $i$-tým øádkem vhodné násobky $i$-tého øádku tak, abychom vynulovali v¹echny prvky ve sloupci $\BB_{*j}$, které se nacházejí pod pivotem na místì $(i,j)$ (tj. opakovanì pou¾íváme tøetí elementární úpravu),
	\item pokud jsou v¹echny prvky v $i$-tém øádku matice $\BB$ a ve v¹ech øádcích pod ním nulové, algoritmus konèí.
\end{itemize}

Prùbìh celého algoritmu si uká¾eme v následující úloze. 

\begin{uloha}
Pøeveïte následující matici do øádkovì odstupòovaného tvaru pomocí Gaussovy eliminace:
\[
\left(
\begin{array}{ccccc}
1 & 2 & 1 & 4 & 1\\
2 & 4 & 0 & 4 & 4\\
1 & 2 & 3 & 8 & -1\\
2 & 4 & 0 & 4 & 7
\end{array}
\right).
\]
\end{uloha}

\begin{reseni}
Èísla na místech pro pivoty jsou vyznaèena tuènì:

\begin{eqnarray*}
{}&\left(
\begin{array}{ccccc}
\mathbf{1} & 2 & 1 & 4 & 1\\
2 & 4 & 0 & 4 & 4\\
1 & 2 & 3 & 8 & -1\\
2 & 4 & 0 & 4 & 7
\end{array}
\right)\sim
\left(
\begin{array}{ccccc}
\mathbf{1} & 2 & 1 & 4 & 1\\
0 & 0 & \mathbf{-2} & -4 & 2\\
0 & 0 & 2 & 4 & -2\\
0 & 0 & -2 & -4 & 5
\end{array}
\right)\sim\\
{}&\left(
\begin{array}{ccccc}
\mathbf{1} & 2 & 1 & 4 & 1\\
0 & 0 & \mathbf{-2} & -4 & 2\\
0 & 0 & 0 & 0 & \mathbf{0}\\
0 & 0 & 0 & 0 & 3
\end{array}
\right)\sim
\left(
\begin{array}{ccccc}
\mathbf{1} & 2 & 1 & 4 & 1\\
0 & 0 & \mathbf{-2} & -4 & 2\\
0 & 0 & 0 & 0 & \mathbf{3}\\
0 & 0 & 0 & 0 & 0
\end{array}
\right).
\end{eqnarray*}
\end{reseni}

Ovìøit, ¾e po skonèení Gaussovy eliminace dostaneme matici v øádkovì odstupòovaném tvaru, není obtí¾né. Pøedev¹ím si v¹imnìme, ¾e pokud v $i$-tém prùbìhu cyklu nepøeskoèíme druhý krok, zùstane po vykonání tøetího a ètvrtého kroku na místì $(i,j)$ nenulový prvek. Probìhne-li celý $i$-tý cyklus, prvních $i$ øádkù nové matice je nenulových. 

Pokud tedy v prvním kroku $i$-tého cyklu ¾ádný nenulový prvek nenajdeme, znamená to, ¾e $i$-tý øádek a v¹echny øádky pod ním jsou nulové. Øádky nad $i$-tým øádkem jsou naopak nenulové. Matice tak splòuje první podmínku z Definice~\ref{D:REF}.

Pokud v prvním kroku $i$-tého cyklu najdeme nìjaký nenulový prvek a ve druhém kroku místo $(i,j)$ pro $i$-tý pivot, znamená to, ¾e v¹echny prvky matice $\BB$, které jsou v prvních $j-1$ sloupcích a souèasnì v $i$-tém øádku $\BB_{i*}$ nebo v nìjakém øádku pod ním, jsou nulové. Po probìhnutí tøetího a ètvrtého kroku bude na místì $(i,j)$ nenulový prvek a v¹echny prvky pod ním budou nulové. První nenulový prvek v $i$-tém øádku tak bude na místì $(i,j)$. Stejnì tak v¹echny prvky v prvních $j$ sloupcích a pod $i$-tým øádkem budou nulové. Nová matice tak bude splòovat druhou podmínku Definice~\ref{D:REF} pro $i$-tý øádek. Po skonèení Gaussovy eliminace proto bude celá matice splòovat také druhou podmínku definice øádkovì odstupòovaného tvaru.

\begin{cviceni}
Napi¹te program pro Gaussovu eliminaci.
\end{cviceni}    

Pozdìji si doká¾eme následující dùle¾ité tvrzení.

\begin{proposition}\label{T:pivotposition}
Je-li $\bAA$ libovolná matice a je-li $\EE$ nìjaká matice v øádkovì odstupòovaném tvaru, kterou dostaneme z $\bAA$ pomocí elementárních øádkových úprav, pak jsou místa pro pivoty v matici $\EE$ urèená maticí $\bAA$ jednoznaènì.
\end{proposition}

Pivoty samotné, stejnì jako celá matice $\EE$, nejsou maticí $\bAA$ urèené jednoznaènì.

\begin{cviceni}
Najdìte matici $\bAA$, kterou lze rùznými posloupnostmi elementárních øádkových úprav pøevést do matic v øádkovì odstupòovaném tvaru, které mají na stejných místech rùzné pivoty.
\end{cviceni}

Následující definice zavádí mimo jiné dùle¾itý pojem hodnosti matice.

\begin{definition}\label{D:rank}
Je-li $\bAA$ libovolná matice, pak poèet pivotù (tj. poèet nenulových øádkù) v libovolné matici v øádkovì odstupòovaném tvaru, kterou dostaneme z $\bAA$ pomocí elementárních øádkových úprav, nazýváme \emph{hodnost} matice $\bAA$. Hodnost matice $\bAA$ budeme oznaèovat $r(\bAA)$ (symbol $r$ pochází z anglického slova \emph{rank}).

Sloupce matice $\bAA$, ve kterých le¾í místo pro nìjaký pivot, nazýváme \emph{bázové sloupce} matice $\bAA$.
\end{definition}

Hodnost $r(\bAA)$ se tak rovná také poètu bázových sloupcù matice $\bAA$. V¹imnìte si, ¾e smysluplnost definice hodnosti matice závisí na zatím nedokázaném Tvrzení~\ref{T:pivotposition}.

\begin{cviceni}
Najdìte místa pro pivoty ve v¹ech maticích ze Cvièení~\ref{C:REF}. Urèete hodnost tìchto matic.
\end{cviceni}

\bigskip
Nyní se budeme zabývat otázkou, kdy  soustava lineárních rovnic nemá ¾ádné øe¹ení, kdy je \emph{neøe¹itelná}. Máme-li soustavu $m$ lineárních rovnic o $n$ neznámých
\begin{eqnarray}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&b_1,\nonumber\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&b_2,\nonumber\\
&\vdots &\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&b_m,\nonumber
\end{eqnarray}
oznaèíme $\bAA=(a_{ij})$ matici této soustavy a $\veb=(b_1,b_2,\dots,b_m)^T$ sloupcový vektor pravých stran. Roz¹íøenou matici této soustavy budeme zapisovat také $[\bAA|\veb]$. 

\begin{proposition}\label{T:neresitelnost}
Soustava (2.1) nemá øe¹ení, pokud je sloupec pravých stran $\veb$ bázový sloupec ro¹íøené matice soustavy $[\bAA|\veb]$.

Sloupec $\veb$ je bázový sloupec roz¹íøené matice soustavy $[\bAA|\veb]$ právì kdy¾ $r(\bAA)<r[\bAA|\veb]$. 
\end{proposition}

\begin{proof}
Matici $[\bAA|\veb]$ pøevedeme pomocí elementárních øádkových úprav do øádkovì odstupòovaného tvaru $[\EE|\cc]$.
Je-li $\veb$ bázový sloupec matice $[\bAA|\veb]$, obsahuje tento sloupec nìjaké místo pro pivot. Toto místo le¾í øeknìme v $i$-tém øádku. V matici $[\EE|\cc]$ je v $i$-tém øádku jediný nenulový prvek $c$ v posledním sloupci. Proto¾e elementárním øádkovým úpravám matice $[\bAA|\veb]$ odpovídají elementární úpravy soustavy, které podle Tvrzení~\ref{T:ekvupravy} nemìní mno¾inu v¹ech øe¹ení soustavy, má soustava (2.1) stejná øe¹ení jako soustava s roz¹íøenou maticí $[\EE|\cc]$.
Rovnice této soustavy odpovídající $i$-tému øádku matice $[\EE|\cc]$ má tvar
\[
0x_1+0x_2+\cdots+0x_n=c.
\]  
Proto¾e je $c\ne 0$, nemá tato rovnice ¾ádné øe¹ení. Tím také celá soustava s roz¹íøenou maticí $[\EE|\cc]$ nemá ¾ádné øe¹ení. Proto je soustava (2.1) rovnì¾ neøe¹itelná.

V¹imnìme si, ¾e matice $\EE$ je v øádkovì odstupòovaném tvaru a ¾e jsme ji dostali z $\bAA$ pomocí elementárních øádkových úprav. Bázové sloupce matice $\bAA$ jsou proto také bázovými sloupci matice $[\bAA|\veb]$. Jestli¾e je $r(\bAA)<r[\bAA|\veb]$, sloupec pravých stran musí být bázový v matici $[\bAA|\veb]$.

Naopak, je-li $\veb$ bázový sloupec matice $[\bAA|\veb]$, má tato matice více bázových sloupcù ne¾ matice $\bAA$, proto
$r(\bAA)<r[\bAA|\veb]$. Tím je dokázána ekvivalence obou tvrzení z druhého odstavce.
\end{proof}

Tvrzení~\ref{T:neresitelnost} doplníme dùkazem, ¾e soustava (2.1) je øe¹itelná, pokud sloupec pravých stran $\veb$ \emph{není} bázový sloupec roz¹íøené matice $[\bAA|\veb]$ této soustavy. Uká¾eme, jak v takovém pøípadì najít \emph{v¹echna} øe¹ení soustavy.

Zaèneme pøípadem, kdy platí $b_i=0$ pro v¹echny indexy $i=1,\dots,m$. Takovou soustavu nazýváme \emph{homogenní} soustava lineárních rovnic. Otázka øe¹itelnosti homogenních soustav je triviální. Soustava
\begin{eqnarray}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&0,\nonumber\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&0,\nonumber\\
&\vdots &\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&0\nonumber
\end{eqnarray}
má v¾dy aspoò jedno øe¹ení $x_1=x_2=\cdots=x_n=0$. Nazýváme jej \emph{triviální øe¹ení.} Homogenní soustava mù¾e mít je¹tì dal¹í øe¹ení, jak ukazuje následující úloha.

\begin{uloha}\label{U:homo}
Najdìte v¹echna øe¹ení soustavy
\begin{eqnarray*}
x_1+2x_2+2x_3+3x_4&=&0,\\
2x_1+4x_2+x_3+3x_4&=&0,\\
3x_1+6x_2+x_3+4x_4&=&0.
\end{eqnarray*}
\end{uloha}

\begin{reseni}
Roz¹íøenou matici soustavy
\[
\left(
\begin{array}{ccccc}
1 & 2 & 2 & 3 & 0\\
2 & 4 & 1 & 3 & 0\\
3 & 6 & 1 & 4 & 0
\end{array}
\right)
\]
pøevedeme Gaussovou eliminací do øádkovì odstupòovaného tvaru
\[
\left(
\begin{array}{ccccc}
1 & 2 & 2 & 3 & 0\\
0 & 0 & -3 & -3 & 0\\
0 & 0 & 0 & 0 & 0
\end{array}
\right).
\]
Pùvodní soustava je tedy ekvivalentní soustavì
\begin{eqnarray*}
x_1+2x_2+2x_3+3x_4&=&0,\\
{}-3x_3-3x_4&=&0.
\end{eqnarray*}
Z druhé rovnice dostaneme
\[
x_3=-x_4
\]
a po dosazení za $x_3$ do první rovnice 
\begin{eqnarray*}
x_1&=&-2x_2-2x_3-3x_4=-2x_2-2(-x_4)-3x_4\\
{}&=&-2x_2-x_4.
\end{eqnarray*}
Hodnoty neznámých $x_2$ a $x_4$ mù¾eme zvolit libovolnì a pak dopoèítáme hodnoty neznámých $x_1$ a $x_3$ z posledních dvou rovností. 

Øe¹ení soustavy je následující:
\begin{eqnarray*}
x_1&=& -2x_2-x_4,\\
x_2&\ & \hbox{\rm je ``volná neznámá"},\\
x_3&=& -x_4,\\
x_4&\ & \hbox{\rm je ``volná neznámá"}.
\end{eqnarray*}

Øe¹ení mù¾eme také vyjádøit pomocí sloupcových vektorù
\[
\left(
\begin{array}{*{1}c}
x_1\\
x_2\\
x_3\\
x_4
\end{array}
\right)=
\left(
\begin{array}{*{1}c}
-2x_2-x_4\\
x_2\\
-x_4\\
x_4
\end{array}
\right)=
x_2\left(
\begin{array}{*{1}c}
-2\\
1\\
0\\
0
\end{array}
\right)+
x_4\left(
\begin{array}{*{1}c}
-1\\
0\\
-1\\
1
\end{array}
\right).
\]
Oznaèíme-li $\veh_1=(-2,1,0,0)^T$ a $\veh_2=(-1,0,-1,1)^T$, mù¾eme obecné øe¹ení soustavy vyjádøit ve tvaru
\[
\vex=x_2\veh_1+x_4\veh_2,
\]
kde $x_2$ a $x_4$ jsou libovolná reálná èísla.
\end{reseni}


Poslední vyjádøení mno¾iny v¹ech øe¹ení soustavy pøipomíná parametrické vyjádøení pøímky nebo roviny. Zvolíme-li hodnoty parametrù $x_2=1$ a $x_4=0$, dostaneme ¾e vektor $\veh_1$ je øe¹ením soustavy. Podobnì také $\veh_2$ je øe¹ením soustavy. 

\begin{cviceni}
Najdìte v¹echna øe¹ení nìkolika homogenních soustav lineárních rovnic. Mù¾ete dostat rùzná parametrická vyjádøení mno¾iny v¹ech øe¹ení nìjaké soustavy, pokud roz¹íøenou matici této soustavy pøevedete pomocí elementárních øádkových úprav do rùzných matic v øádkovì odstupòovaném tvaru?
\end{cviceni}

Postup, který jsme pou¾ili pøi øe¹ení Úlohy~\ref{U:homo}, mù¾eme snadno zobecnit na øe¹ení libovolné homogenní soustavy lineárních rovnic (2.2). Roz¹íøenou matici soustavy $[\bAA|\mathbf{0}]$ pøevedeme pomocí Gaussovy eliminace do øádkovì odstupòovaného tvaru $[\EE|\mathbf{0}]$. Neznámé, jejich¾ koeficienty le¾í v bázových sloupcích matice $[\bAA|\mathbf{0}]$, nazveme \emph{bázové neznámé}. Ostatní neznámé, jejich¾ koeficienty nele¾í v bázových sloupcích, nazveme \emph{volné neznámé}. 

Poèet bázových neznámých se rovná poètu bázových sloupcù matice $[\bAA|\mathbf{0}]$, tj. poètu míst pro pivoty v této matici, tj. poètu nenulových øádkù v matici $[\EE|\mathbf{0}]$. Podle Definice~\ref{D:rank} se tak poèet bázových neznámých rovná hodnosti $r=r[\bAA|\mathbf{0}]=r(\bAA)$. Poèet volných neznámých se proto rovná $n-r$.

Volné neznámé oznaèíme $x_{f_1},x_{f_2},\dots,x_{f_{n-r}}$. Jejich hodnoty mù¾eme zvolit libovolnì. Pak dopoèítáme hodnoty bázových neznámých $x_{b_1},\dots,x_{b_r}$ následovnì. V matici $\EE$ je poslední nenulový øádek $\EE_{r*}$.
V rovnici, která odpovídá tomuto øádku, je nenulový koeficient u jediné bázové neznámé $x_{b_r}$. Z této rovnice mù¾eme proto vyjádøit neznámou $x_{b_r}$ pomocí volných neznámých. 

Pøedpokládejme, ¾e jsme u¾ na¹li vyjádøení v¹ech bázových neznámých $x_{b_{i+1}},\dots,x_{b_r}$ pomocí volných neznámých. V rovnici odpovídající $i$-tému øádku matice $\EE$ je urèitì nenulový koeficient u bázové neznámé $x_{b_i}$. Z bázových neznámých mohou mít nenulové koeficienty pouze $x_{b_{i+1}},\dots,x_{b_r}$. Tyto neznámé u¾ umíme vyjádøit pomocí volných neznámých. Po dosazení tìchto vyjádøení do rovnice odpovídající $i$-tému øádku matice $[\EE|\mathbf{0}]$ vyjádøíme také bázovou neznámou $x_{b_i}$ pomocí volných neznámých.

Tímto postupem, kterému øíkáme \emph{zpìtná substituce,} postupnì vyjádøíme v¹echny bázové neznámé pomocí volných neznámých. Napí¹eme-li tato vyjádøení do sloupce vèetnì volných neznámých, najdeme podobnì jako pøi øe¹ení Úlohy~2.2
\emph{obecné øe¹ení} soustavy (2.2) ve tvaru
\[
\vex=x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_{n-r},
\]
kde $\veh_1,\veh_2,\dots,\veh_{n-r}$ jsou vhodná konkrétní øe¹ení této soustavy a $x_{f_1},\dots,$ $x_{f_{n-r}}$ jsou libovolná reálná èísla. Dokázali jsme tak první èást následující vìty.

\begin{theorem}\label{T:homo}
Obecné øe¹ení homogenní soustavy lineárních rovnic
\begin{eqnarray*}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&0,\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&0,\\
{}&\vdots&\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&0
\end{eqnarray*}
lze vyjádøit ve tvaru
\[
\vex=x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_{n-r},
\]
kde $r=r(\bAA)$  je hodnost matice soustavy $\bAA=(a_{ij})$, $\veh_1,\veh_2,\dots,\veh_{n-r}$ jsou vhodná konkrétní øe¹ení této soustavy, a $x_{f_1},\dots,$ $x_{f_{n-r}}$ jsou libovolná reálná èísla.

Soustava má pouze triviální øe¹ení právì kdy¾ $r(\bAA)=n$.
\end{theorem}

\begin{proof}
Zbývá dokázat ekvivalenci z druhého odstavce. Soustava má pouze triviální øe¹ení právì kdy¾ není ¾ádná neznámá volná. To je právì kdy¾ jsou v¹echny sloupce matice $\bAA$ bázové. Z Definice~\ref{D:rank} plyne, ¾e v¹echny sloupce matice $\bAA$ jsou bázové právì kdy¾ $r(\bAA)=n$.
\end{proof}

Øe¹ení soustavy s obecnou pravou stranou probíhá analogicky.

\begin{uloha}\label{U:nehomo}
Najdìte v¹echna øe¹ení soustavy
\begin{eqnarray*}
x_1+2x_2+2x_3+3x_4&=&4,\\
2x_1+4x_2+x_3+3x_4&=&5,\\
3x_1+6x_2+x_3+4x_4&=&7.
\end{eqnarray*}
\end{uloha}

\begin{reseni}
Roz¹íøenou matici soustavy
\[
[\bAA|\veb]=\left(
\begin{array}{ccccc}
1 & 2 & 2 & 3 & 4\\
2 & 4 & 1 & 3 & 5\\
3 & 6 & 1 & 4 & 7
\end{array}
\right)
\]
pøevedeme Gaussovou eliminací do øádkovì odstupòovaného tvaru
\[
\left(
\begin{array}{ccccc}
1 & 2 & 2 & 3 & 4\\
0 & 0 & -3 & -3 & -3\\
0 & 0 & 0 & 0 & 0
\end{array}
\right)=[\EE|\cc].
\]
Pùvodní soustava je tedy ekvivalentní soustavì
\begin{eqnarray*}
x_1+2x_2+2x_3+3x_4&=&4,\\
{}-3x_3-3x_4&=&-3.
\end{eqnarray*}
Z druhé rovnice dostaneme
\[
x_3=1-x_4
\]
a po dosazení za $x_3$ do první rovnice 
\[x_1=2-2x_2-x_4.
\]
Hodnoty neznámých $x_2$ a $x_4$ mù¾eme zvolit libovolnì a pak dopoèítáme hodnoty neznámých $x_1$ a $x_3$ z posledních dvou rovností. 

Øe¹ení soustavy je následující:
\begin{eqnarray*}
x_1&=&2-2x_2-x_4,\\
x_2&\ & \hbox{\rm je ``volná neznámá"},\\
x_3&=&1-x_4,\\
x_4&\ & \hbox{\rm je ``volná neznámá"}.
\end{eqnarray*}

Vyjádøíme-li øe¹ení pomocí sloupcových vektorù, dostaneme
\[
\left(
\begin{array}{*{1}c}
x_1\\
x_2\\
x_3\\
x_4
\end{array}
\right)=
\left(
\begin{array}{*{1}c}
2-2x_2-x_4\\
x_2\\
1-x_4\\
x_4
\end{array}
\right)=
\left(
\begin{array}{*{1}c}
2\\
0\\
1\\
0
\end{array}
\right)+
x_2\left(
\begin{array}{*{1}c}
-2\\
1\\
0\\
0
\end{array}
\right)+
x_4\left(
\begin{array}{*{1}c}
-1\\
0\\
-1\\
1
\end{array}
\right).
\]
Oznaèíme-li $\vep=(2,0,1,0)^T$, $\veh_1=(-2,1,0,0)^T$ a $\veh_2=(-1,0,-1,1)^T$, mù¾eme obecné øe¹ení soustavy vyjádøit ve tvaru
\[
\vex=\vep+x_2\veh_1+x_4\veh_2,
\]
kde $x_2$ a $x_4$ jsou libovolná reálná èísla.
\end{reseni}

V¹imnìte si, ¾e vektor $\vep$ je jedním konkrétním øe¹ením soustavy, zvolíme-li hodnoty volných neznámých $x_2=x_4=0$. 
Srovnáme-li øe¹ení Úlohy~\ref{U:nehomo} s~øe¹ením Úlohy~\ref{U:homo}, vidíme ¾e obecné øe¹ení nehomogenní soustavy dostaneme jako souèet nìjakého konkrétního øe¹ení $\vep$ této soustavy a obecného øe¹ení $x_2\veh_1+x_4\veh_2$ pøíslu¹né homogenní soustavy
\begin{eqnarray*}
x_1+2x_2+2x_3+3x_4&=&0,\\
2x_1+4x_2+x_3+3x_4&=&0,\\
3x_1+6x_2+x_3+4x_4&=&0.
\end{eqnarray*}
Tato vlastnost není ¾ádnou specialitou soustavy øe¹ené v Úloze~\ref{U:nehomo}. Doká¾eme si to ve Vìtì~\ref{V:obecres}.

Postup pro øe¹ení obecné soustavy (2.1) je analogický postupu pro øe¹ení homogenní soustavy (2.2). 

\begin{itemize}
	\item Pomocí Gaussovy eliminace pøevedeme matici $[\bAA|\veb]$ do øádkovì odstupòovaného tvaru $[\EE|\cc]$.
\end{itemize}

Je-li sloupec pravých stran $\cc$ bázovým sloupcem matice $[\EE|\cc]$, je soustava (2.1) neøe¹itelná podle Tvrzení~\ref{T:neresitelnost}. Pokud není bázovým sloupcem matice $[\EE|\cc]$, pokraèujeme následujícími kroky.

\begin{itemize}
	\item Identifikujeme bázové a volné neznámé podle toho, jsou-li sloupcové vektory jejich koeficientù bázové sloupce matice $[\EE|\cc]$.
	\item Pomocí zpìtné substituce vyjádøíme bázové neznámé pomocí volných neznámých.
	\item Vyjádøíme \emph{obecné øe¹ení} ve tvaru 
	\[
	\vex=\vep+x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_r,
	\]
	kde $\vep$ je vhodné konkrétní øe¹ení soustavy (2.1), $\veh_1,\veh_2,\dots,\veh_{n-r}$ jsou vhodné sloupcové vektory     dimenze $m$, $x_{f_1},\dots,$ $x_{f_{n-r}}$ jsou libovolná reálná èísla a $r=r(\bAA)$. 
\end{itemize}

Pokud tedy sloupec pravých stran roz¹íøené matice $[\bAA|\veb]$ soustavy (2.1) není bázový sloupec této matice, je soustava øe¹itelná. Spolu s první èástí Tvrzení~\ref{T:neresitelnost} jsme tak dokázali následující dùle¾itou vìtu.

\begin{theorem}\label{V:resitelnost}
Soustava (2.1) $m$ lineárních rovnic o $n$ neznámých je øe¹itelná právì kdy¾ sloupec pravých stran není bázovým sloupcem roz¹íøené matice $[\bAA|\veb]$ této soustavy. $\Box$
\end{theorem}

Doká¾eme je¹tì následující vìtu.
\begin{theorem}\label{V:obecres}
Obecné øe¹ení $\vex=\vep+x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_r$
øe¹itelné soustavy (2.1) dostaneme tak, ¾e ke konkrétnímu øe¹ení $\vep$ této soustavy pøièteme obecné øe¹ení 
\[
x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_r
\]
pøíslu¹né homogenní soustavy (2.2). 

Soustava má jednoznaènì urèené øe¹ení právì kdy¾ $r(\bAA)=n$, kde $\bAA$ je matice soustavy.
\end{theorem}

\begin{proof}
Oznaèíme $\vep=(p_1,p_2,\dots,p_n)^T$ konkrétní øe¹ení soustavy (2.1). Pro ka¾dé $j=1,2,\dots,m$ proto platí
\[
a_{j1}p_1+a_{j2}p_2+\cdots+a_{jn}p_n=b_j.
\]
Dále oznaèíme $\veq=(q_1,q_2,\dots,q_n)^T=x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_r$. Je-li
vektor $\vep+\veq=(p_1+q_1,\dots,p_n+q_n)^T$ také øe¹ení soustavy (2.1), musí platit pro ka¾dé $j=1,2,\dots,m$
\[
a_{j1}(p_1+q_1)+a_{j2}(p_2+q_2)+\cdots+a_{jn}(p_n+q_n)=b_j.
\]
Odtud plyne
\begin{eqnarray*}
b_j&=&a_{j1}(p_1+q_1)+a_{j2}(p_2+q_2)+\cdots+a_{jn}(p_n+q_n)=\\
{}&=&(a_{j1}p_1+a_{j2}p_2+\cdots+a_{jn}p_n)+(a_{j1}q_1+a_{j2}q_2+\cdots+a_{jn}q_n)=\\
{}&=&b_j+a_{j1}q_1+a_{j2}q_2+\cdots+a_{jn}q_n.
\end{eqnarray*}
Proto 
\[
a_{j1}q_1+a_{j2}q_2+\cdots+a_{jn}q_n=0
\]
pro ka¾dé $j=1,2,\dots,m$. Vektor $\veq$ je tedy øe¹ením homogenní soustavy (2.2).

Je-li naopak vektor $\ver=(r_1,r_2,\dots,r_n)^T$ øe¹ením homogenní soustavy (2.2), platí
\[
a_{j1}r_1+a_{j2}r_2+\cdots+a_{jn}r_n=0
\]
pro ka¾dé $j=1,2,\dots,m$. Potom
\begin{eqnarray*}
b_j&=&(a_{j1}p_1+a_{j2}p_2+\cdots+a_{jn}p_n)+(a_{j1}r_1+a_{j2}r_2+\cdots+a_{jn}r_n)\\
{}&=&a_{j1}(p_1+r_1)+a_{j2}(p_2+r_2)+\cdots+a_{jn}(p_n+r_n).
\end{eqnarray*}
Vektor $\vep+\veq$ je tedy øe¹ením soustavy (2.1).

Právì jsme dokázali, ¾e øe¹itelná soustava (2.1) má jednoznaènì urèené øe¹ení právì kdy¾ pøíslu¹ná homogenní soustava (2.2) má pouze triviální øe¹ení. Poslední tvrzení tak plyne z Vìty~\ref{T:homo}.
\end{proof} 

\bigskip
\leftline{\bf Efektivita Gaussovy eliminace}

\smallskip\noindent 
Jak efektivní je algoritmus pro øe¹ení soustavy lineárních rovnic zalo¾ený na Gaussovì eliminaci a zpìtné substituci?
Efektivitu algoritmu mù¾eme mìøit rùznými zpùsoby. Kolik operaèní pamìti je k nìmu potøeba? Jak dlouho trvá výpoèet? 
Odpovìï na první otázku je dùle¾itá v pøípadì, ¾e algoritmus vy¾aduje velkou operaèní pamì». Velikost operaèní pamìti se stále zvìt¹uje. Moje první PC v roce 1988 mìlo 512kB operaèní pamìti. Nyní pou¾ívám notebook, který má 512MB operaèní pamìti. Dùle¾itost odhadu velikosti operaèní pamìti, která je tøeba pro realizaci algoritmu, se proto v èase mìní. Nyní lze bez problémù øe¹it úlohy, jejich¾ øe¹ení bylo je¹tì pøed 10 lety nemyslitelné.

Odpovìï na druhou otázku závisí pøedev¹ím na rychlosti procesoru. Ta se prudce zvy¹uje. Odhad efektivity algoritmu by nemìl záviset na tom, jak se vyvíjí hardware, na kterém algoritmus realizujeme. Mnohem vhodnìj¹í je spoèítat kolik základních operací musí algoritmus vykonat. Zrychlení procesoru znamená zkrácení doby, která je tøeba pro realizaci jednotlivých základních operací, nemìní ale jejich poèet. Gaussova eliminace pou¾ívá sèítání, odèítání, násobení a dìlení. Kromì toho pøi prohazování øádkù matice musí procesor pøepsat adresy, kde data uchovává. Doba potøebná pro pøepisování adres je zanedbatelná v porovnání s dobou, která je tøeba pro provedení základních aritmetických operací. Algoritmy pro základní aritmetické operace jsou vìt¹inou shodné s tìmi algoritmy, které jsme se uèili na prvním stupni základní ¹koly. Doba potøebná pro násobení/dìlení je tak podstatnì del¹í ne¾ doba potøebná pro sèítání/odèítání. Proto si spoèítáme zvlá¹», kolikrát je nutné pøi øe¹ení soustavy lineárních rovnic násobit/dìlit, a kolikrát je tøeba sèítat/odèítat.    

Zaèneme øe¹ením soustavy $n$ lineárních rovnic o $n$ neznámých, její¾ matice má hodnost $n$. Lze toti¾ ukázat, ¾e takové soustavy vy¾adují nejvíce operací mezi v¹emi soustavami, které mají nejvý¹e $n$ rovnic a nejvý¹e $n$ neznámých (zkuste si rozmyslet proè).

\begin{proposition}\label{T:GaussCount}
Øe¹ení soustavy $n$ lineárních rovnic o $n$ neznámých, její¾ matice má hodnost $n$, Gaussovou eliminací a zpìtnou substitucí vy¾aduje nejvý¹e
\begin{eqnarray*}
 \frac{1}{3}n^3+n^2-\frac{1}{3}n\ \ &\hbox{\rm násobení/dìlení, a}\\
 \frac{1}{3}n^3+\frac{1}{2}n^2-\frac{5}{6}n&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
\end{proposition}

\begin{proof}
Oznaème matici soustavy $\bAA=(a_{ij})$. Je to ètvercová matice øádu $n$ a podle pøedpokladu je její hodnost $n$. Oznaème dále vektor pravých stran $\veb$. Spoèítáme, kolik jakých operací je tøeba vykonat pøi prvním prùbìhu hlavního cyklu Gaussovy eliminace. V¹echny prvky prvního øádku roz¹íøené matice soustavy $[\bAA|\veb]$ s výjimkou prvku $a_{11}$ musíme vynásobit èíslem $a_{21}a_{11}^{-1}$. Výpoèet tohoto prvku vy¾aduje jedno dìlení a násobení celého prvního øádku s výjimkou prvku $a_{11}$ vy¾aduje dal¹ích $n$ násobení. Odeètení $(a_{21}a_{11}^{-1})$-násobku prvního øádku od druhého vy¾aduje $n$ odeèítání. Øádky sice mají $n+1$ prvkù, jejich první èísla ale nemusíme odeèítat. Koeficient $a_{21}a_{11}^{-1}$ jsme zvolili tak, abychom dostali na místì $(2,1)$ nulu. Celkem tedy pro úpravu druhého øádku potøebujeme 
\begin{eqnarray*}
& n+1\ \ &\hbox{\rm násobení/dìlení, a}\\
& n &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Tímto zpùsobem musíme upravit v¹ech $n-1$ øádkù pod prvním øádkem roz¹íøené matice soustavy $[\bAA|\veb]$. Celkem tedy první prùbìh cyklu Gaussovy eliminace vy¾aduje
\begin{eqnarray*}
& (n-1)(n+1)=n^2-1\ \ &\hbox{\rm násobení/dìlení, a}\\
& (n-1)n=n^2-n &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Pøi druhém prùbìhu hlavního cyklu Gaussovy eliminace se nemusíme zabývat prvky v prvním øádku a prvním sloupci. Druhý prùbìh tedy vy¾aduje

\begin{eqnarray*}
& (n-2)n=(n-1)^2-1\ \ &\hbox{\rm násobení/dìlení, a}\\
& (n-2)(n-1)=(n-1)^2-(n-1) &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Celá Gaussova eliminace tak vy¾aduje

\begin{eqnarray*}
\sum_{i=1}^n (i^2-1)\ =\  \frac13n^3+\frac12n^2-\frac56n\  &\hbox{\rm násobení/dìlení, a}\\
\sum_{i=1}^n (i^2-i)\ =\ \frac13n^3-\frac13n &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}

Proto¾e má matice $\bAA$ hodnost $n$, dostaneme po skonèení Gaussovy eliminace matici
\[
\left(
\begin{array}{ccccc}
d_{11} & d_{12} & \cdots & d_{1n} & e_1 \\
0 & d_{22} & \cdots & d_{2n} & e_2 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & d_{nn} & e_n
\end{array}
\right),
\]
ve které jsou v¹echny pivoty $d_{ii}\ne 0$.

Formulka pro výpoèet neznámé $x_i$ zpìtnou substitucí je
\[
x_i=\frac{1}{d_{ii}}(e_i-d_{i,i+1}x_{i+1}-d_{i,i+2}x_{i+2}-\cdots-d_{in}x_n)
\]
pro $i=1,2,\dots,n$. Výpoèet neznámé $x_i$ tak vy¾aduje 
\begin{eqnarray*}
& n-i+1\ \ &\hbox{\rm násobení/dìlení, a}\\
& n-i &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Celkem tedy zpìtná substituce vy¾aduje
\begin{eqnarray*}
\sum_{i=1}^n(n-i+1)\ =\  \sum_{i=1}^n i\ =\ \frac12n^2+\frac12n\ \  &\hbox{\rm násobení/dìlení, a}\\
\sum_{i=1}^n(n-i)\ =\ \sum_{i=0}^{n-1} i\ =\ \frac12n^2-\frac12n  &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Gaussova eliminace spolu se zpìtnou substitucí tak vy¾aduje celkem
\begin{eqnarray*}
 \frac13n^3+\frac12n^2-\frac56n\ + \frac12n^2+\frac12n\ =\ \frac13n^3+n^2-\frac13n &\hbox{\rm násobení/dìlení, a}\\
 \frac13n^3-\frac13n +\frac12n^2-\frac12n\ =\ \frac{1}{3}n^3-\frac{1}{2}n^2-\frac{5}{6}n  &\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
\end{proof}

\begin{cviceni}
Doka¾te v¹echny formulky pro sumy v pøedchozím dùkazu matematickou indukcí podle $n$.
\end{cviceni}

\bigskip
\leftline{\bf Spolehlivost Gaussovy eliminace}

\smallskip\noindent
Gaussova eliminace spolu se zpìtnou substitucí najde správnì v¹echna øe¹ení dané soustavy lineárních rovnic. 
Problém nastává v okam¾iku, kdy reálná èísla vyjadøujeme pomocí \emph{plovoucí desetinné èárky}, tj. ve tvaru
\[
\pm0,d_1d_2\cdots d_t\times \beta^{\epsilon},
\]
kde \emph{základ} $\beta$, \emph{exponent} $\epsilon$ a \emph{cifry }$0\leq d_i<\beta$ pro $i=1,2,\dots,t$ jsou celá èísla. Takovou reprezentaci reálných èísel pou¾ívá naprostá vìt¹ina programovacích jazykù. Obvyklý dekadický zápis dostaneme volbou $\beta=10$. Binární zápis dostaneme, pokud $\beta=2$.  $64$-bitový procesor pøirozenì pou¾ívá základ $\beta=2^{64}$. Èíslo $t$ nazýváme \emph{pøesnost} nebo také \emph{poèet platných cifer}. Problém je, ¾e èísla v tomto vyjádøení nejsou uzavøená na základní aritmetické operace. Souèin nebo podíl dvou takových èísel mù¾e vy¾adovat více platných cifer. V takovém pøípadì je výsledek zaokrouhlen na $t$ platných cifer. Aritmetika èísel vyjádøených pomocí plovoucí desetinné èárky \emph{není} exaktní. Výsledky základních aritmetických operací jsou zatí¾ené \emph{zaokrouhlovacími chybami.} Tyto chyby se v prùbìhu del¹ího výpoètu akumulují a dùsledkem mù¾e být, ¾e koneèný výsledek se velmi li¹í od správného výsledku, který dostaneme, pou¾íváme-li \emph{exaktní aritmetiku.}

Efekt zaokrouhlovacích chyb si uká¾eme na øe¹ení soustavy
\begin{eqnarray*}
47x+28y&=&19,\\
89x+53y&=&36.
\end{eqnarray*} 
Gaussova eliminace následovaná zpìtnou substitucí vede pøi pou¾ití exaktní aritmetiky k výsledku

\[
y=-1\ \ \hbox{\rm a}\ \ x=1.
\]
Zkusíme provést zcela stejný postup s pøesností na tøi platné cifry. První problém nastane hned pøi pokusu pøevést roz¹íøenou matici soustavy
\[
\left(
\begin{array}{*{1}ccc}
47&28&19\\
89&53&36
\end{array}
\right)
\] 
do øádkovì odstupòovaného tvaru. Pøi zaokrouhlování výsledku ka¾dé aritmetické operace na tøi platné cifry dostaneme po prvním cyklu Gaussovy eliminace matici

\[
\left(
\begin{array}{*{1}ccc}
47&28&19\\
0,2&0,1&0,1
\end{array}
\right).
\] 
Pokud tedy nepou¾íváme exaktní aritmetiku, mù¾e se stát, ¾e se nám nepodaøí pøevést matici do øádkovì odstupòovaného tvaru. Potom ale nelze pou¾ít zpìtnou substituci. 

Jedinou mo¾ností, jak tento problém obejít, je prostì napsat do matice èíslo $0$, pokud nìjakou operaci provádíme s cílem vynulovat pøíslu¹ný prvek matice. Èili Gaussova eliminace provádìná s pøesností na tøi platné cifry vede k matici
\[
\left(
\begin{array}{*{1}ccc}
47&28&19\\
0&0,1&0,1
\end{array}
\right).
\] 
Zpìtnou substitucí pak dostaneme øe¹ení

\[
y=1\ \ \hbox{\rm a}\ \ x=-0,191.
\] 

Problém zaokrouhlovacích chyb mù¾eme v nìkterých pøípadech odstranit \emph{parciální pivotací}. Ta spoèívá v tom, ¾e na místo pro pivot v¾dy pøevedeme pomocí první elementární øádkové úpravy \emph{nejvìt¹í} èíslo v absolutní hodnotì, které lze prohozením pøíslu¹ného øádku s nìjakým øádkem pod ním na toto místo dostat.

Parciální pivotace ale nepomù¾e v¾dy. Exaktní øe¹ení soustavy
\begin{eqnarray*}
-10x+10^5y&=&10^5,\\
x+y&=&2
\end{eqnarray*} 
je 
\[
x=\frac{10000}{10001}\ \ \hbox{\rm a}\ \ y=\frac{10002}{10001}.
\]
Nyní poèítáme øe¹ení s platností na tøi platné cifry. Proto¾e $|-10|>1$, není parciální pivotace nutná. Gaussova eliminace vede k matici
\[
\left(
\begin{array}{*{1}ccc}
-10&10^5&10^5\\
0&10^4&10^4
\end{array}
\right).
\]
Zpìtná substituce pak vede k øe¹ení
\[
x=0\ \ \hbox{\rm a}\ \ y=1.
\]

Problém s touto soustavou spoèívá ve skuteènosti, ¾e první rovnice obsahuje koeficienty, které jsou mnohem vìt¹í ne¾ koeficienty v druhé rovnici. Lze jej odstranit tím, ¾e zmìníme ``mìøítka", ve kterých poèítáme jednotlivé neznámé. V na¹em pøípadì pomù¾e, pokud nepoèítáme neznámou $y$, ale $y'=1000y$. Místo pùvodní soustavy tak øe¹íme soustavu
\begin{eqnarray*}
-10x+10y'&=&10^5,\\
x+10^{-3}y'&=&2.
\end{eqnarray*} 

®ádná obecnì pou¾itelná metoda pro vylouèení zaokrouhlovacích chyb ale neexistuje.

Problém zaokrouhlovacích chyb zdánlivì vyøe¹í systémy, které pou¾ívají exaktní aritmetiku. Jejich problém ale spoèívá v mnohem men¹í rychlosti výpoètù. Je-li nutné øe¹it soustavu s obrovským poètem rovnic a neznámých, mù¾e se stát, ¾e exaktní aritmetika je prakticky nepou¾itelná.

Pøi praktickém øe¹ení soustav lineárních rovnic se lze setkat je¹tì s problémem jiného druhu. Exaktní øe¹ení soustavy
\begin{eqnarray*}
0,835x+0,667y&=&0,168,\\
0,333x+0,266y&=&0,067
\end{eqnarray*} 
je
\[
x=1\ \ \hbox{\rm a}\ \ y=-1.
\]
Zmìníme-li nepatrnì pravou stranu druhé rovnice na $0,066$, dostaneme soustavu
\begin{eqnarray*}
0,835x+0,667y&=&0,168,\\
0,333x+0,266y&=&0,066,
\end{eqnarray*} 
která má exaktní øe¹ení

\[
x=-666\ \ \hbox{\rm a}\ \ y=834.
\]
O soustavách, u kterých nepatrná zmìna koeficientù zpùsobí velkou zmìnu øe¹ení, øíkáme ¾e jsou to \emph{chybnì formulované úlohy}. Geometrická pøíèina tohoto jevu je v na¹em konkrétním pøípadì následující. Ka¾dá rovnice urèuje pøímku v rovinì. Jejich prùseèík je øe¹ením soustavy. Smìrnice obou pøímek jsou témìø stejné. Nepatrný posun jedné z pøímek tak zpùsobí velký posun jejich prùseèíku.

Pokud jsou koeficienty soustavy výsledkem nìjakého mìøení, neznáme je nikdy s absolutní pøesností. Ka¾dý mìøící pøístroj má nìjakou toleranci. Øe¹ení chybnì formulované úlohy je nepøijatelnì závislé na pøesnosti odeètu výsledkù mìøení, která urèují koeficienty soustavy. Na takové øe¹ení je lépe se nespoléhat. Nutné je upravit fyzikální model, který k soustavì vedl tak, abychom po úpravì dostali úlohu, která není chybnì formulovaná. Exaktní aritmetika v tomto pøípadì nemù¾e pomoci.

Chybnì formulované úlohy mají je¹tì jeden rys, který je dobré si uvìdomit. Zkusme do soustavy
\begin{eqnarray*}
0,835x+0,667y&=&0,168,\\
0,333x+0,266y&=&0,067
\end{eqnarray*}
dosadit $x=-666$ a $y=834$. Dostaneme
\begin{eqnarray*}
0,835\cdot(-666)+0,667\cdot 834-0,168&=&0,\\
0,333\cdot(-666)+0,266\cdot 834-0,067&=&-0,001.
\end{eqnarray*}
Zdá se, ¾e èísla $x=-666$ a $y=834$ soustavì ``témìø" vyhovují. Ve skuteènosti se ale velmi li¹í od exaktního øe¹ení $x=1$ a $y=-1$. 

\bigskip
\leftline{\bf Gaussova-Jordanova eliminace}

\smallskip\noindent
Gaussova-Jordanova eliminace je upravená Gaussova eliminace, která pøevádí danou matici do \emph{redukovaného} øádkovì odstupòovaného tvaru.

\begin{definition}\label{D:RREF}
Matice $\EE$ tvaru $m\times n$ je v \emph{redukovaném øádkovì odstupòovaném tvaru}, jestli¾e
\begin{itemize}
	\item je v øádkovì odstupòovaném tvaru,
	\item první nenulový prvek v ka¾dém øádku (tj. ka¾dý pivot) se rovná $1$,
	\item v¹echny prvky nad ka¾dým pivotem (v tém¾e sloupci) jsou rovné $0$.
\end{itemize}
\end{definition}

Algoritmus pro Gaussovu-Jordanovu eliminaci získáme úpravou ètvrtého kroku algoritmu pro Gaussovu eliminaci. Ten provedeme v následující podobì:
\begin{itemize}
	\item pokud je na místì $(i,j)$ nenulové èíslo $b_{ij}$, vynásobíme $i$-tý øádek èíslem $b_{ij}^{-1}$ a poté pøièteme ke v¹em ostatním øádkùm rùzným od $i$-tého øádku vhodné násobky tohoto øádku tak, abychom vynulovali v¹echny prvky ve sloupci $\BB_{*j}$, rùzné od pivotu na místì $(i,j)$ (tj. opakovanì pou¾íváme tøetí elementární úpravu).
\end{itemize}

Gaussova-Jordanova eliminace je nároènìj¹í na výpoèet ne¾ Gaussova eliminace. O kolik nároènìj¹í nám øíká následující tvrzení.

\begin{proposition}\label{T:GaussJordanCount}
Øe¹ení soustavy $n$ lineárních rovnic o $n$ neznámých, její¾ matice má hodnost $n$, Gaussovou-Jordanovou eliminací a zpìtnou substitucí vy¾aduje nejvý¹e
\begin{eqnarray*}
 \frac{1}{2}n^3+\frac12n^2\ \ &\hbox{\rm násobení/dìlení, a}\\
 \frac{1}{2}n^3-\frac{1}{2}n&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
\end{proposition}

\begin{proof}
Dùkaz je podobný dùkazu Tvrzení~\ref{T:GaussCount}, proto budeme postupovat rychleji. Matici soustavy oznaèíme $\bAA=(a_{ij})$. Pøi prvním prùbìhu hlavního cyklu Gaussovy-Jordanovy eliminace potøebujeme $n$ násobení/dìlení pøi násobení prvního øádku èíslem $a_{11}^{-1}$. Vynulování prvku na místì $(2,1)$ vy¾aduje dal¹ích $n$ násobení/dìlení a $n$ sèítání/odèítání. To musíme udìlat se v¹emi $n-1$ øádky pod prvním øádkem. Celkem tedy první prùbìh hlavního cyklu vy¾aduje
\begin{eqnarray*}
 n+(n-1)n\ \ &\hbox{\rm násobení/dìlení, a}\\
 (n-1)n&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Abychom pøi druhém prùbìhu hlavního cyklu dostali èíslo $1$ na místì $(2,2)$, musíme pou¾ít $n-1$ násobení/dìlení. Vynulování v¹ech prvkù ve druhém sloupci s výjimkou èísla $1$ na místì $(2,2)$ vy¾aduje dal¹ích $(n-1)(n-1)$ násobení/dìlení a $(n-1)(n-1)$ sèítání/odèítání. Celkem tedy Gaussova-Jordanova eliminace vy¾aduje
\begin{eqnarray*}
 \sum_{i=1}^n(i+(n-1)i)=\frac{1}{2}n^3+\frac12n^2\ \ &\hbox{\rm násobení/dìlení, a}\\
 \sum_{i=1}^n(n-1)i=\frac{1}{2}n^3-\frac{1}{2}n&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}\end{proof}

Po skonèení Gaussovy-Jordanovy eliminace dostaneme matici
\[
\left(
\begin{array}{ccccc}
1 & 0 & \cdots & 0 & e_1 \\
0 & 1 & \cdots & 0 & e_2 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \cdots & 1 & e_n
\end{array}
\right),
\]
ze které pøímo vyèteme øe¹ení $x_i=e_i$ pro $i=1,2,\dots,n$. Zpìtnou substituci není nutné v tomto pøípadì provádìt. Poèet operací nutných pro Gaussovu-Jordanovu eliminaci tak staèí pro øe¹ení soustavy $n$ lineárních rovnic o $n$ neznámých s maticí hodnosti $n$. Srovnání Tvrzení~\ref{T:GaussCount} s Tvrzením~\ref{T:GaussJordanCount} ukazuje, ¾e øe¹ení soustavy Gaussovou-Jordanovou eliminací vy¾aduje zhruba o 50\% operací více, ne¾ výpoèet Gaussovou eliminací následovaný zpìtnou substitucí. Proè tedy vùbec o Gaussovì-Jordanovì eliminaci mluvit? Dùvod spoèívá v tom, ¾e Gaussova-Jordanova metoda se více hodí pro jiné úlohy ne¾ je øe¹ení soustav lineárních rovnic. Dále má urèité teoretické výhody, proto¾e platí následující vìta, kterou si rovnì¾ doká¾eme pozdìji.

\begin{proposition}\label{T:EAunique}
Pøevedeme-li matici $\bAA$ do redukovaného øádkovì odstupòovaného tvaru pomocí elementárních øádkových úprav, dostaneme jednoznaènì urèenou matici $\EE_{\bAA}$.
\end{proposition} 

Výsledkem Gaussovy-Jordanovy eliminace pou¾ité na nìjakou matici $\bAA$ je tedy jednoznaènì urèená matice $\EE_{\bAA}$. Narozdíl od výsledku Gaussovy eliminace, ve kterém jsou podle Tvrzení~\ref{T:pivotposition} jednoznaènì urèená pouze místa pro pivoty.


\chapter{Poèítání s maticemi}


Matice stejného tvaru mù¾eme sèítat a násobit reálným èíslem podobnì jako vektory stejné dimenze.

\begin{definition}\label{D:algebramatic}
Jsou-li $\bAA=(a_{ij})$ a $\BB=(b_{ij})$ dvì matice stejného tvaru $m\times n$, pak definujeme jejich \emph{souèet}
jako matici $\bAA+\BB=(c_{ij})$, kde $c_{ij}=a_{ij}+b_{ij}$ pro libovolné indexy $i=1,2,\dots,m$ a $j=1,2,\dots,n$.

Souèin matice $\bAA$ a èísla $k$ definujeme jako matici $k\bAA=(d_{ij})$ tvaru $m\times n$, kde $d_{ij}=ka_{ij}$ pro libovolné indexy $i,j$.
\end{definition}

Zavedeme si také oznaèení $\mathbf{0}_{m\times n}$ pro \emph{nulovou matici} tvaru $m\times n$. Ta má v¹echny prvky rovné $0$. Je-li tvar nulové matice zøejmý ze souvislostí, budeme ji znaèit pouze $\mathbf{0}$. Pro libovolnou matici $\bAA=(a_{ij})$ tvaru $m\times n$ oznaèujeme symbolem $-\bAA=(-a_{ij})$ \emph{opaènou matici} k matici $\bAA$.  

\begin{cviceni}\label{C:aritmetikamatic}
Matice $\bAA,\BB,\CC$ jsou stejného tvaru $m\times n$, $k,l$ jsou èísla. Doka¾te následující vlastnosti sèítání matic a násobení matic èíslem. 
\begin{enumerate}
	\item $(\bAA+\BB)+\CC=\bAA+(\BB+\CC)$,
	\item $\bAA+\BB=\BB+\bAA$, 
	\item $\bAA+\mathbf{0}=\bAA$,
	\item $\bAA+(-\bAA)=\mathbf{0}$,
	\item $(kl)\bAA=k(l\bAA)$,
	\item $k(\bAA+\BB)=k\bAA+k\BB$,
	\item $(k+l)\bAA=k\bAA+l\bAA$,
	\item $1\bAA=\bAA$.
\end{enumerate}
\end{cviceni}

Následující definice je zobecnìním vztahu mezi sloupcovým a øádkovým zápisem vektorù.
\begin{definition}
\emph{Transponovaná matice} k matici $\bAA$ tvaru $m\times n$ je matice $\bAA^T=(b_{ij})$ tvaru $n\times m$, kde $b_{ij}=a_{ji}$ pro libovolné indexy $i=1,2,\dots,m$ a $j=1,2,\dots,n$.
\end{definition}

Napøíklad
\[
\left(
\begin{array}{ccccc}
1 & 2 & 3 & 4 & 5 \\
1 & 2 & 3 & 8 & 5 \\
2 & 3 & 4 & 5 & 6
\end{array}
\right)^T=
\left(
\begin{array}{ccc}
1 & 1 & 2\\
2 & 2 & 3\\
3 & 3 & 4\\
4 & 8 & 5\\
5 & 5 & 6
\end{array}
\right).
\]

\begin{cviceni}
Doka¾te, ¾e pro libovolné matice $\bAA,\BB$ stejného tvaru platí
\begin{itemize}
	\item $(\bAA+\BB)^T=\bAA^T+\BB^T$,
	\item $(k\bAA)^T=k\bAA^T$,
	\item $(\bAA^T)^T=\bAA$.
\end{itemize}
\end{cviceni}


Dále zavedeme názvy pro nìkolik speciálních typù matic. Je-li $\bAA=(a_{ij})$ ètvercová matice øádu $n$, pak øíkáme, ¾e prvky $a_{ii}$ pro $i=1,2,\dots,n$ le¾í na \emph{hlavní diagonále} matice $\bAA$. Ostatní prvky $a_{ij}$, kde $i\ne j$, le¾í mimo hlavní diagonálu.

\begin{definition}
Symbolem $\II_n$ budeme oznaèovat ètvercovou matici $(a_{ij})$ øádu $n$, která má na hlavní diagonále samé prvky $1$ a mimo hlavní diagonálu samé prvky $0$:
\[
\II_n=
\left(
\begin{array}{cccc}
1 & 0 & \cdots & 0   \\
0 & 1 & \cdots & 0 \\
\vdots & \vdots & \ddots &  \vdots \\
0 & 0 & \cdots & 1 
\end{array}
\right)
\]
Tuto matici budeme nazývat \emph{jednotková matice} øádu $n$.

Ètvercová matice $\BB=(b_{ij})$ se nazývá \emph{symetrická} matice, jestli¾e platí $b_{ij}=b_{ji}$ pro libovolné indexy $i,j$, tj. jestli¾e platí $\bAA^T=\bAA$.

Ètvercová matice $\BB=(b_{ij})$ se nazývá \emph{kososymetrická} matice, jestli¾e platí $b_{ij}=-b_{ji}$ pro libovolné indexy $i,j$, tj. platí-li $\bAA^T=-\bAA$.
\end{definition}

Základní definicí této kapitoly je definice souèinu matic.

\begin{definition}\label{D:soucinmatic}
Je-li $\bAA=(a_{ij})$ matice tvaru $m\times n$ a $\BB=(b_{jk})$ matice tvaru $n\times p$, pak definujeme \emph{souèin} matic $\bAA\BB=(c_{ik})$ jako matici tvaru $m\times p$, kde
\[
c_{ik}=\sum_{j=1}^n a_{ij}b_{jk}.
\]
\end{definition}

Podle této definice mù¾eme násobit pouze takové dvojice matic, u kterých se poèet sloupcù první matice rovná poètu øádkù druhé matice. Stejnì jako v pøípadì souètu matic tak ani souèin matic není definován pro libovolné dvì matice. 

Prvek na místì $(i,k)$ souèinu $\bAA\BB$ se rovná standardnímu \emph{skalárnímu souèinu} $i$-tého øádku matice $\bAA$ s $j$-tým sloupcem matice $\BB$. Neformální vyjádøení pro zpùsob výpoètu souèinu matic øíká, ¾e matice násobíme zpùsobem ``øádek$\times$sloupec".

\begin{cviceni}\label{C:soucinmatic}
Spoèítejte souèin nìkolika dvojic matic. Spoèítejte oba souèiny $\bAA\BB$ a $\BB\bAA$ pro nìjaké dvì ètvercové matice stejného øádu. Je násobení matic komutativní, tj. platí $\bAA\BB=\BB\bAA$ pro libovolné dvì matice $\bAA$ tvaru $m\times n$ a $\BB$ tvaru $n\times m$? Platí to pro libovolné dvì ètvercové matice øádu $n$? 
\end{cviceni}

Soustavu (2.1) tak nyní mù¾eme vyjádøit pomocí souèinu matic ve tvaru
\[
\bAA\vex=\veb,
\]
kde $\bAA=(a_{ij})$ je matice soustavy, $\veb=(b_1,\dots,b_m)^T$ je sloupcový vektor pravých stran a $\vex=(x_1,\dots,x_n)^T$ je sloupcový vektor neznámých.

\begin{cviceni}
Je-li $\bAA$ matice tvaru $m\times n$, pak platí
\[
\II_m\bAA=\bAA=\bAA\II_n.
\]
Doka¾te.
\end{cviceni}

Jakkoliv vypadá definice souèinu matic na první pohled umìle, ve skuteènosti je pøirozená a lze ji udùvodnit, skládáme-li zobrazení ve dvoudimenzionálním aritmetickém reálném vektorovém prostoru.

\begin{uloha}
Oznaème symbolem $f$ zobrazení definované na prostoru $\RRR_2$ pøedpisem
 \[
f\left(\begin{array}{c}x\\
                     y
       \end{array}\right)=
 \left(\begin{array}{c}ax+by\\
                     cx+dy
       \end{array}\right),                    
\]
kde $a,b,c,d$ jsou reálná èísla. Podobnì oznaèíme $g:\RRR_2\to\RRR_2$ zobrazení definované pøedpisem
 \[
g\left(\begin{array}{c}x\\
                     y
       \end{array}\right)=
 \left(\begin{array}{c}Ax+By\\
                     Cx+Dy
       \end{array}\right),                    
\]
kde $A,B,C,D$ jsou také reálná èísla. Popi¹te, jak vypadá slo¾ené zobrazení $g\circ f$.
\end{uloha} 

\begin{reseni}
V¹imnìte si, ¾e pøedpis pro zobrazení $f$ mù¾eme pomocí násobení matic vyjádøit následovnì:
\[
f\left(\begin{array}{c}x\\
                     y
       \end{array}\right)=\left(\begin{array}{cc}a&b\\c&d\end{array}\right)\left(\begin{array}{c}x\\
                     y
       \end{array}\right).
\]
Lze øíct, ¾e 
$$
\bAA=\left(\begin{array}{cc}a&b\\c&d\end{array}\right)
$$ 
je \emph{matice zobrazení} $f$. Podobnì rovnost
\[
g\left(\begin{array}{c}x\\
                     y
       \end{array}\right)=\left(\begin{array}{cc}A&B\\C&D\end{array}\right)\left(\begin{array}{c}x\\
                     y
       \end{array}\right)
\]
ukazuje, ¾e matici
$$
\BB=\left(\begin{array}{cc}A&B\\C&D\end{array}\right)
$$ 
mù¾eme pova¾ovat za matici zobrazení $g$.

Pokusíme se najít podobné maticové vyjádøení pro slo¾ené zobrazení $g\circ f$. Platí 
 \begin{eqnarray*}
(g\circ f)\left(\begin{array}{c}x\\
                     y
       \end{array}\right)&=& gf\left(\begin{array}{c}x\\
                     y
       \end{array}\right)=
 g\left(\begin{array}{c}ax+by\\
                     cx+dy
       \end{array}\right)=\\
       &=&\left(\begin{array}{c}A(ax+by)+B(cx+dy)\\
                     C(ax+by)+D(cx+dy)\end{array}\right)=\\
       &=&\left(\begin{array}{c}(Aa+Bc)x+(Ab+Bd)y\\
                     (Ca+Dc)x+(Cb+Dd)y\end{array}\right)=\\
       &=&\left(\begin{array}{cc}Aa+Bc&Ab+Bd\\Ca+Dc&Cb+Dd\end{array}\right)\left(\begin{array}{c}x\\
                     y
       \end{array}\right)=\\
       &=&\left(\left(\begin{array}{cc}A&B\\C&D\end{array}\right)
       \left(\begin{array}{cc}a&b\\c&d\end{array}\right)\right)\left(\begin{array}{c}x\\y\end{array}\right).                           \end{eqnarray*}
       
Výpoèet ukazuje, ¾e matice slo¾eného zobrazení $g\circ f$ se rovná souèinu $\BB\bAA$ matic zobrazení $g$ a $f$ (v tomto poøadí).                    
\end{reseni}

Následující cvièení udává, kolik aritmetických operací je tøeba uskuteènit pro výpoèet souèinu matic.

\begin{cviceni}
Jsou-li $\bAA, \BB$ dvì ètvercové matice øádu $n$, pak pro výpoèet souèinu $\bAA\BB$ potøebujeme nejvý¹e
\begin{eqnarray*}
& n^3&\hbox{\rm násobení/dìlení, a}\\
& n^3-n^2&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
\end{cviceni}

Násobení a sèítání matic mají øadu vlastností spoleèných s násobením a sèítáním èísel.

\begin{proposition}\label{T:aritmatic}
Jsou-li $\bAA=(a_{ij})$, $\BB=(b_{kl})$ a $\CC=(c_{uv})$ matice, pak platí
\begin{itemize}
	\item $\bAA(\BB+\CC)=\bAA\BB+\bAA\CC$,
	\item $(\bAA+\BB)\CC=\bAA\CC+\BB\CC$,
	\item $(\bAA\BB)\CC=\bAA(\BB\CC)$
\end{itemize}
za pøedpokladu, ¾e v¹echny souèty a souèiny matic v pøíslu¹né rovnosti existují.
\end{proposition}

\begin{proof}
Aby existovaly oba souèty a v¹echny tøi souèiny v první rovnosti, musí být matice $\bAA$ tvaru $m\times n$ a obì matice $\BB,\CC$ musí být tvaru $n\times p$. Uká¾eme, ¾e èísla na stejném místì $(i,k)$ v obou maticích $\bAA(\BB+\CC)$ a $\bAA\BB+\bAA\CC$ jsou stejná.

Èíslo na místì $(j,k)$ v souètu $\BB+\CC$ se rovná $b_{jk}+c_{jk}$. Prvek na místì $(i,k)$ v souèinu $\bAA(\BB+\CC)$ se proto rovná
\[
\sum_{j=1}^n a_{ij}(b_{jk}+c_{jk})= \sum_{j=1}^n (a_{ij}b_{jk}+a_{ij}c_{jk}).
\]

Prvek na místì $(i,k)$ v souèinu $\bAA\BB$ se rovná
\[
\sum_{i=1}^n a_{ij}b_{jk}
\]
a prvek na místì $(i,k)$ v souèinu $\bAA\CC$ se rovná 
\[
\sum_{i=1}^n a_{ij}c_{jk}.
\]
Proto je prvek na místì $(i,k)$ v souètu $\bAA\BB+\bAA\CC$ rovný
\[
\sum_{i=1}^n a_{ij}b_{jk}+a_{ij}c_{jk}.
\]

Prvky na stejných místech v maticích $\bAA(\BB+\CC)$ a $\bAA\BB+\bAA\CC$ jsou shodné, co¾ dokazuje první rovnost.

V¹imnìte si, ¾e právì dokázaná distributivita násobení matic vzhledem k jejich sèítání je bezprostøedním dùsledkem distributivity násobení reálných èísel vzhledem k jejich sèítání.

Pokud jste si udìlali celé Cvièení~\ref{C:soucinmatic} tak víte, ¾e násobení matic není komutativní. Druhá rovnost v Tvrzení~\ref{T:aritmatic} tak není dùsledkem právì dokázané rovnosti a je nutné ji dokázat zvlá¹». Doka¾te si ji sami jako dal¹í cvièení.

V pøípadì asociativity násobení matic musí být matice $\bAA$ tvaru $m\times n$, $\BB$ tvaru $n\times p$ a matice $\CC$ musí být tvaru $p\times q$. Souèin $\bAA\BB$ má potom tvar $m\times p$, jeho prvky si oznaèíme 
\[
d_{ik}=\sum_{j=1}^n a_{ij}b_{jk}.
\] 
Prvek na místì $(i,l)$ v souèinu $(\bAA\BB)\CC$ se tak rovná
\[
\sum_{k=1}^p d_{ik}c_{kl}=\sum_{k=1}^p (\sum_{j=1}^n a_{ij}b_{jk})c_{kl}=\sum_{k=1}^p\sum_{j=1}^n (a_{ij}b_{jk})c_{kl}=
\sum_{j=1}^n\sum_{k=1}^p a_{ij}b_{jk}c_{kl}.
\]
Poslední rovnost vyplývá z komutativity sèítání a asociativity násobení reálných èísel.

Matice $\BB\CC=(e_{jl})$ je tvaru $n\times q$. Prvek $e_{jl}$ má podle definice násobení matic vyjádøení
\[
e_{jl}=\sum_{k=1}^q b_{jk}c_{kl}.
\] 
Prvek  na místì $(i,l)$ v souèinu $\bAA(\BB\CC)$ se tak rovná
\[
\sum_{j=1}^n a_{ij}e_{jl}=\sum_{j=1}^n a_{ij}\sum_{k=1}^q b_{jk}c_{kl}=\sum_{j=1}^n\sum_{k=1}^q a_{ij}(b_{jk}c_{kl})=
\sum_{j=1}^n\sum_{k=1}^q a_{ij}b_{jk}c_{kl}.
\]
Tím je dùkaz asociativity násobení dokonèen.
\end{proof}

Dal¹í dvì cvièení se týkají transponovaných matic.
\begin{cviceni}\label{C:matice}
Matice $\bAA$ má tvar $m\times n$ a matice $\BB$ má tvar $n\times p$. Doka¾te, ¾e platí
\begin{itemize}
	\item $(\bAA\BB)^T=\BB^T\bAA^T$
	\item $\bAA(k\BB)=k(\bAA\BB)$ pro libovolné èíslo $k$.
\end{itemize}
\end{cviceni}

Zmìna poøadí matic v souèinu $\BB^T\bAA^T$ je nutná kvùli tomu, aby je vùbec bylo mo¾né násobit. 

\begin{cviceni}
Doka¾te, ¾e pro ka¾dou matici $\bAA$ jsou souèiny $\bAA\bAA^T$ a $\bAA^T\bAA$ symetrické matice. Musíte poèítat jednotlivé prvky v tìchto maticích?
\end{cviceni}

Døíve, ne¾ se zaèneme zabývat strukturou souèinu matic, uvedeme je¹tì jednu definici.

\begin{definition}\label{D:linzavislost}
Jsou-li $\vea$ a $\veb_1,\veb_2,\dots,\veb_k$ vektory stejné dimenze $n$, pak øíkáme, ¾e vektor $\vea$ je \emph{lineární kombinací} vektorù $\veb_1,\veb_2,\dots,\veb_k$, jestli¾e
\[
\vea=t_1\veb_1+t_2\veb_2+\cdots+t_k\veb_k
\]
pro nìjaká èísla $t_1,t_2,\dots,t_k$. Tìmto èíslùm øíkáme \emph{koeficienty lineární kombinace}. Skuteènost, ¾e vektor $\vea$ je lineární kombinací vektorù $\veb_1,\veb_2,\dots,\veb_k$, vyjadøujeme také slovy, ¾e vektor $\vea$ je \emph{lineárnì závislý} na vektorech $\veb_1$, $\veb_2,\dots,\veb_k$.
\end{definition}
 
Vyøe¹it soustavu lineárních rovnic $\bAA\vex=\veb$ znamená najít (v¹echna) vyjádøení sloupce pravých stran jako lineární kombinace sloupcù matice $\bAA$.

\begin{proposition}\label{T:strukturasoucinu} 
Jsou-li $\bAA=(a_{ij})$ matice tvaru $m\times n$ a $\BB=(b_{jk})$ matice tvaru $n\times p$, pak platí
\begin{itemize}
	\item $[\bAA\BB]_{i*}=\bAA_{i*}\BB=\sum_{j=1}^n a_{ij}\BB_{j*}$ pro libovolné $i=1,2,\dots,m$,
	\item $[\bAA\BB]_{*k}=\bAA\BB_{*k}=\sum_{j=1}^n b_{jk}\bAA_{*j}$ pro libovolné $k=1,2,\dots,p$.
\end{itemize}
\end{proposition}

První rovnost pro $i$-tý øádek souèinu $\bAA\BB$ øíká, ¾e se rovná souèinu $i$-tého øádku matice $\bAA$ s maticí $\BB$. Druhá rovnost pak øíká, ¾e je lineární kombinací øádkù matice $\BB$ s koeficienty v $i$-tém øádku matice $\bAA$. Podobnì $k$-tý sloupec v souèinu $\bAA\BB$ se rovná souèinu matice $\bAA$ s $k$-tým sloupcem matice $\BB$. Rovná se také lineární kombinaci sloupcù matice $\bAA$ s koeficienty v $k$-tém sloupci matice $\BB$. 

\smallskip
\begin{proof}
Doká¾eme pouze vyjádøení sloupcù v souèinu. Dùkaz pro øádky je analogický.

Prvek na místì $(i,k)$ v souèinu $\bAA\BB$, tj. $i$-tá souøadnice sloupcového vektoru $[\bAA\BB]_{*k}$, se rovná 
\[
\sum_{j=1}^n a_{ij}b_{jk}.
\] 

Podobnì $i$-tá souøadnice sloupcového vektoru $\bAA\BB_{*k}$ se rovná
\[
\sum_{j=1}^n a_{ij}b_{jk}.
\]

Nakonec $i$-tá souøadnice lineární kombinace $b_{1k}\bAA_{*1}+b_{2k}\bAA_{*2}+\cdots+b_{nk}\bAA_{*n}$ se rovná
\[
\sum_{j=1}^n b_{jk}a_{ij}.
\]

V¹echna tøi èísla jsou stejná, proto se tøi uvedená vyjádøení pro $k$-tý sloupec souèinu $\bAA\BB$ rovnají.
\end{proof}

\bigskip
\leftline{\bf Inverzní matice}

\smallskip\noindent
\begin{definition}\label{D:inverznimatice}
Jsou-li $\bAA$ a $\BB$ dvì ètvercové matice stejného øádu $n$, pak øíkáme, ¾e $\BB$ je \emph{inverzní matice} k matici $\bAA$, jestli¾e platí
\[
\bAA\BB=\II_n.
\]
Pokud existuje inverzní matice k matici $\bAA$, oznaèujeme ji $\bAA^{-1}$. Ètvercová matice $\bAA$ se nazývá \emph{regulární}, jestli¾e existuje inverzní matice $\bAA^{-1}$. V opaèném pøípadì se nazývá \emph{singulární}.
\end{definition}

Inverzní matice tedy mù¾e existovat pouze ke ètvercové matici. Jak zjistíme, jestli k dané ètvercové matici $\bAA=(a_{ij})$ existuje inverzní matice $\bAA^{-1}$? A pokud existuje, jak ji spoèítáme? Tìmito otázkami se budeme nyní zabývat. 

Oznaèíme symbolem $\ee_k$ $k$-tý sloupec jednotkové matice $\II_n$ øádu $n$. Souøadnice vektoru $\ee_k$ se rovnají $0$ s výjimkou $k$-té souøadnice, která se rovná~$1$.

Pokud inverzní matice $\bAA^{-1}=(b_{jk})$ k matici $\bAA$ existuje, musí její $k$-tý sloupec $\bAA^{-1}_{*k}=(b_{1k},b_{2k},\dots,b_{nk})^T$ podle Tvrzení~\ref{T:strukturasoucinu} splòovat rovnosti
\[
\ee_k=[\II_n]_{*k}=[\bAA\bAA^{-1}]_{*k}=\bAA\bAA^{-1}_{*k}=\sum_{j=1}^n \bAA_{*j}b_{jk}.
\]
To znamená, ¾e $k$-tý sloupec $\bAA^{-1}_{*k}$ inverzní matice $\bAA^{-1}$ je øe¹ením soustavy $n$ lineárních rovnic o $n$ neznámých $\bAA\vex=\ee_k$. Abychom inverzní matici $\bAA^{-1}$ vypoèítali, musíme vyøe¹it $n$ soustav lineárních rovnic \[
\bAA\vex=\ee_k\ \ \ \hbox{\rm pro }\ k=1,\dots,n.
\] 

Proto¾e mají soustavy stejnou matici $\bAA$, mù¾eme je øe¹it v¹echny souèasnì pomocí elementárních øádkových úprav matice
\[
[\bAA|\II_n]=[\bAA|\ee_1|\ee_2|\cdots|\ee_n]
\]
tvaru $n\times(2n)$.

Tuto matici pøevedeme pomocí elementárních øádkových úprav do øádkovì odstupòovaného tvaru $[\EE|\BB]$. Matici $\EE$ jsme tedy dostali pomocí elementárních øádkových úprav z matice $\bAA$ a podobnì jsme dostali matici $\BB$ pomocí elementárních øádkových úprav z jednotkové matice $\II_n$. Proto¾e jsou v¹echny elementární øádkové úpravy vratné, dostaneme také jednotkovou matici $\II_n$ zpìt z matice $\BB$  pomocí elementárních øádkových úprav. Matice $\II_n$ je v øádkovì odstupòovaném tvaru (dokonce v redukovaném øádkovì odstupòovaném tvaru) a neobsahuje ¾ádný nulový øádek. Matice $\BB$ má proto hodnost $n$. Speciálnì tak matice $\BB$ neobsahuje ¾ádný nulový øádek.

Matice $\BB$ tak obsahuje nìjaký nenulový prvek $c$ v posledním øádku. Nech» je v $k$-tém sloupci. Pomocí elementárních øádkových úprav dostaneme z matice $[\bAA|\ee_k]$ -- roz¹íøené matice soustavy $\bAA\vex=\ee_k$, jejím¾ øe¹ením je $k$-tý sloupec inverzní matice $\bAA^{-1}$ -- matici $[\EE|\cc]$, kde prvek v posledním øádku posledního sloupce $\cc$ je $c\ne 0$. Pokud inverzní matice $\bAA^{-1}$ existuje, musí být soustava $\bAA\vex=\ee_k$ øe¹itelná. Matice $\EE$ tak nemù¾e obsahovat ¾ádný nulový øádek. Proto¾e je v øádkovì odstupòovaném tvaru a dostali jsme ji z $\bAA$ pomocí elementárních øádkových úprav, znamená to, ¾e hodnost $r(\bAA)$ matice $\bAA$ se rovná $n$.

Dokázali jsme tak, ¾e pokud inverzní matice $\bAA^{-1}$ existuje, musí platit $r(\bAA)=n$. Naopak, pokud $r(\bAA)=n$, má ka¾dá soustava $\bAA\vex=\ee_k$ pro $k=1,\dots,n$ (jednoznaèné) øe¹ení podle Vìty~\ref{V:obecres}. Inverzní matice $\bAA^{-1}$ proto existuje. Tím jsme dokázali èást následující vìty.

\begin{theorem}\label{V:existenceinverze}
Pøedpokládáme, ¾e $\bAA$ je ètvercová matice øádu $n$. Potom je ekvivalentní
\begin{enumerate}
	\item inverzní matice $\bAA^{-1}$ existuje, tj. matice $\bAA$ je regulární,
	\item $r(\bAA)=n$,
	\item Gaussova-Jordanova eliminace pøevede matici $\bAA$ do matice $\II_n$,
	\item homogenní soustava $\bAA\vex=\mathbf{0}$ má pouze triviální øe¹ení $\vex=\mathbf{0}$.
\end{enumerate}
\end{theorem}


\begin{proof}
Ekvivalenci $1\Leftrightarrow 2$ jsme dokázali pøed Vìtou~\ref{V:existenceinverze}.

$2\Rightarrow 3$. Je-li hodnost $r(\bAA)=n$, obsahuje ka¾dá matice $\EE$ v øádkovì odstupòovaném tvaru, kterou dostaneme z $\bAA$ pomocí elementárních øádkových úprav z matice $\bAA$, celkem $n$ pivotù, v¹echny sloupce jsou tedy bázové. Proto¾e má $n$ øádkù, jsou také v¹echny øádky nenulové. Pou¾ijeme-li Gaussovu-Jordanovu eliminaci, jsou v¹echny pivoty v $\EE$ rovné $1$ a ostatní prvky matice $\EE$ se rovnají $0$. Matice $\EE$ se proto rovná jednotkové matici $\II_n$.

$3\Rightarrow 4$. Pokud Gaussova-Jordanova eliminace pøevádí matici $\bAA$ do jednotkové matice $\II_n$, pøevádí matici $[\bAA|\mathbf{0}]$ -- roz¹íøenou matici soustavy $\bAA\vex=\mathbf{0}$ -- do matice $[\II_n|\mathbf{0}]$. Soustava $\bAA\vex=\mathbf{0}$ má proto pouze triviální øe¹ení $x_i=0$ pro $i=1,2,\dots,n$.

$4\Rightarrow 2$. Má-li homogenní soustava $\bAA\vex=\mathbf{0}$ pouze triviální øe¹ení, je $r(\bAA)=n$ podle Vìty~\ref{T:homo}.

Tím je ekvivalence v¹ech ètyø výrokù dokázána. 
\end{proof}

Z úvah pøed Vìtou~\ref{V:existenceinverze} také pøímo dostaneme algoritmus pro výpoèet inverzní matice ke ètvercové matici $\bAA$ øádu $n$, pokud existuje, tj. pokud $r(\bAA)=n$.

\begin{itemize}
	\item Gaussovou-Jordanovou eliminací pøevedeme matici $[\bAA|\II_n]$ do matice $[\II_n|\BB]$. Potom $\bAA^{-1}=\BB$.
\end{itemize}

V tom pøípadì je toti¾ $k$-tý sloupec matice $\BB$ øe¹ením soustavy $\bAA\vex=\ee_k$ pro $k=1,2,\dots,n$. Podle Tvrzení~\ref{T:strukturasoucinu} tak platí 
\[
[\bAA\BB]_{*k}=\bAA\BB_{*k}=\ee_k,
\]
co¾ znamená
\[
\bAA\BB=\II_n.
\]

\begin{cviceni}
Spoèítejte inverzní matice k nìkolika regulárním maticím. Napi¹te program pro výpoèet inverzní matice.
\end{cviceni}

Spoèítáme je¹tì, kolik operací vy¾aduje výpoèet inverzní matice algoritmem zalo¾eným na Gaussovì-Jordanovì eliminaci.

\begin{proposition}\label{T:InverseCount}
Pro výpoèet inverzní matice $\bAA^{-1}$ k regulární matici $\bAA$ øádu $n$ Gaussovou-Jordanovou eliminací je tøeba nejvý¹e
\begin{eqnarray*}
& n^3&\hbox{\rm násobení/dìlení, a}\\
& n^3-2n^2+n&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*} 
\end{proposition}

\begin{proof}
Podobnì jako v dùkazu Tvrzení~\ref{T:GaussJordanCount} spoèítáme, ¾e první prùbìh hlavního cyklu Gaussovy-Jordanovy eliminace vy¾aduje
\begin{eqnarray*}
& n+(n-1)n=n^2&\hbox{\rm násobení/dìlení, a}\\
& (n-1)(n-1)=n^2-2n+1&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*}
Ni¾¹í poèet sèítání/odèítání vyplývá z toho, ¾e v¹echny prvky v prvním sloupci matice $\II_n$ pod prvním øádkem se rovnají $0$. Stejný poèet operací je tøeba pøi v¹ech $n$ prùbìzích hlavního cyklu Gaussovy-Jordanovy eliminace. Odtud ihned vyplývá celkový poèet operací. 
\end{proof}

Doká¾eme si je¹tì následující u¾iteèné tvrzení.

\begin{proposition}\label{T:obeinverze}
Jsou-li $\bAA$ a $\BB$ dvì ètvercové matice stejného øádu $n$, pak platí
\[
\bAA\BB=\II_n\ \ \hbox{\rm právì kdy¾ }\ \BB\bAA=\II_n.
\]
\end{proposition}

\begin{proof}
Je-li $\bAA\BB=\II_n$, pak pro libovolný nenulový vektor $\vex$ dimenze $n$ platí
\[
\bAA(\BB\vex)=(\bAA\BB)\vex=\II_n\vex=\vex\ne\mathbf{0}.
\]
Musí proto platit $\BB\vex\ne\mathbf{0}$. Homogenní soustava $\BB\vex=\mathbf{0}$ tak má pouze triviální øe¹ení. Podle Vìty~\ref{T:homo} platí $r(\BB)=n$ a podle Vìty~\ref{V:existenceinverze} je matice $\BB$ regulární. Rovnost $\bAA\BB=\II_n$ mù¾eme proto vynásobit zprava maticí $\BB^{-1}$ inverzní k $\BB$. Dostaneme
\[
\bAA=\bAA\II_n=\bAA(\BB\BB^{-1})=(\bAA\BB)\BB^{-1}=\II_n\BB^{-1}=\BB^{-1}.
\]
Proto $\BB\bAA=\BB\BB^{-1}=\II_n$.

Opaènou implikaci doká¾eme naprosto stejnì.
\end{proof}

Poslední tvrzení nám dovoluje ``snadno" vyøe¹it soustavu $\bAA\vex=\veb$, pokud je matice soustavy $\bAA$ regulární. Staèí soustavu vynásobit zleva inverzní maticí $\bAA^{-1}$. Dostaneme
\[
\vex=\II_n\vex=(\bAA^{-1}\bAA)\vex=\bAA^{-1}(\bAA\vex)=\bAA^{-1}\veb.
\]
Soustava má proto (jediné) øe¹ení $\bAA^{-1}\veb$.

Pohled na Tvrzení~\ref{T:InverseCount} a Tvrzení~\ref{T:GaussCount} ukazuje, proè je toto vyjádøení øe¹ení soustavy $\bAA\vex=\veb$ výhodné pouze pro teoretické zkoumání, nikoliv pro praktický výpoèet øe¹ení této soustavy. Výpoèet souèinu $\bAA^{-1}\veb$ vy¾aduje
\begin{eqnarray*}
& n^2&\hbox{\rm násobení/dìlení, a}\\
& n(n-1)&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*} 
Celkem tak výpoèet inverzní matice $\bAA^{-1}$ Gaussovou-Jordanovou metodou a souèinu $\bAA^{-1}\veb$ potøebuje
\begin{eqnarray*}
& n^3+n^2&\hbox{\rm násobení/dìlení, a}\\
& n^3-n^2&\hbox{\rm sèítání/odèítání}.
\end{eqnarray*} 
Tento výpoèet tak vy¾aduje zhruba trojnásobný poèet operací a tedy trojnásobné mno¾ství èasu ne¾ pøímý výpoèet øe¹ení pomocí Gaussovy eliminace a zpìtné substituce.

Je také zajímavé v¹imnout si, ¾e výpoèet inverzní matice k regulární matici øádu $n$ potøebuje zhruba stejnì operací jako výpoèet souèinu dvou ètvercových matic øádu $n$. Na první pohled se zdá být výpoèet inverzní matice mnohem nároènìj¹í.

Následující cvièení shrnuje základní vlastnosti inverzních matic. Snadno je doká¾ete za pou¾ití poznatkù z této kapitoly.

\begin{cviceni}\label{C:soucinregularni}
Doka¾te, ¾e pro regulární matice $\bAA, \BB$ stejného øádu $n$ platí
\begin{itemize}
	\item $(\bAA^{-1})^{-1}=\bAA$,
	\item souèin $\bAA\BB$ je také regulární matice,
	\item $(\bAA\BB)^{-1}=\BB^{-1}\bAA^{-1}$,
  \item $(\bAA^{-1})^T=(\bAA^T)^{-1}$.
\end{itemize}
\end{cviceni}

Z druhého tvrzení ihned indukcí podle $k$ snadno doká¾ete, ¾e souèin $\bAA_1\bAA_2\cdots\bAA_k$ je regulární matice, jsou-li v¹echny matice $\bAA_i$ regulární a stejného øadu $n$. V tom pøípadì 
\[
(\bAA_1\bAA_2\cdots\bAA_k)^{-1}=\bAA_k^{-1}\cdots\bAA_2^{-1}\bAA_1^{-1}.
\]

Ètvrté tvrzení pak znamená, ¾e matice transponovaná k regulární matici je opìt regulární, a ¾e inverzní matici k $\bAA^T$ dostaneme jako matici transponovanou k $\bAA^{-1}$.

Následující obtí¾nìj¹í cvièení vám uká¾e, jak dobøe jste èást o inverzních maticích zvládli. Je v nìm uvedeno mimo jiné, jak rychle spoèítat inverzní matici k matici, kterou dostaneme z dané regulární matice $\bAA$ zmìnou jednoho prvku, pokud ji¾ známe inverzní matici $\bAA^{-1}$.

\begin{cviceni} Pøedpokládáme, ¾e $\bAA=(a_{ij})$ je regulární matice øádu $n$ a $\ee_i$ pro $i=1,2,\dots,n$ je $i$-tý sloupcový vektor jednotkové matice $\II_n$. Doka¾te, ¾e platí
\begin{itemize}
	\item souèin $\alpha\ee_i\ee_j^T$ je ètvercová matice, která má v¹echny prvky nulové s výjimkou prvku na místì $(i,j)$, který se rovná èíslu $\alpha$,
	\item je-li $\BB=\bAA+\alpha\ee_i\ee_j^T$, tj. $\BB$ se li¹í od $\bAA$ pouze v prvku na místì $(i,j)$, ke kterému jsme pøièetli èíslo $\alpha$, a oznaèíme-li dále $\bAA^{-1}=(b_{ij})$, pak
	\[
	\BB^{-1}=(\bAA+\alpha\ee_i\ee_j^T)^{-1}=\bAA^{-1}-\alpha\frac{[\bAA^{-1}]_{*i}[\bAA^{-1}]_{j*}}{1+\alpha b_{ji}},
	\]
pokud je èíslo ve jmenovateli nenulové (jde o speciální pøípad tzv. Shermanovy-Morrisonovy formule),
  \item jsou-li $\cc,\ved$ sloupcové vektory dimenze $n$ takové, ¾e èíslo $1+\ved^T\cc\ne 0$, pak
  \[
  (\II_n+\cc\ved^T)^{-1}=\II_n-\frac{\cc\ved^T}{1+\ved^T\cc},
  \] 	
  \item je-li $1+\ved^T\bAA^{-1}\cc\ne 0$, pak platí
  \[
  (\bAA+\cc\ved^T)^{-1}=\bAA^{-1}-\frac{\bAA^{-1}\cc\ved^T\bAA^{-1}}{1+\ved^T\bAA^{-1}\cc}
  \]
  (obecná Shermanova-Morrisonova formule),
  \item jsou-li $\CC, \DD$ matice tvaru $n\times k$ takové, ¾e inverzní matice k matici $\II^k+\DD^T\bAA^{-1}\CC$ existuje, potom
  \[
  (\bAA+\CC\DD^T)^{-1}=\bAA^{-1}-\bAA^{-1}\CC(\II^k+\DD^T\bAA^{-1}\CC)^{-1}\DD^T\bAA^{-1}
  \]
  (tzv. Shermanova-Morrisonova-Woodburyho formule).
\end{itemize}

\end{cviceni}


\bigskip
\leftline{\bf Elementární matice}

\smallskip\noindent
V Tvrzení~\ref{T:strukturasoucinu} jsme ukázali, ¾e ka¾dý øádek souèinu $\bAA\BB$ je lineární kombinací øádkù matice $\BB$. Nyní si uká¾eme, ¾e mù¾eme efekt elementární øádkové úpravy matice $\BB$ docílit také tím, ¾e matici $\BB$ vynásobíme zleva vhodnou regulární maticí. 

\emph{Elementární matice 1. druhu} je ètvercová matice $\EE_{ij}=(a_{uv})$ øádu $m$, kde $a_{ij}=a_{ji}=1$ pro nìjaké indexy $i\ne j$, dále $a_{kk}=1$ pro v¹echna $k\ne i,j$. V¹echny ostatní prvky matice $\EE_{ij}$ se rovnají $0$.

Podívejme se, jak vypadají øádky v souèinu matic $\EE_{ij}\BB$, kde $\BB$ je libovolná matice tvaru $m\times n$. V $i$-tém øádku matice $E_{ij}$ je jediný nenulový prvek a to na místì $(i,j)$. Podle první èásti Tvrzení~\ref{T:strukturasoucinu} se $i$-tý øádek souèinu $\EE_{ij}\BB$ rovná
\[
[\EE_{ij}]_{i*}\BB=\sum_{k=1}^m a_{ik}\BB_{k*}.
\] 
Proto¾e v $i$-tém øádku matice $\EE_{ij}$ je jediný nenulový prvek $a_{ij}=1$, rovná se $i$-tý øádek souèinu $\EE_{ij}\BB$ $j$-tému øádku $\BB_{j*}$ matice $\BB$. 

Podobnì uká¾eme, ¾e se $j$-tý øádek souèinu $\EE_{ij}\BB$ rovná $i$-tému øádku matice $\BB$. Pokud je $k\ne i,j$, je v $k$-tém øádku matice $\EE_{ij}$ jediný nenulový prvek $a_{kk}=1$ na hlavní diagonále. Proto se $k$-tý øádek souèinu $\EE_{ij}\BB$ rovná $k$-tému øádku $\BB_{k*}$ matice $\BB$. Souèin $\EE_{ij}\BB$ tak dostaneme z matice $\BB$ první elementární øádkovou úpravou prohazující $i$-tý a $j$-tý øádek matice $\BB$.

\emph{Elementární matice 2. druhu} je ètvercová matice $\EE_i(d)=(a_{uv})$ øádu $m$, která má nenulové prvky pouze na hlavní diagonále, prvek $a_{ii}=d\ne 0$, a prvky $a_{kk}=1$ pro $k\ne i$. Podobnì jako v pøípadì elementární matice 1. druhu snadno ovìøíme, ¾e souèin $\EE_{i}(d)\BB$ dostaneme z matice $\BB$ tak, ¾e vynásobíme $i$-tý øádek èíslem $d$, tedy druhou elementární øádkovou úpravou. 

Je-li $i\ne j$, pak \emph{elementární matice 3. druhu} je ètvercová matice $\EE_{ji}(d)=(a_{uv})$ øádu $m$, která má na hlavní diagonále prvky rovné $1$, a mimo hlavní diagonálu je jediný (pøípadnì) nenulový prvek $d$ na místì $(j,i)$. V souèinu $\EE_{ji}(d)\BB$ se potom $j$-tý øádek rovná lineární kombinaci $d\EE_{i*}+\EE_{j*}$, tj. souètu $d$-násobku $i$-tého øádku s $j$-tým øádkem matice $\BB$. V¹echny ostatní øádky matice $\EE_{ji}(d)\BB$ se rovnají pøíslu¹ným øádkùm matice $\BB$. Souèin $\EE_{ji}(d)\BB$ dostaneme z matice $\BB$ tøetí elementární øádkovou úpravou.

Pokud v elementární matici 1. druhu $\EE_{ij}$ prohodíme $i$-tý a $j$-tý øádek, dostaneme jednotkovou matici $\II_m$. Matice $\EE_{ij}$ má proto hodnost $m$ a podle Vìty~\ref{V:existenceinverze} je regulární.

Podobnì také z elementární matice 2. druhu $\EE_i(d)$ dostaneme jednotkovou matici $\II_m$ elementární øádkovou úpravou, pøi které vynásobíme $i$-tý øádek èíslem $d^{-1}\ne 0$. Matice $\EE_i(d)$ je proto také regulární.

A nakonec, z matice $\EE_{ji}(d)$ dostaneme jednotkovou matici $\II_m$ tak, ¾e od $j$-tého øádku odeèteme $d$-násobek $i$-tého øádku. Dokázali jsme tak první èást následujícího tvrzení.

\begin{proposition}\label{T:elementregular}
Platí, ¾e
\begin{itemize}
	\item elementární matice v¹ech tøí druhù jsou regulární, 
	\item inverzní matice k elementární matici je také elementární matice,
	\item ètvercová matice $\PP$ øádu $m$ je regulární právì kdy¾ ji lze vyjádøit jako souèin elementárních matic,
	\item matici $\bAA$ tvaru $m\times n$ dostaneme z matice $\BB$ tého¾ tvaru posloupností elementárních øádkových úprav právì kdy¾ $\bAA=\PP\BB$ pro  nìjakou regulární matici øádu $m$.
\end{itemize}
\end{proposition}

\begin{proof}
Pøímým výpoètem ovìøíme, ¾e $\EE_{ij}^{-1}=\EE_{ij}$, $\EE_i(d)^{-1}=\EE_i(d^{-1})$ a $\EE_{ji}(d)^{-1}=\EE_{ji}(-d)$.

Souèin elementárních matic je regulární podle Cvièení~\ref{C:soucinregularni}, proto¾e ka¾dá elementární matice je regulární podle první èásti tohoto tvrzení.

Je-li naopak matice $\PP$ regulární, má podle Vìty~\ref{V:existenceinverze} hodnost $m$. Pomocí elementárních øádkových úprav ji proto mù¾eme pøevést do jednotkové matice $\II_m$. To znamená, ¾e existují elementární matice $\EE_1,\EE_2,\dots,\EE_k$ takové, ¾e
\[
\EE_k\cdots\EE_2\EE_1\PP=\II_m.
\]
Proto¾e je ka¾dá elementární matice regulární, postupným násobením poslední rovnosti inverzními maticemi $\EE_l^{-1}$ dostaneme rovnost
\[
\PP=\EE_1^{-1}\EE_2^{-1}\cdots\EE_k^{-1}\II_m=\EE_1^{-1}\EE_2^{-1}\cdots\EE_k^{-1}.
\]
Inverzní matice k libovolné elementární matici je opìt elementární podle druhé èásti tohoto tvrzení, poslední rovnost je tak vyjádøením regulární matice $\PP$ ve tvaru souèinu elementárních matic.

Pokud dostaneme matici $\bAA$ z matice  $\BB$ pomocí posloupnosti elementárních úprav, platí
\[
\bAA=\EE_k\cdots\EE_2\EE_1\BB.
\]  
pro nìjaké elementární matice $\EE_1,\dots,\EE_k$. Podle druhé èásti tohoto tvrzení je matice $\PP=\EE_k\cdots\EE_2\EE_1$ regulární.

Naopak, je-li $\bAA=\PP\BB$ pro nìjakou regulární matici $\PP$, vyjádøíme podle tøetí èásti tohoto tvrzení matici $\PP$ jako souèin elementárních matic $\PP=\FF_l\cdots\FF_1$. Potom 
\[
\bAA=\PP\BB=\FF_l\cdots\FF_1\BB.
\] 
Matici $\bAA$ tak dostaneme z matice $\BB$ posloupností elementárních øádkových úprav.
\end{proof}

Co se stane, kdy¾ vynásobíme matici $\bAA$ tvaru $m\times n$ nìjakou elementární maticí $\EE$ øádu $n$ \emph{ zprava}? Podle druhé èásti Tvrzení~\ref{T:strukturasoucinu} víme, ¾e $k$-tý sloupec v souèinu $\bAA\EE$ je lineární kombinací sloupcù matice $\bAA$ s koeficienty z $k$-tého sloupce matice $\EE$. 

Souèin $\bAA\EE_{ij}$ tak dostaneme z matice $\bAA$ prohozením $i$-tého a $j$-tého sloupce matice $\bAA$. Souèin $\bAA\EE_i(d)$ dostaneme z matice $\bAA$ vynásobením $i$-tého sloupce èíslem $d$. A koneènì matici $\bAA\EE_{ji}(d)$ dostaneme z matice $\bAA$ tak, ¾e k $i$-tému sloupci pøièteme $d$-násobek $j$-tého sloupce. Násobit matici $\bAA$ zprava elementárními maticemi je toté¾ jako provádìt \emph{elementární sloupcové úpravy} matice $\bAA$. 

Pomocí elementárních øádkových úprav mù¾eme danou matici $\bAA$ tvaru $m\times n$ zjednodu¹it do redukovaného øádkovì odstupòovaného tvaru $\EE_{\bAA}$. Pro dal¹í zjednodu¹ení musíme pou¾ít elementární sloupcové úpravy. Jak moc mù¾eme matici $\bAA$ dále zjednodu¹it øíká následující tvrzení. Je¹tì døíve si ale øekneme, co je to \emph{blokový tvar matice}.

Je-li $\bAA$ matice tvaru $m\times n$, a $m,n\geq 2$, mù¾eme øádky matice rozdìlit na prvních $r$ øádkù a zbylých $n-r$ øádkù, je-li $0<r<m$. Podobnì mù¾eme rozdìlit sloupce matice na prvních $s$ sloupcù a zbylých $n-s$ sloupcù. Celá matice $\bAA$ se tak rozpadne do ètyø matic
\[
\bAA=\left(
\begin{array}{cc}
\BB & \CC\\
\DD & \EE
\end{array}
\right),
\]
kde $\BB$ je matice tvaru $r\times s$, $\CC$ je matice tvaru $r\times(n-s)$, $\DD$ je matice tvaru $(m-r)\times s$ a koneènì $\EE$ je matice tvaru $(m-r)\times(n-s)$. Tento blokový tvar matic budeme v dal¹ím vyu¾ívat.


\begin{proposition}\label{T:ranknormal}
Je-li $\bAA$ matice tvaru $m\times n$ a její hodnost $r(\bAA)=r$, pak ji mù¾eme pomocí elementárních øádkových a sloupcových úprav pøevést do matice
\[
\NN_r=\left(
\begin{array}{ll}
\II_r & \mathbf{0}_{r\times (n-r)}  \\
\mathbf{0}_{(m-r)\times r)} & \mathbf{0}_{(m-r)\times (n-r)}  
\end{array}
\right),
\]
která obsahuje pøesnì $r$ prvkù rovných $1$ a ostatní prvky se rovnají $0$.

Existují tedy regulární matice $\PP$ øádu $m$ a $\bQQ$ øádu $n$ tak, ¾e $\PP\bAA\bQQ=\NN_r$.
\end{proposition} 

\begin{proof}
Matici $\bAA$ pøevedem pomocí elementárních øádkových úprav do redukovaného øádkovì odstupòovaného tvaru $\EE_{\bAA}$ (Gaussovou-Jordanovou eliminací). 

První nenulový prvek v prvním øádku je pivot $1$, který se nachází øeknìme v $j$-tém sloupci. Odeèítáním vhodných násobkù $j$-tého sloupce od dal¹ích sloupcù mù¾eme vynulovat v¹echny ostatní prvky v prvním øádku. Zùstane v nìm pouze jeden nenulový prvek -- pivot $1$.

Toté¾ opakujeme s druhým øádkem. Jeho pivot $1$ se nachází øeknìme v $k$-tém sloupci, $k>j$. V $k$-tém sloupci je pivot $1$ jediný nenulový prvek. Odeèítáním vhodných násobkù $k$-tého sloupce od dal¹ích sloupcù vynulujeme v¹echny ostatní prvky v druhém øádku. Prvky v prvním øádku se nezmìní, proto¾e prvek v $k$-tém sloupci a prvním øádku (na místì $(1,k)$) se rovná $0$. 

Pokraèujeme tøetím øádkem, atd. se v¹emi nenulovými øádky matice $\EE_{\bAA}$. Po skonèení tìchto elementárních øádkových úprav dostaneme matici, která má v prvních $r$ øádcích jediný nenulový prvek $1$ a v¹echny ostatní øádky jsou nulové. Tato matice má také pøesnì $r$ nenulových sloupcù. Jsou to bázové sloupce matice $\EE_{\bAA}$. V ka¾dém z tìchto bázových sloupcù je jediný nenulový prvek $1$ na místech pivotù matice $\EE_{\bAA}$.

Pivot v prvním øádku pøesuneme na místo $(1,1)$ do prvního sloupce prohozením prvního a $j$-tého sloupce. Podobnì prohozením druhého a $k$-tého sloupce dostaneme pivot $1$ v druhém øádku na místo $(2,2)$, atd. 

Podle poslední èásti Tvrzení~\ref{T:elementregular} existuje regulární matice $\PP$ tak, ¾e $\PP\bAA=\EE_{\bAA}$.
Skuteènost, ¾e posloupnost elementárních sloupcových úprav mù¾eme vyjádøit pomocí násobení regulární maticí zprava plyne rovnì¾ z poslední èásti Tvrzení~\ref{T:elementregular}, které pou¾ijeme na transponované matice. 
\end{proof}

O maticích $\NN_r$ øíkáme, ¾e jsou v \emph{normálním tvaru pro hodnost}. 

\begin{cviceni}
Najdìte pro nìjakou matici $\bAA$ regulární matice $\PP$ a $\QQ$ takové, ¾e platí $\PP\bAA\QQ=\NN_r$, kde $r=r(\bAA)$.
\end{cviceni}

Tvrzení~\ref{T:ranknormal} øíká, ¾e ka¾dou matici $\bAA$ mù¾eme pøevést pomocí elementárních øádkových a sloupcových úprav do matice $\NN_r$, kde $r$ je hodnost matice $\bAA$. Neøíká ale, ¾e neexistuje jiná posloupnost elementárních øádkových a sloupcových úprav, která pøevede matici $\bAA$ do \emph{jiné} matice $\NN_s$ v normáln ím tvaru pro hodnost.
Tuto mo¾nost vyluèuje druhá èást následujícího tvrzení.

\begin{proposition}\label{T:pomocne}
Pro matice $\bAA, \NN_r$ a $\NN_s$ tvaru $m\times n$ platí
\begin{itemize}
	\item jsou-li $\NN_r$ a $\NN_s$ matice v normálním tvaru pro hodnost a $\PP\NN_r\QQ=\NN_s$ pro nìjaké regulární matice $\PP$ a $\QQ$, pak $r=s$,
	\item pokud $\PP_1\bAA\QQ_1=\NN_r$ a $\PP_2\bAA\QQ_2=\NN_s$ jsou v normálním tvaru pro hodnost a $\PP_1,\QQ_1$, $\PP_2,\QQ_2$ jsou regulární matice, pak $r=s$.
	\end{itemize} 
\end{proposition}

\begin{proof}
Z rovnosti $\PP\NN_r\QQ=\NN_s$ vyplývá rovnost $\PP\NN_r=\NN_s\QQ^{-1}$. Hodnost matice $\PP\NN_r$ se proto rovná hodnosti matice $\NN_s\QQ^{-1}$. Z Tvrzení~\ref{T:strukturasoucinu} a podoby matice $\NN_r$ dostáváme, ¾e prvních $r$ sloupcù matice $\PP\NN_r$ se rovná prvním $r$ sloupcùm matice $\PP$ a zbývající sloupce matice $\PP\NN_r$ jsou nulové:
\[
\PP\NN_r=[\PP_{*1}|\PP_{*2}|\cdots|\PP_{*r}|\mathbf{0_{m\times(n-r)}}].
\]
Matice $\PP$ je regulární, Gaussovou-Jordanovou eliminací ji proto pøevedeme do jednotkové matice $\II_m$ podle Vìty~\ref{V:existenceinverze}. Pøesnì stejné elementární øádkové úpravy proto pøevedou matici $\PP\NN_r$ do matice, která má prvních $r$ sloupcù shodných s prvními $r$ sloupci jednotkové matice $\II_m$ a zbylých $n-r$ sloupcù jsou nulové sloupce. Proto $r(\PP\NN_r)=r$.

V souèinu $\NN_s\QQ^{-1}$ se podle tého¾ Tvrzení~\ref{T:strukturasoucinu} prvních $s$ øádkù rovná prvním $s$ øádkùm matice $\QQ^{-1}$ a ostatní øádky matice $\NN_s\QQ^{-1}$ jsou nulové. Proto je hodnost $r(\NN_s\QQ^{-1})\leq s$, nebo» v ka¾dém nenulovém øádku matice $\NN_s\QQ^{-1}$ je nejvý¹e jeden pivot. Tím jsme dokázali nerovnost $r=r(\PP\NN_r)=r(\NN_s\QQ^{-1})\leq s$. 

Z rovnosti $\PP\NN_r\QQ=\NN_s$ také vyplývá rovnost $\PP^{-1}\NN_s\QQ^{-1}=\NN_r$. Z právì dokonèené èásti dùkazu tak rovnì¾ vyplývá $s\leq r$. Proto $r=s$.

Abychom dokázali druhou èást tvrzení, vyjádøíme matici $\bAA$ dvìma rùznými zpùsoby
\[
\PP_1^{-1}\NN_r\QQ_1^{-1}=\bAA=\PP_2^{-1}\NN_s\QQ_2^{-1},
\]
a tedy
\[
(\PP_2\PP_1^{-1})\NN_r(\QQ_1^{-1}\QQ_2)=\NN_s.
\]
Proto¾e jsou souèiny $\PP_2\PP_1^{-1}$ a $\QQ_1^{-1}\QQ_2$ regulární podle Cvièení~\ref{C:soucinregularni}, vyplývá z první èásti tvrzení rovnost $r=s$.
\end{proof}

Dùsledkem Tvrzení~\ref{T:pomocne} je následující dùle¾itá vìta.

\begin{theorem}\label{V:rovnosthodnosti}
Pro ka¾dou matici $\bAA$ platí 
\[
r(\bAA)=r(\bAA^T),
\]
tj. hodnost matice $\bAA$ se rovná hodnosti matice k ní transponované.
\end{theorem}

\begin{proof}
Oznaème $r(\bAA)=r$ a $r(\bAA^T)=s$. Podle Tvrzení~\ref{T:ranknormal} existují regulární matice $\PP_1$ a $\QQ_1$, pro které platí 
\[
\PP_1\bAA\QQ_1=\NN_r,
\] 
a regulární matice $\PP_2$ a $\QQ_2$, pro které platí 
\[
\PP_2\bAA^T\QQ_2=\NN_s.
\] 
Pokud první z tìchto rovností transponujeme, dostaneme
\[
\QQ_1^T\bAA^T\PP_1^T=\NN_r^T.
\]
Proto¾e obì matice $\NN_s$ a $\NN_r^T$ jsou v normálním tvaru pro hodnost, vyplývá z druhé èásti pøedchozího Tvrzení~\ref{T:pomocne}, ¾e $r=s$.
\end{proof}

Hodnost matice $\bAA$ najdeme pomocí elementárních \emph{øádkových} úprav matice $\bAA$. Øíká se jí proto také \emph{øádková hodnost} matice $\bAA$. Hodnost transponované matice $\bAA^T$ najdeme pomocí elementárních øádkových úprav matice $\bAA^T$, tj. pomocí elementárních \emph{sloupcových} úprav matice $\bAA$. Hodnost transponované matice $\bAA^T$ se proto také èasto nazývá \emph{sloupcová hodnost} matice $\bAA$. Poslední Vìtu~\ref{V:rovnosthodnosti} proto mù¾eme také vyjádøit slovy: \emph{øádková a sloupcová hodnost ka¾dé matice se rovnají.} Jiný dùkaz této dùle¾ité vìty si uká¾eme pozdìji. Bude zalo¾ený na následujícím tvrzení.

Vynásobit matici $\bAA$ regulární maticí $\PP$ zleva je toté¾, jako udìlat posloupnost elementárních øádkových úprav matice $\bAA$. Elementární øádkové úpravy zachovávají lineární vztahy mezi sloupci matic v následujícím smyslu.

\begin{proposition}\label{T:sloupcovevztahy}
Jsou-li $\bAA$ a $\BB$ matice stejného tvaru $m\times n$ a $\BB=\PP\bAA$ pro nìjakou regulární matici $\PP$, pak platí
\[
\bAA_{*k}=\sum_{i\ne k}c_i\bAA_{*i}\ \ \ \hbox{\rm právì kdy¾ }\ \ \BB_{*k}=\sum_{i\ne k}c_i\BB_{*i}.
\]
\end{proposition}

\begin{proof}
Platí-li 
\[
\bAA_{*k}=\sum_{i\ne k}c_i\bAA_{*i},
\]
vynásobíme tuto rovnost zleva maticí $\PP$. Dostaneme podle Tvrzení~\ref{T:strukturasoucinu} 
\begin{eqnarray*}
\BB_{*k}&=&[\PP\bAA]_{*k}=\PP\bAA_{*k}=\PP\sum_{i\ne k} c_i\bAA_{*i}=\sum_{i\ne k}\PP c_i\bAA_{*i}=\\
{}&=&\sum_{i\ne k}c_i\PP\bAA_{*i}=\sum_{i\ne k}c_i[\PP\bAA]_{*i}=\sum_{i\ne k}c_i\BB_{*i}. 
\end{eqnarray*}

Naopak, platí-li
\[
\BB_{*k}=\sum_{i\ne k}c_i\BB_{*i},
\]
vynásobíme tuto rovnost zleva inverzní maticí $\PP^{-1}$ a postupujeme zcela stejnì nebo» $\bAA=\PP^{-1}\BB$.
\end{proof}

\bigskip
\noindent{\bf LU faktorizace}
\smallskip

Nyní se budeme zabývat øe¹ením nìkolika soustav $n$ lineárních rovnic o $n$ neznámých $\bAA\vex=\veb_1$, $\bAA\vex=\veb_2,\bAA\vex=\veb_3,\dots$, kde $\bAA$ je \emph{regulární} matice øádu $n$ a $\veb_1,\veb_2,\veb_3,\dots$ jsou rùzné vektory pravých stran. V¹echny soustavy tak mají jednoznaèné øe¹ení podle Vìty~\ref{V:existenceinverze} a Vìty~\ref{V:obecres}. Ka¾dou soustavu mù¾eme vyøe¹it zvlá¹» tím, ¾e roz¹íøenou matici soustavy $[\bAA|\veb_p]$ pøevedeme Gaussovou eliminací do matice $[\EE|\cc_p]$ v øádkovì odstupòovaném tvaru, a následnou zpìtnou substitucí.  
Pøi tìchto výpoètech mnoho operací opakujeme. Jde o ty operace, kterými spoleènou matici v¹ech soustav $\bAA$ pøevádíme do øádkovì odstupòovaného tvaru $\EE$. 

Vyøe¹íme-li první soustavu $\bAA\vex=\veb_1$, získáme tím znalost matice $\EE$. Ta nám ale pøi øe¹ení dal¹í soustavy $\bAA\vex=\veb_2$ pøíli¹ nepomù¾e. Neznáme toti¾ vektor $\cc_2$ -- poslední sloupec matice $[\EE|\cc_2]$. Ten závisí spí¹ na tom, jak probíhá výpoèet matice $\EE$, jakými elementárními øádkovými úpravami ji z matice $\bAA$ dostaneme. Stejné elementární øádkové úpravy potom pøevedou sloupcový vektor $\veb_2$ do vektoru $\cc_2$. Potøebujeme najít zpùsob, jak uchovat informaci o \emph{prùbìhu} Gaussovy eliminace, nikoliv pouze o jejím \emph{výsledku}. Rozklad matice $\bAA$ v souèin dvou vhodných matic $\LL\UU$ je zpùsob uchování potøebné informace o prùbìhu Gaussovy eliminace. Název LU faktorizace pochází z anglických slov \emph{lower (dolní)} a \emph{upper (horní)}. A slova dolní a  horní objasòuje následující definice.

\begin{definition}\label{D:LUmatice}
Ètvercová matice $\bAA=(a_{ij})$ øádu $n$ se nazývá \emph{dolní trojúhelníková} matice, pokud $a_{ij}=0$ pro $i<j$, tj. pokud se prvek $a_{ij}$ nachází \emph{nad} hlavní diagonálou.

Matice $\bAA$ se nazývá \emph{horní trojúhelníková} matice, pokud $a_{ij}=0$ pro $i>j$, tj. pokud se prvek $a_{ij}$ nachází \emph{pod} hlavní diagonálou.
\end{definition}

Pro zaèátek hledání matic $\LL$ a $\UU$ budeme navíc pøedpokládat, ¾e v prùbìhu Gaussovy eliminace pou¾ité na matici $\bAA$ se nikdy na místì pro pivot neobjeví èíslo $0$. Tento pøedpoklad znamená, ¾e pøi Gaussovì eliminaci nemusíme pou¾ít první elementární øádkovou úpravu prohazující dva øádky. Vystaèíme pouze se tøetími elementárními øádkovými úpravami, pøi kterých postupnì v¾dy odeèítáme násobky nìjakého øádku od v¹ech øádkù \emph{pod} ním. Tìmto elementárním øádkovým úpravám odpovídá násobení zleva elementárními maticemi tøetího druhu $\EE_{ji}(l)$ pro $j>i$. 

Podíváme se, jaké elementární øádkové úpravy potøebujeme k tomu, abychom vynulovali v¹echny prvky v prvním sloupci matice $\bAA$ pod pivotem $a_{11}\ne 0$. K tomu potøebujeme pro $j=2,\dots,n$ odeèíst od $j$-tého øádku $l_{j1}$-násobek prvního øádku, kde $l_{j1}=a_{j1}a_{11}^{-1}$. Tohoto efektu dosáhneme podle Tvrzení~\ref{T:strukturasoucinu} tak, ¾e matici $\bAA$ vynásobíme zleva maticí
\[
\TT_1=\left(\begin{array}{ccccc}
1 & 0 & 0 & \cdots & 0\\
-l_{21}& 1 & 0 & \cdots & 0\\
-l_{31}& 0 & 1 & \cdots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
-l_{m1}& 0 & 0 & \cdots & 1
\end{array}\right).
\]
Po prvním prùbìhu hlavního cyklu Gaussovy eliminace tak dostaneme matici
\[
\TT_1\bAA=
\left(\begin{array}{ccccc}
a_{11} & a_{12} & a_{13} & \cdots & a_{1n}\\
0 & b_{22}& b_{23} & \cdots & b_{2n}\\
0 & b_{32} & b_{33} & \cdots & b_{3n}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & b_{n2} & b_{n3} & \cdots & b_{nn}
\end{array}\right).
\]

Podle na¹eho pøedpokladu je prvek na místì pro druhý pivot $b_{22}\ne 0$. Gaussova eliminace tedy pokraèuje tím, ¾e postupnì odeèítáme $l_{j2}$-násobky druhého øádku od v¹ech øádkù pod ním, kde koeficient $l_{j2}=b_{j2}b_{22}^{-1}$ pro $j=3,\dots,n$. Efekt druhého prùbìhu hlavního cyklu Gaussovy eliminace dosáhneme tak, ¾e matici $\TT_1\bAA$ vynásobíme zleva maticí
\[
\TT_2=\left(\begin{array}{ccccc}
1 & 0 & 0 & \cdots & 0\\
0 & 1 & 0 & \cdots & 0\\
0 & -l_{32} & 1 & \cdots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & -l_{n2} & 0 & \cdots & 1
\end{array}\right).
\]
Po dvou prùbìzích hlavního cyklu Gaussovy eliminace tak dostaneme matici
\[
\TT_2\TT_1\bAA=
\left(\begin{array}{ccccc}
a_{11} & a_{12} & a_{13} & \cdots & a_{1n}\\
0 & b_{22}& b_{23} & \cdots & b_{2n}\\
0 & 0 & c_{33} & \cdots & c_{3n}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & 0 & c_{n3} & \cdots & c_{nn}
\end{array}\right).
\]

Opìt $c_{33}\ne 0$ a pokraèujeme vynulováním v¹ech prvkù matice $\TT_2\TT_1\bAA$ pod pivotem $c_{33}$. Efekt $k$-tého cyklu Gaussovy eliminace dosáhneme pro $k=1,2,\dots n-1$ vynásobením dosud vypoèítané matice zleva maticí
\[
\TT_k=\left(\begin{array}{ccccccc}
1 & 0 & \cdots & 0 & 0 & \cdots & 0\\
0 & 1 & \cdots & 0 & 0 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots &\ddots & \vdots\\
0 & 0 & \cdots  & 1 & 0 & \cdots & 0\\
0 & 0 & \cdots  & -l_{k+1,k} & 1 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots &\ddots & \vdots\\
0 & 0 & \cdots & -l_{nk} & 0 & \cdots & 1
\end{array}\right),
\]
kde $-l_{m,k}$ je násobek $k$-tého øádku, který pøièítáme k $m$-tému øádku pro $m=k+1,\dots,n$.

Po skonèení Gaussovy eliminace tak dostaneme matici
\[
\TT_{n-1}\cdots\TT_2\TT_1\bAA=\EE.
\]
Proto¾e matice $\EE$ je v øádkovì odstupòovaném tvaru (a ètvercová), je horní trojúhelníková. Nadále ji tedy budeme znaèit $\UU=(u_{ij})$. Dostáváme tak rovnost
\[
\bAA=\TT_1^{-1}\TT_2^{-1}\cdots\TT_{n-1}^{-1}\UU.
\]

Pøímým výpoètem zjistíme, ¾e
\[
\TT_k^{-1}=\left(\begin{array}{ccccccc}
1 & 0 & \cdots & 0 & 0 & \cdots & 0\\
0 & 1 & \cdots & 0 & 0 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots &\ddots & \vdots\\
0 & 0 & \cdots  & 1 & 0 & \cdots & 0\\
0 & 0 & \cdots  & l_{k+1,k} & 1 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots &\ddots & \vdots\\
0 & 0 & \cdots & l_{nk} & 0 & \cdots & 1
\end{array}\right)
\]
pro $k=1,2,\dots,n-1$. A dal¹ím pøímým výpoètem najdeme souèin
\[
\TT_1^{-1}\TT_2^{-1}\cdots\TT_{n-1}^{-1}=
\left(\begin{array}{ccccc}
1 & 0 & 0 & \cdots & 0\\
l_{21}& 1 & 0 & \cdots & 0\\
l_{31}& l_{32} & 1 & \cdots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
l_{n1}& l_{n2} & l_{n3} & \cdots & 1
\end{array}\right).
\]

Matice $\TT_1^{-1}\TT_2^{-1}\cdots\TT_{n-1}^{-1}$ je tedy dolní trojúhelníková a oznaèíme ji proto $\LL$. Dostáváme tak rozklad $\bAA=\LL\UU$. Tomuto rozkladu øíkáme \emph{LU faktorizace} matice $\bAA$. Dùle¾ité je podívat se na podobu matice $\LL$. Jakou roli hraje prvek $l_{ij}$, pro $i>j$, pøi výpoètu matice $\UU=\EE$ Gaussovou eliminací? Po $j-1$ prùbìzích hlavního cyklu Gaussovy eliminace jsme dostali matici $\TT_{j-1}\cdots\TT_1\bAA$. Pøi $j$-tém prùbìhu Gaussovy eliminace vynulujeme prvek na místì $(i,j)$ tím, ¾e od $i$-tého øádku \emph{odeèteme} $l_{ij}$-násobek $j$-tého øádku. Èíslo $l_{ij}$ je tedy to èíslo, které pou¾íváme pøi vynulování prvku na místì $(i,j)$. Prvky matice $\LL$ proto nemusíme zvlá¹» poèítat, vypoèítáme je pøi Gaussovì eliminaci. 

\begin{cviceni}
Najdìte LU faktorizaci nìkolika matic, pro které LU faktorizace existuje. Napi¹te program pro výpoèet LU faktorizace matice.
\end{cviceni} 

Mo¾ná nìkoho z vás napadlo, jak dobøe uchovávat informace o poloze èísel $l_{ij}$. Kdy¾ tøetí elementární øádkovou úpravou vynulujeme prvek na místì $(i,j)$, zapí¹eme si koeficient $l_{ij}$ na místo $(i,j)$ jiným typem písma, nebo jej zakrou¾kujeme, aby bylo jasné, ¾e jde o prvek matice $\LL$ a nikoliv matice $\UU$. Následující úloha ukazuje tento postup.

\begin{uloha}
Najdìte LU faktorizaci matice
\[
\bAA=\left(
\begin{array}{ccc}
2&2&2\\
4&7&7\\
6&18&22
\end{array}
\right).
\] 
\end{uloha}

\begin{reseni}
Poèítáme Gaussovu eliminaci matice $\bAA$. Prvky $l_{ij}$ zapisujeme na pøíslu¹ná místa tuènì:
\[
\bAA=\left(
\begin{array}{ccc}
2&2&2\\
4&7&7\\
6&18&22
\end{array}
\right)\sim
\left(
\begin{array}{ccc}
2&2&2\\
\mathbf{2}&3&3\\
\mathbf{3}&12&16
\end{array}
\right)\sim
\left(
\begin{array}{ccc}
2&2&2\\
\mathbf{2}&3&3\\
\mathbf{3}&\mathbf{4}&4
\end{array}
\right).
\]
Proto $\bAA=\LL\UU$ pro
\[
\LL=
\left(
\begin{array}{ccc}
1&0&0\\
2&1&0\\
3&4&1
\end{array}
\right)\ \ \ \hbox{\rm a }\ \ \
\UU=
\left(
\begin{array}{ccc}
2&2&2\\
0&3&3\\
0&0&4
\end{array}
\right).
\]
\end{reseni}

Pokud ji¾ známe LU faktorizaci $\bAA=\LL\UU$, mù¾eme pomìrnì snadno vyøe¹it libovolnou soustavu $\bAA\vex=\veb$. Pøepí¹eme ji do tvaru
\[
\bAA\vex=\LL(\UU\vex)=\veb
\]
a oznaèíme $\vey=\UU\vex$. Øe¹ení soustavy $\bAA\vex=\veb$ se tak rozpadne na øe¹ení dvou soustav
\[
\LL\vey=\veb\ \ \ \hbox{\rm a }\ \ \UU\vex=\vey. 
\]

Obì soustavy snadno vyøe¹íme vzhledem k tomu, ¾e obì matice $\LL$ a $\UU$ jsou trojúhelníkové. Soustavu $\LL\vey=\veb$, tj. 
\[
\left(\begin{array}{ccccc}
1 & 0 & 0 & \cdots & 0\\
l_{21}& 1 & 0 & \cdots & 0\\
l_{31}& l_{32} & 1 & \cdots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
l_{n1}& l_{n2} & l_{n3} & \cdots & 1
\end{array}\right)
\left(\begin{array}{c}
y_1\\
y_2\\
y_3\\
\vdots\\
y_n
\end{array}\right)=
\left(\begin{array}{c}
b_1\\
b_2\\
b_3\\
\vdots\\
b_n
\end{array}\right)
\]
\emph{pøímou substitucí}
\[
y_1=b_1,\ \ y_2=b_2-l_{21}y_1, \ \ y_3=b_3-l_{31}y_1-l_{32}y_2, \ \ \hbox{\rm atd.}
\]
Obecnì mù¾eme øe¹ení soustavy $\LL\vey=\veb$ vyjádøit ve tvaru
\[
y_1=b_1\ \ \hbox{\rm a }\ \ y_i=b_i-\sum_{k=1}^{i-1}l_{ik}y_k\ \ \hbox{\rm pro }\ i=2,3,\dots,n.
\]

Pokud ji¾ známe øe¹ení $\vey$ soustavy $\LL\vey=\veb$, najdeme øe¹ení soustavy $\UU\vex=\vey$ standardní zpìtnou substitucí. Oznaèíme-li $\UU=(u_{ij})$
\[
x_n=\frac{y_n}{u_{nn}},\ \ \hbox{\rm a }\ \ x_i=\frac{1}{u_{ii}}\left(y_i-\sum_{k=i+1}^{n}u_{ik}x_k\right)
\ \ \hbox{\rm pro }\ i=n-1,n-2,\dots,1.
\]

Mù¾ete si sami spoèítat, ¾e pokud ji¾ známe LU faktorizaci $\bAA=\LL\UU$, pak øe¹ení soustavy $\bAA\vex=\veb$ tímto zpùsobem vy¾aduje $n^2$ násobení/dìlení a $n^2-n$ sèítání/odeèítání. Pokud bychom mìli øe¹it pouze jednu soustavu $\bAA\vex=\veb$, není vyu¾ití LU faktorizace ¾ádnou velkou výhodou. Pokud ale máme pozdìji øe¹it dal¹í soustavu $\bAA\vex=\cc$ s jinou pravou stranou, pomù¾e nám znalost LU faktorizace urychlit øe¹ení. 

\begin{cviceni}
Najdìte nìjakou soustavu $\bAA\vex=\veb$, kterou lze vyøe¹it pouze pomocí tøetích elementárních øádkových úprav. Bìhem øe¹ení soustavy Gaussovou eliminací najdìte LU faktorizaci matice $\bAA$. S její pomocí vyøe¹te nìkolik dal¹ích soustav
$\bAA\vex=\cc$.
\end{cviceni} 

\begin{cviceni}
Vypoèítejte inverzní matici $\bAA^{-1}$ k regulární matici $\bAA$ øádu $n$ tak, ¾e najdete øe¹ení $n$ soustav
$\bAA\vex=\ee_i$ pro $i=1,2,\dots,n$ pomocí LU faktorizace matice $\bAA$. Srovnejte poèet operací, které jsou k tomuto výpoètu potøeba, s poètem operací pøi výpoètu pomocí Gaussovy-Jordanovy eliminace. 
\end{cviceni}

\begin{cviceni}
Doka¾te, ¾e pokud pro ètvercovou matici $\bAA$ øádu $n$ platí $\bAA=\LL\UU$ a
\begin{itemize}
	\item matice $\LL=(l_{ij})$ je dolní trojúhelníková, matice $\UU=(u_{ij})$ je horní trojúhelníková, obì øádu $n$,
	\item $l_{ii}=1$ a $u_{ii}\ne 0$ pro $i=1,2,\dots,n$,
\end{itemize}
pak jsou matice $\LL$ a $\UU$ urèené maticí $\bAA$ jednoznaènì.
\end{cviceni}

Ne ka¾dá regulární matice má LU faktorizaci. Snadno si ovìøíte, ¾e neexistuje nenulové èíslo $u_{11}$, pro které platí
\[
\left(
\begin{array}{cc}
0&1\\
1&1
\end{array}
\right)=
\left(
\begin{array}{cc}
1&0\\
l_{21}&1
\end{array}
\right)
\left(
\begin{array}{cc}
u_{11}&u_{12}\\
0&u_{22}
\end{array}
\right).
\]

Následující cvièení je dost obtí¾né. Pokud je zkusíte a nezvládnete, mù¾ete najít øe¹ení v èásti 3.10. v Meyerovì uèebnici na webu.

\begin{cviceni}
Doka¾te, ¾e následující tøi tvrzení jsou ekvivalentní:
\begin{itemize}
	\item regulární matice $\bAA=(a_{ij})$ øádu $n$ má LU faktorizaci ve smyslu pøedchozího cvièení,
	\item v prùbìhu Gaussovy eliminace pou¾ité na matici $\bAA$ se na místì pro pivot nikdy neobjeví èíslo $0$, tj. Gaussova eliminace vystaèí pouze se tøetí elementární øádkovou úpravou,
	\item ka¾dá matice 
	\[
	\left(\begin{array}{cccc}
	a_{11}&a_{12}&\cdots & a_{1k}\\
	a_{21}&a_{22}&\cdots & a_{2k}\\
	\vdots &\vdots & \ddots & \vdots\\
	a_{k1} & a_{k2} & \cdots & a_{kk}
	\end{array}\right)
	\]
	je regulární pro $k=1,2,\dots,n$.
\end{itemize}
\end{cviceni}

Nyní si uká¾eme, jak rozlo¾it regulární matici, která nemá LU faktorizaci, v souèin tøí matic -- dolní trojúhelníkové matice, horní trojúhelníkové matice a nìjaké matice, které øíkáme permutaèní.

\begin{definition}\label{D:permumatice}
Ètvercová matice $\PP$ øádu $n$ se nazývá \emph{permutaèní}, mù¾eme-li ji vyjádøit jako souèin elementárních matic prvního druhu a øádu $n$. 
\end{definition}
Ka¾dá permutaèní matice je tedy regulární, nebo» je souèinem elementárních matic, které regulární jsou.

Je¹tì si uká¾eme vyjádøení matice
\[
\TT_k=\left(\begin{array}{ccccccc}
1 & 0 & \cdots & 0 & 0 & \cdots & 0\\
0 & 1 & \cdots & 0 & 0 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots &\ddots & \vdots\\
0 & 0 & \cdots  & 1 & 0 & \cdots & 0\\
0 & 0 & \cdots  & -l_{k+1,k} & 1 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots &\ddots & \vdots\\
0 & 0 & \cdots & -l_{nk} & 0 & \cdots & 1
\end{array}\right),
\]
se kterým se lépe poèítá. Oznaèíme
\[
\cc_k=
\left(
\begin{array}{c}
0\\
0\\
\vdots\\
0\\
l_{k+1,k}\\
l_{k+2,k}\\
\vdots\\
l_{nk}
\end{array}
\right)
\]
a je¹tì pøipomeneme, ¾e symbolem $\ee_k$ oznaèujeme $k$-tý sloupcový vektor jednotkové matice $\II_n$. Pøímým výpoètem potom ovìøíme, ¾e platí
\[
\TT_k=\II_n-\cc_k\ee_k^T.
\]
Maticím, které mù¾eme vyjádøit v tomto tvaru, budeme øíkat \emph{elementární dolní trojúhelníkové matice}. Pøipomeòme je¹tì, ¾e symbolem $\EE_{k+i,k+j}$ oznaèujeme elementární matici prvního druhu. Pro tuto matici platí rovnost
$\ee_k^T\EE_{k+i,k+j}=\ee_k^T$, jak si rovnì¾ snadno ovìøíme pøímým výpoètem. Vzhledem k tomu, ¾e také platí $\EE_{k+i,k+j}^2=\II_n$, dostáváme
\begin{eqnarray*}
&\EE_{k+i,k+j}\TT_k\EE_{k+i,k+j}=\EE_{k+i,k+j}(\II_n-\cc_k\ee_k^T)\EE_{k+i,k+j}=\\
&=\EE_{k+i,k+j}^2-\EE_{k+i,k+j}\cc_k\ee_k^T\EE_{k+i,k+j}=\II_n-(\EE_{k+i,k+j}\cc_k)\ee_k^T.
\end{eqnarray*}

Oznaèíme si $\overline{\cc}_k=\EE_{k+i,k+j}\cc_k$. Potom se matice
\[
\overline{\TT}_k=\EE_{k+i,k+j}\TT_k\EE_{k+i,k+j}=\II_n-\overline{\cc}_k\ee_k^T
\]
li¹í od matice $\TT_k$  pouze tím, ¾e jsou v ní prohozené prvky $l_{k+i,k}$ a $l_{k+j,k}$. Je to rovnì¾ elementární dolní trojúhelníková matice.
 
Po této pøípravì se mù¾eme vrátit k problému, jak se vypoøádat se situací, kdy po probìhnutí $k$ hlavních cyklù Gaussovy eliminace dostaneme v matici $\TT_k\cdots\TT_1\bAA$ na místì $(k+1,k+1)$ pro $k+1$-ní pivot èíslo $0$. 
Nyní musíme pou¾ít první elementární úpravu prohazující $k+1$-ní øádek s $k+j$-tým øádkem pro nìjaké $j>1$. Pøíslu¹nou elementární matici prvního druhu si oznaèíme $\EE=\EE_{k+1,k+j}$. Vzhledem k tomu, ¾e $\EE^2=\II_n$ tak dostaneme 
matici
\begin{eqnarray*}
\EE\TT_k\cdots\TT_1\bAA&=&\EE\TT_k\EE^2\TT_{k-1}\EE^2\cdots\EE^2\TT_1\EE^2\bAA=\\
{}&=&(\EE\TT_k\EE)(\EE\TT_{k-1}\EE)\cdots(\EE\TT_1\EE)\EE\bAA=\\
&=&\overline{\TT}_k\overline{\TT}_{k-1}\cdots
\overline{\TT}_1\EE\bAA.
\end{eqnarray*}

Ka¾dou z elementárních dolních trojúhelníkových matic $\overline{\TT}_p$, $p=1,\dots,k$ dostaneme z matice $\TT_p$ tak, ¾e v ní prohodíme prvky na místech $(k+1,p)$ a $(k+j,p)$. Souèin $\overline{\TT}_k\overline{\TT}_{k-1}\cdots
\overline{\TT}_1$ se proto od souèinu $\TT_k\cdots\TT_1$ li¹í tím, ¾e jsme v prvních $k$ sloupcích prohodili prvky, které se nacházejí v $(k+1)$-ním øádku a $(k+j)$-tém øádku. Není to elementární øádková úprava\,!! Neprohazujeme toti¾ celý $(k+1)$-ní øádek s celým $(k+j)$-tým øádkem. Prohazujeme pouze ty prvky z obou øádkù, které odpovídají multiplikátorùm $l_{uv}$.

Poslední výpoèet ukazuje, ¾e efekt první elementární øádkové úpravy na matici $\EE\TT_k\cdots\TT_1\bAA$ dosáhneme také tak, ¾e tuto elementární øádkovou úpravu udìláme pouze na matici $\bAA$ a souèin elementárních dolních trojúhelníkových matic $\TT_k\cdots\TT_1$ nahradíme souèinem jiných elementárních trojúhelníkových matic $\overline{\TT}_k\overline{\TT}_{k-1}\cdots\overline{\TT}_1$.

Pokud tedy v prùbìhu Gaussovy eliminace musíme nìkolikrát pou¾ít první elementární øádkovou úpravu, kterým odpovídají elementární matice prvního druhu $\EE_1,\dots,\EE_r$, pak výsledkem Gaussovy eliminace bude horní trojúhelníková matice
\[
\UU=\widetilde{\TT}_{n-1}\widetilde{\TT}_{n-2}\cdots\widetilde{\TT}_1(\EE_r\cdots\EE_1)\bAA.
\]
Souèin dolních elementárních trojúhelníkových matic $\LL=\widetilde{\TT}_{n-1}\widetilde{\TT}_{n-2}\cdots\widetilde{\TT}_1$ je dolní trojúhelníková matice Souèin elementárních matic prvního druhu $\PP=\EE_r\cdots\EE_1$ je permutaèní matice. Dostáváme tak rozklad
\[
\PP\bAA=(\widetilde{\TT}_1^{-1}\widetilde{\TT}_2^{-1}\cdots\widetilde{\TT}_{n-1}^{-1})\UU
\]
Proto¾e inverzní matice k elementárním dolním trojúhelníkovým maticím $\widetilde{\TT}_k=\II_n-\widetilde{\cc}_k\ee_k^T$ se rovnají $\widetilde{\TT}_k^{-1}=\II_n+\widetilde{\cc}_k\ee_k^T$, jsou rovnì¾ elementární dolní trojúhelníkové. Jejich souèin $\LL=\widetilde{\TT}_1^{-1}\widetilde{\TT}_2^{-1}\cdots\widetilde{\TT}_{n-1}^{-1}$ je proto dolní trojúhelníková matice.

Dostáváme tak LU faktorizaci $\PP\bAA=\LL\UU$ matice $\PP\bAA$ místo matice $\bAA$, její¾ LU faktorizace nemusí existovat. Praktický postup nalezení permutaèní matice $\PP$ a LU faktorizace $\PP\bAA=\LL\UU$ si uká¾eme v následující úloze. Zdùvodnìní správnosti postupu je podobné jako v pøípadì matic, pro které pøímo existuje LU faktorizace.

\begin{uloha}
Pou¾ijte parciální pivotaci na matici
\[
\bAA=\left(
\begin{array}{cccc}
1&2&-3&4\\
4&8&12&-8\\
2&3&2&1\\
-3&-1&1&-4
\end{array}
\right)
\]
a najdìte LU faktorizaci $\PP\bAA=\LL\UU$, kde $\PP$ je pøíslu¹ná permutaèní matice.
\end{uloha}

\begin{reseni}
Multiplikátory $l_{uv}$ budeme opìt vyznaèovat tuènì. Abychom po skonèení výpoètu mohli rekostruovat matici $\PP$, pøidáme si k matici $\bAA$ kontrolní ``sloupec pravých stran" $\vep$, který tvoøí rùzná èísla. Provádíme-li v prùbìhu Gaussovy eliminace první elementární øádkovou úpravu, prohazujeme nejen prvky pøíslu¹né matice, ale i multiplikátory, které si pí¹eme na pøíslu¹ná místa stejnì jako jsme to dìlali v pøedchozí úloze.
\begin{eqnarray*}
&[\bAA|\veb]=
\left(\begin{array}{ccccc}
1&2&-3&4&1\\
4&8&12&-8&2\\
2&3&2&1&3\\
-3&-1&1&-4&4
\end{array}\right)\sim
\left(\begin{array}{ccccc}
4&8&12&-8&2\\
1&2&-3&4&1\\
2&3&2&1&3\\
-3&-1&1&-4&4
\end{array}\right)\sim\\
&\sim\left(\begin{array}{ccccc}
4&8&12&-8&2\\
\mathbf{1/4}&0&-6&6&1\\
\mathbf{1/2}&-1&-4&5&3\\
\mathbf{-3/4}&5&10&-10&4
\end{array}\right)\sim
\left(\begin{array}{ccccc}
4&8&12&-8&2\\
\mathbf{-3/4}&5&10&-10&4\\
\mathbf{1/2}&-1&-4&5&3\\
\mathbf{1/4}&0&-6&6&1
\end{array}\right)\sim\\
&\sim\left(\begin{array}{ccccc}
4&8&12&-8&2\\
\mathbf{-3/4}&5&10&-10&4\\
\mathbf{1/2}&\mathbf{-1/5}&-2&3&3\\
\mathbf{1/4}&\mathbf{0}&-6&6&1\\
\end{array}\right)\sim
\left(\begin{array}{ccccc}
4&8&12&-8&2\\
\mathbf{-3/4}&5&10&-10&4\\
\mathbf{1/4}&\mathbf{0}&-6&6&1\\
\mathbf{1/2}&\mathbf{-1/5}&-2&3&3\\
\end{array}\right)\\
&\sim\left(\begin{array}{ccccc}
4&8&12&-8&2\\
\mathbf{-3/4}&5&10&-10&4\\
\mathbf{1/4}&\mathbf{0}&-6&6&1\\
\mathbf{1/2}&\mathbf{-1/5}&\mathbf{1/3}&1&3
\end{array}\right).
\end{eqnarray*}

Proto
\[
\LL=\left(\begin{array}{cccc}
1&0&0&0\\
{-3/4}&1&0&0\\
{1/4}&{0}&1&0\\
{1/2}&{-1/5}&{1/3}&1
\end{array}\right),\ \ 
\UU=
\left(\begin{array}{cccc}
4&8&12&-8\\
0&5&10&-10\\
0&0&-6&6\\
0&0&0&1
\end{array}\right)
\]
a
\[ 
\PP=\left(\begin{array}{cccc}
0&1&0&0\\
0&0&0&1\\
1&0&0&0\\
0&0&1&0
\end{array}\right).
\]
\end{reseni}

Máme-li nyní øe¹it soustavu $\bAA\vex=\veb$, u které neexistuje LU faktorizace matice soustavy $\bAA$, najdeme postupem z pøedchozí úloha permutaèní matici $\PP$ a LU faktorizaci $\PP\bAA=\LL\UU$. Potom místo soustavy $\bAA\vex=\veb$ øe¹íme ekvivalentní (ekvivalentní proto, ¾e $\PP$ je regulární matice) soustavu $\PP\bAA\vex=\PP\veb$. A proto¾e matice $\PP\bAA$ nové soustavy u¾ má LU faktorizaci, mù¾eme pou¾ít døíve uvedený postup.

\begin{cviceni}
Zvolte nìjakou soustavu $\bAA\vex=\veb$, její¾ matice $\bAA$ je regulární, ale nemá LU faktorizaci. Najdìte matici $\PP$, pro kterou má souèin $\PP\bAA$ LU faktorizaci, najdìte ji a vyøe¹te pùvodní soustavu pro nìkolik rùzných pravých stran $\veb$.
\end{cviceni} 


\bigskip
\noindent{\bf Strassenùv algoritmus pro rychlé násobení matic}
\smallskip

Poèátkem ¹edesátých let minulého století dostal ruský matematik Karacuba nápad, jak urychlit násobení èísel. Jeho nápad je velmi jednoduchý. Máme-li vynásobit dvì $n$-místná èísla $x,y$  vyjádøená v soustavì o základu $\beta$, napí¹eme si je ve tvaru
\[
x=a\beta^{n/2}+b,\ \ \ y=c\beta^{n/2}+d.   
\]
Po vynásobení dostaneme
\[
x\cdot y=(a\beta^{n/2}+b)(c\beta^{n/2}+d)=ac\beta^n+(ad+bc)\beta^{n/2}+bd.
\]
Pro výpoèet souèinu tak potøebujeme ètyøi násobení a jedno sèítání. Souèiny $ac, ad, bc$ a $bd$ jsou souèiny $n/2$-místných èísel, která mù¾eme vynásobit stejnì, atd. 

Karacubùv algoritmus spoèívá v tom, ¾e místo ètyø souèinù $ac, ad, bc, bd$ spoèítáme pouze tøi souèiny $ac, bd$ a $(a-b)(d-c)$. Potom platí
\[
x\cdot y=(a\beta^{n/2}+b)(c\beta^{n/2}+d)=ac\beta^n+[(a-b)(d-c)+bd+ac]\beta^{n/2}+bd.
\]
Stejný souèin tak spoèítáme pomocí $3$ násobení a $4$ sèítání/odèítání. Jednotlivé souèiny poèítáme stejným zpùsobem. Pro dostateènì velká $n$ (v literatuøe se obvykle uvádí $n\geq 500$) pøevá¾í zmen¹ení poètu násobení nad zvìt¹eným poètem sèítání/odèítání a Karacubùv algoritmus zaène být rychlej¹í.

O nìkolik let pozdìji Volker Strassen pøi¹el na to, jak podobným zpùsobem urychlit násobení velkých matic. Máme-li vynásobit dvì matice
\[
\left(\begin{array}{cc}
a_{11}&a_{12}\\
a_{21}&a_{22}
\end{array}\right)
\left(\begin{array}{cc}
b_{11}&b_{12}\\
b_{21}&b_{22}
\end{array}\right),
\]
a postupujeme-li podle definice, potøebujeme $8$ násobení a $4$ sèítání. Strassen ukázal postup, jak vystaèit pouze se $7$ násobeními a $15$ sèítáními/odèítáními. Poèítal napøed souèty
\begin{eqnarray*}
s_1&=\ \ a_{21}+a_{22},\ \ \ t_1&=\ \ b_{12}-b_{11},\\
s_2&=\ \ s_1-a_{11},\ \ \ \ t_2&=\ \ b_{22}-t_1,\\
s_3&=\ \ a_{11}-a_{21},\ \ \ t_3&=\ \ b_{22}-b_{21},\\
s_4&=\ \ a_{12}-s_2,\ \ \ \ t_4&=\ \ t_2-b_{21}.
\end{eqnarray*}
Poté spoèítal $7$ souèinù
\begin{eqnarray*}
p_1&=\ \ a_{11}b_{11},\ \ \ p_5&=\ \ s_1t_1,\\
p_2&=\ \ a_{12}b_{21},\ \ \ p_6&=\ \ s_2t_2,\\
p_3&=\ \ s_4b_{22},\ \ \ \ p_7&=\ \ s_3t_3.\\
p_4&=\ \ a_{22}t_4,\ \ \ \ \ \  {}&{}
\end{eqnarray*}
A nakonec opìt sèítal 
\begin{eqnarray*}
u_1&=\ \ p_1+p_2,\ \ \ u_5&=\ \ u_4+p_3,\\
u_2&=\ \ p_1+p_6,\ \ \ u_6&=\ \ u_3-p_4,\\
u_3&=\ \ u_2+p_7,\ \ \ u_7&=\ \ u_3+p_5.\\
u_4&=\ \ u_2+p_5,\ \ \ \ \  {}&{}
\end{eqnarray*}

Potom mu vy¹lo
\[
\left(\begin{array}{cc}
a_{11}&a_{12}\\
a_{21}&a_{22}
\end{array}\right)
\left(\begin{array}{cc}
b_{11}&b_{12}\\
b_{21}&b_{22}
\end{array}\right)=
\left(\begin{array}{cc}
u_{1}&u_{5}\\
u_{6}&u_{7}
\end{array}\right).
\]




Máme-li vynásobit dvì ètvercové matice $\bAA,\BB$ øádu $n=2^k$, rozdìlíme si ka¾dou na ètyøi ètvercové matice øádu $n/2$ a vynásobíme je pøedchozím postupem
\[
\bAA=\left(\begin{array}{cc}
\bAA_{11}&\bAA_{12}\\
\bAA_{21}&\bAA_{22}
\end{array}\right),\ \ \
\BB=\left(\begin{array}{cc}
\BB_{11}&\BB_{12}\\
\BB_{21}&\BB_{22}
\end{array}\right).
\]  
Ka¾dý ze $7$ souèinù matic polovièního øádu $n/2$, které potøebujeme, opìt spoèítáme Strassenovým algoritmem, atd. Lze ukázat, ¾e Strassenùv algoritmus vy¾aduje celkem $n^{\log_27}\approx n^{2,807}$ násobení za cenu podstatného zvý¹ení poètu sèítání/odèítání. Pozdìj¹í vylep¹ení Strassenova algoritmu dokázala sní¾it poèet násobení a¾ na $n^{2,376}$. Nìkteøí matematici vyjadøují domnìnku, ¾e lze poèet násobení sní¾it dokonce a¾ na $n^2$, nikdo to ale dosud nedokázal. Praktické experimenty ukazují, ¾e algoritmy Strassenova typu jsou rychlej¹í ne¾ klasický algoritmus vy¾adující $n^3$ násobení, ji¾ pro násobení matic øádu $100$.

Strassenùv algoritmus vyvolal v sedmdesátých letech minulého století velký zájem o hledání ``rychlých" algoritmù pro øe¹ení nejrùznìj¹ích úloh.

\chapter{Tìlesa}

Dosud jsme se zabývali pouze soustavami lineárních rovnic s reálnými koeficienty. V¹echna èísla byla reálná, vektory mìly reálné souøadnice, matice mìly reálné prvky. Také øe¹ení soustav lineárních rovnic jsme hledali mezi reálnými vektory. Reálná èísla jsou pouze jedním z mnoha èíselných oborù. Navíc mají jednu velkou nevýhodu -- nelze s nimi poèítat exaktnì. Irracionální èísla nelze vyjádøit jinak ne¾ pomocí nekoneèného desetinného rozvoje a ka¾dý výpoèetní systém je proto musí zaokrouhlovat. A zaokrouhlování, jak u¾ víme, s sebou pøiná¹í problém zaokrouhlovacích chyb.

Pokud poèítáme s racionálními èísly a vyjadøujeme je jako zlomky, tak se problému zaokrouhlovacích chyb vyhneme. Mù¾eme poèítat v exaktní aritmetice. Kdy¾ si projdeme texty dosavadních pøedná¹ek, tak zjistíme, ¾e jsme ve skuteènosti nikde nevyu¾ívali pøedpoklad, ¾e poèítáme právì s reálnými èísly. Ve¹kerý dosavadní text zùstane v platnosti i v pøípadì, ¾e se omezíme pouze na poèítání s racionálními èísly. Gaussova eliminace a zpìtné dosazování budou fungovat zcela stejnì, v¹echna øe¹ení soustavy lineárních rovnic s racionálními koeficienty budou opìt racionální èísla, resp. vektory s racionálními souøadnicemi. Má-li nìjaká regulární matice pouze racionální prvky, tak také matice k ní inverzní bude tvoøena pouze racionálními èísly. Dosud jsme pou¾ívali pouze operace sèítání/odèítání a násobení/dìlení. Mno¾ina v¹ech racionálních èísel je na tyto operace \emph{uzavøená}, souèet nebo rozdíl dvou racionálních èísel je opìt racionální èíslo a stejnì tak souèin nebo podíl racionálních èísel je také racionální èíslo. Nikde jsme dosud nepou¾ívali odmocòování, kde by nám racionální èísla nestaèila. Druhá odmocnina ze $2$ toti¾ racionální není.

Podobnì také mù¾eme místo v oboru reálných èísel poèítat ve vìt¹ím oboru komplexních èísel a v¹echny dosud získané poznatky zùstanou v platnosti. Napøíklad LU faktorizace regulární matice s komplexními prvky bude tvoøena dvìma trojúhelníkovými maticemi s komplexními prvky, atd. V pøípadì komplexních èísel by nám nevadilo ani odmocòování. 

Ve skuteènosti vùbec nejde o to, s jakými èísly poèítáme, ale o to, jaké algebraické vlastnosti toto poèítání, tj. sèítání a násobení, má. Ve¹keré dosud získané poznatky závisejí na nìkolika vlastnostech tìchto operací, které jsou obsahem následující dùle¾ité definice.

\begin{definition}\label{D:teleso}
Pøedpokládáme, ¾e $\TT$ je mno¾ina, na které jsou definované dvì operace -- sèítání a násobení. Pokud tyto dvì operace splòují následující podmínky (axiomy), øíkáme ¾e mno¾ina $\TT$ spolu s tìmito operacemi tvoøí \emph{tìleso.} Jsou to podmínky
\begin{description}
   \item [(A0)] souèet $a+b\in\TT$ pro libovolné $a,b\in\TT$,
   \item [(A1)] platí $(a+b)+c=a+(b+c)$ pro libovolné $a,b,c\in\TT$,
   \item [(A2)] platí $a+b=b+a$ pro libovolné dva prvky $a,b\in\TT$,
	 \item [(A3)] existuje prvek $0\in\TT$ takový, ¾e $0+a=a$ pro ka¾dé $a\in\TT$,
	 \item [(A4)] ke ka¾dému prvku $a\in\TT$ existuje prvek $-a\in\TT$, pro který platí, ¾e $(-a)+a=0$.
\end{description}	 
To jsou v¹echny axiomy pro sèítání. Axiom (A0) øíká, ¾e mno¾ina $\TT$ je \emph{uzavøená na sèítání}. Axiom (A1) je \emph{asociativita sèítání}, axiom (A2) je \emph{komutativita sèítání}. Axiomu (A3) øíkáme existence  \emph{nulového prvku} nebo také \emph{neutrálního prvku vzhledem ke sèítání} a axiomu (A4) pak existence \emph{opaèného prvku vzhledem ke sèítání}.

Následují axiomy pro násobení:
\begin{description}
	\item[(M0)] souèin $ab\in\TT$ pro libovolné $a,b\in\TT$,
	\item [(M1)] platí $(ab)c=a(bc)$ pro libovolné $a,b,c\in\TT$,
  \item [(M2)] $ab=ba$ pro libovolné dva prvky $a,b\in\TT$,
	\item [(M3)] existuje prvek $1\in\TT$ takový, ¾e $1a=a$ pro ka¾dé $a\in\TT$,
	\item [(M4)] ke ka¾dému prvku $0\ne a\in\TT$ existuje prvek $a^{-1}\in\TT$, pro který platí $a^{-1}a=1$.
\end{description}
Axiom (M0) vyjadøujeme slovy, ¾e mno¾ina $\TT$ je \emph{uzavøená vzhledem k násobení}, axiomy (M1) a (M2) øíkají, ¾e násobení je \emph{asociativní} a \emph{komutativní}. Axiom (M3) je existence \emph{jednotkového prvku} nebo také \emph{neutrálního prvku vzhledem k násobení} a axiom (M4) je axiom existence \emph{inverzního prvku vzhledem k násobení}. 

Obì operace pak spojuje axiom \emph{distributivity}
\begin{description}
	\item[(D)] platí $a(b+c)=ab+ac$ pro libovolné tøi prvky $a,b,c\in\TT$. 
\end{description}

A nakonec axiom \emph{netriviality}
\begin{description}
	\item[(N)] $0\ne 1$. 
\end{description}
\end{definition}
V axiomu distributivity jsme pou¾ili obvyklou konvenci, ¾e násobení má pøednost pøed sèítáním, pokud pomocí závorek neurèíme jiné poøadí provádìní operací. Axiom netriviality øíká, ¾e ka¾dé tìleso má aspoò dva prvky.

V¹echny dosavadní poznatky o maticích a øe¹ení soustav lineárních rovnic platí v libovolném tìlese $\TT$. Soustavou lineárních rovnic v tìlese $\TT$ rozumíme soustavu
\begin{eqnarray*}
a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n&=&b_1,\\
a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n&=&b_2,\\
&\vdots &\\
a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n&=&b_m,
\end{eqnarray*}
kde jsou v¹echny koeficienty $a_{ij}, b_k\in\TT$. Z axiomù tìlesa a jejich bezprostøedních dùsledkù pak vyplývá, ¾e Gaussova eliminace a zpìtná substituce, pøi kterých v¹echny výpoèty provádíme v tìlese $\TT$, vedou k øe¹ením této soustavy, která v¹echna opìt le¾í v tìlese $\TT$.  

Podobnì matice s prvky z tìlesa $\TT$ je matice $\bAA=(a_{ij})$, kde $a_{ij}\in\TT$. Elementární øádkové úpravy matice s prvky z libovolného tìlesa $\TT$ mù¾eme provádìt beze zmìny. Proto zùstává v platnosti i definice hodnosti matice.
Je-li $\bAA$ regulární matice, pak Gaussova-Jordanova eliminace vede k inverzní matici $\bAA^{-1}$, která má také prvky z tìlesa $\TT$. Podobnì zùstávají v platnosti i v¹echny ostatní vlastnosti matic. Staèí pouze v¾dy na zaèátku øíct, v jakém tìlese le¾í prvky matic, se kterými poèítáme.

\begin{proposition}\label{T:otelesech}
V ka¾dém tìlese $\TT$ platí
\begin{enumerate}
	\item nulový prvek je urèený jednoznaènì,
	\item opaèný prvek $-a$ je prvkem $a\in\TT$ urèený jednoznaènì,
	\item pro ka¾dý prvek $a\in\TT$ platí $-(-a)=a$,
	\item jednotkový prvek je urèený jednoznaènì,
	\item prvek $a^{-1}$ inverzní k prvku $0\ne a\in\TT$ je prvkem $a$ urèený jednoznaènì,
	\item pro ka¾dý nenulový prvek $a\in\TT$ platí $(a^{-1})^{-1}=a$,
	\item $0a=0$ pro libolný prvek $a\in\TT$,
	\item je-li $ab=0$, pak buï $a=0$ nebo $b=0$,
	\item $(-1)a=-a$ pro ka¾dý prvek $a\in\TT$,
	\item rovnice $ax=b$, $a\ne 0$, má v¾dy právì jedno øe¹ení,
	\item rovnice $c+x=d$ má v¾dy právì jedno øe¹ení,
	\item z rovnosti $ab=ac$ a pøedpokladu $a\ne 0$, vyplývá $b=c$,
	\item z rovnosti $a+b=a+c$ plyne $b=c$,
	\item $(-a)(-b)=ab$ pro ka¾dé dva prvky $a,b\in\TT$.
\end{enumerate}
\end{proposition} 

\begin{proof}
V¹echny dùkazy jsou jednoduché, je pouze tøeba v ka¾dém kroku ukázat, který z axiomù tìlesa, pøípadnì z ji¾ dokázaných dùsledkù, pou¾íváme. 

1. Jsou-li $0$ a $\overline0$ prvky neutrální vzhledem ke sèítání, pak platí
\[
\overline0=0+\overline0=\overline0+0=0.
\]
První rovnost plyne z axiomu (A3), proto¾e $0$ je neutrální vzhledem ke sèítání. Druhá rovnost plyne z (A2) a tøetí z (A3), proto¾e také prvek $\overline0$ je neutrální vzhledem ke sèítání.

2. Je-li $b\in\TT$ také prvek opaèný k prvku $a$, pak platí
\[
b=0+b=((-a)+a)+b=(-a)+(a+b)=(-a)+0=-a.
\]
První rovnost plyne z (A3), druhá z (A4), tøetí z (A1), ètvrtá z (A4) a (A2), nebo» prvek $b$ je podle  pøedpokladu také opaèný k $a$. Poslední rovnost plyne opìt z (A3) a komutativity (A2).

3. Z rovností
\[
a+(-a)=(-a)+a=0
\]
(první je dùsledkem komutativity sèítání (A2) a druhá plyne z (A4)) vyplývá, ¾e prvek $a$ je opaèný k prvku $-a$. K prvku $-a$ je ale opaèný vzhledem k operaci sèítání také prvek $-(-a)$. Z jednoznaènosti opaèného prvku dokázané v bodu 2. vyplývá, ¾e $a=-(-a)$.

Vlastnosti 4., 5. a 6. si mù¾ete stejným zpùsobem dokázat sami. V¹ude nahradíte sèítání násobením a pou¾ijete odpovídající axiomy pro násobení.

7. Platí
\[
0a=(0+0)a=0a+0a
\]
podle axiomù (A3) a (D). Nyní k obìma stranám pøièteme prvek $-(0a)$. Dostaneme
\[
0=-(0a)+0a=-0a+(0a+0a)=(-0a+0a)+0a=0+0a=0a.
\]
První rovnost je dùsledkem (A4), druhá je dùsledkem pøedchozího výpoètu, tøetí vyplývá z asociativity sèítání (A1), ètvrtá je dùsledkem (A4) a poslední plyne z (A3).

8. Je-li $ab=0$ a $a\ne 0$, mù¾eme tuto rovnost v dùsledku axiomu (M4) vynásobit prvkem $a^{-1}$. Dostaneme tak
\[
b=1b=(a^{-1}a)b=a^{-1}(ab)=a^{-1}0=0a^{-1}=0.
\]
První rovnost plyne z (M3), druhá z (M4), tøetí z asociativity násobení (M1), ètvrtá je dùsledkem pøedpokladu $ab=0$, pátá plyne z komutativity násobení (M2) a ¹estou rovnost jsme dokázali v bodì 7.

9. Platí 
\[
0=0a=(-1+1)a=(-1)a+1a=(-1)a+a.
\]
První rovnost plyne z bodu 7. tohoto tvrzení, druhá je axiom (A4), tøetí plyne z axiomu distributivity (D) a ètvrtá plyne z (M3). Dokázali jsme tak, ¾e prvek $(-1)a$ je opaèný k $a$. V dùsledku jednoznaènosti prvku opaèného k $a$ dokázané v bodu 2. dostáváme rovnost $(-1)a=-a$.

10. Rovnost $ax=b$ mù¾eme kvùli pøedpokladu $a\ne 0$ vynásobit prvkem $a^{-1}$. Dostaneme
\[
x=1x=(a^{-1}a)x=a^{-1}(ax)=a^{-1}b.
\]
Jediným mo¾ným øe¹ením rovnice je tedy prvek $x=a^{-1}b$. (Které axiomy a ji¾ dokázané vlastnosti jsme pou¾ili?) Dosazením $x=a^{-1}b$ do rovnice $ax=b$ zjistíme, ¾e $a^{-1}b$ je skuteènì øe¹ením této rovnice.

Body 11., 12. a 13. si mù¾ete dokázat sami.

14. Platí
\[
(-a)(-b)=(-a)((-1)b)=((-a)(-1))b=((-1)(-a))b=(-(-a))b=ab.
\] 
Poslední rovnost vyplývá z bodu 3. 
\end{proof}

V ka¾dém tìlese mù¾eme definovat operaci odeèítání $a-b=a+(-b)$ a operaci dìlení nenulovým prvkem $b$ jako
$a:b=ab^{-1}$.

Známými pøíklady tìles jsou tìleso racionálních èísel $\QQ$, tìleso reálných èísel $\RR$ a tìleso komplexních èísel $\CC$. Ve v¹ech pøípadech poèítáme s obvyklými operacemi sèítání a násobení èísel.

\begin{example}\label{P:Z2}
Dvouprvková mno¾ina $\{0,1\}$ spolu s operacemi sèítání 
\[
0+0=1+1=0,\ \ \ 0+1=1+0=1,
\] 
a násobení
\[
1\cdot1=1,\ \ \ 0\cdot1=1\cdot0=0\cdot0=0
\]
je také tìleso. Je to vlastnì poèítání \emph{modulo} $2$. Výsledek operace získáme tak, ¾e udìláme napøed obvyklý souèet dvou èísel a za výsledek pak vezmeme zbytek pøi dìlení obvyklého souètu èíslem $2$. Podobnì pro souèin. Platnost v¹ech axiomù tìlesa mù¾eme pak ovìøit pøímo. Toto tìleso budeme oznaèovat $\ZZ_2$. 
\end{example}

\begin{example}\label{P:Z3}
Jiné koneèné tìleso dostaneme, kdy¾ èísla $\{0,1,2\}$ sèítáme a násobíme \emph{modulo} $3$. Operace sèítání je potom
\[
0+0=1+2=2+1=0,\ 0+1=1+0=2+2=1,\ 0+2=2+0=1+1=2,
\]
a operace násobení je
\[
0\cdot0=0\cdot1=1\cdot0=0\cdot2=2\cdot0=0,\ 1\cdot1=2\cdot2=1,\ 1\cdot2=2\cdot1=2.
\]
Mù¾ete si sami ovìøit, ¾e mno¾ina $\{0,1,2\}$ s takto definovanými operacemi je tìleso. V pøípadì asociativity obou operací a distributivity je tøeba v¾dy ovìøit $27$ rovností.
\end{example}

\begin{example}\label{P:Z4}
Mno¾ina $\{0,1,2,3\}$ spolu s operacemi sèítání a násobení \emph{modulo} $4$ {\bf není} tìleso. Platí v ní toti¾ $2\cdot2=0$ a pøitom $2\ne 0$. To se v ¾ádném tìlese nemù¾e stát podle Tvrzení~\ref{T:otelesech}.8. 
\end{example}

\begin{example}\label{P:GF4}
Ètyøprvkové tìleso ale existuje. Nejlépe je poèítat s polynomy $\GG\FF(4)=\{0,1,x,x+1\}$ jedné promìnné s koeficienty $0,1$.  Koeficienty pova¾ujeme za prvky tìlesa $\ZZ_2$. Tyto polynomy pak mù¾eme sèítat a násobit obvyklým zpùsobem. Mno¾ina $\GG\FF(4)$ je uzavøená na sèítání polynomù, není ale uzavøená na jejich násobení, nebo» $(x+1)(x+1)=x^2+(1+1)x+1=x^2+1$. Operaci násobení proto  definujeme \emph{modulo} polynom $x^2+x+1$. To znamená, ¾e obvyklý   souèin dvou polynomù vydìlíme se zbytkem polynomem $x^2+x+1$ a jako výsledek souèinu vezmeme tento zbytek. Potom platí napø.
\[

x(x+1)=(x+1)x=1\ \ \ \hbox{\rm a }\ \ (x+1)(x+1)=x.
\]
Zkuste si sami ovìøit axiomy tìlesa a dokázat, ¾e mno¾ina $\GG\FF(4)$ je skuteènì tìleso.
\end{example}

\begin{example}\label{P:Zn}
Mno¾ina $\ZZ_n=\{0,1,2,\dots,n-1\}$ pro $n\geq 2$ spolu s operacemi sèítání a násobení \emph{modulo} $n$ je tìleso právì kdy¾ je $n$ prvoèíslo. Toto tvrzení si nebudeme dokazovat. Pokud nìkdo zná Euklidùv algoritmus, tak to zvládne sám. Jediný problém spoèívá v dùkazu existence inverzního prvku k libovolnému èíslu $0\ne x<n$, pokud je $n$ prvoèíslo.
Pokud $n$ není prvoèíslo, tak $\ZZ_n$ není tìlesem z podobného dùvodu, kvùli kterému není $\ZZ_4$ tìleso.
\end{example}

\begin{example}\label{P:GFq}
Pro ka¾dé prvoèíslo $p$ a ka¾dý exponent $n\geq 1$ existuje právì jedno tìleso, které má $p^n$ prvkù a ¾ádná jiná tìlesa s koneèným poètem prvkù neexistují. ®ádné ¹estiprvkové tìleso tedy neeistuje. Tìlesa s poètem prvkù $p^n$ pro $n\geq 2$ se konstruují podobnì, jako jsme sestrojili ètyøprvkové tìleso v Pøíkladu~\ref{P:GF4}. Vezmeme v¹echny polynomy (vèetnì konstantních) stupnì men¹ího ne¾ $n$ s koeficienty v tìlese $\ZZ_p$. Tìch je celkem $p^n$. Na této mno¾inì sèítáme obvyklým zpùsobem a násobíme \emph{modulo {\bf vhodný} polynom} stupnì $n$. ``Vhodný" polynom je takový polynom s koeficienty v $\ZZ_p$, který nelze vyjádøit jako souèin dvou polynomù stupnì men¹ího ne¾ $n$ (analogie prvoèísel).
\end{example}

V ka¾dém tìlese $\TT$ je definovaný souèet pouze \emph{dvou} prvkù. Chceme-li seèíst tøi prvky $a,b,c\in\TT$, musíme pomocí závorek urèit, jaké dvojice prvkù postupnì sèítáme. Jsou dvì mo¾nosti a axiom asociativity sèítání øíká, ¾e obì mo¾nosti vedou ke stejnému výsledku. Podobnì je tomu i u násobení. V pøípadì souètu (souèinu) více ne¾ tøí prvkù je mo¾ností zpùsobu výpoètu je¹tì více. Následující tvrzení øíká, ¾e ani souèet (souèin) více ne¾ tøí prvkù ve skuteènosti nezávisí na uzávorkování.

\begin{proposition}\label{T:obecnaasociativita}
V ka¾dém tìlese $\TT$ platí, ¾e souèet
\[
a_1+a_2+\cdots+a_n
\]
nezávisí na uzávorkování, které k jeho výpoètu pou¾ijeme. 

Podobnì ani souèin
\[
a_1a_2\cdots a_n
\]
nezávisí na uzávorkování, které k jeho výpoètu pou¾ijeme.
\end{proposition} 

\begin{proof}
Budeme postupovat indukcí podle $n$. Dùkaz udìláme pouze pro sèítání, pro násobení je zcela stejný. Pro $n=1$ a $n=2$ je tvrzení samozøejmé, pro $n=3$ jde o axiom (A1). 

Nech» je $n\geq 4$. Indukèní pøedpoklad je, ¾e souèet ménì ne¾ $n$ prvkù tìlesa $\TT$ nezávisí na uzávorkování. Uva¾ujme nyní dvì rùzná uzávorkování souètu $a_1+a_2+\cdots+a_n$. Pøi výpoètu podle prvního uzávorkování je poslední krok souèet
\[
(a_1+\cdots+a_k)+(a_{k+1}+\cdots+a_n)
\]
pro nìjaké $0<k<n$. V obou závorkách je souèet ménì ne¾ $n$ prvkù tìlesa $\TT$. Podle indukèního pøedpokladu je souèet v ka¾dé z tìchto dvou závorek nezávislý na uzávorkování. Nemusíme proto v ¾ádné z obou závorek u¾ vypisovat konkrétní uzávorkování.

Podobnì je pøi výpoètu $a_1+a_2+\cdots+a_n$ podle druhého uzávorkování poslední krok 
\[
(a_1+\cdots+a_l)+(a_{l+1}+\cdots+a_n)
\]
pro nìjaké $0<l<n$.

Je-li $k=l$, vedou oba výpoèty souètu $a_1+a_2+\cdots+a_n$ ke stejnému souètu v posledním kroku a tedy také ke stejnému výsledku. Pokud je $k\ne l$, mù¾eme pøedpokládat, ¾e napø. $k<l$. Opìt podle indukèního pøedpokladu mù¾eme napsat první výpoèet jako
\[
(a_1+\cdots+a_k)+((a_{k+1}+\cdots+a_l)+(a_{l+1}+\cdots+a_n)).
\]
Podobnì druhý výpoèet mù¾eme napsat ve tvaru
\[
((a_1+\cdots+a_k)+(a_{k+1}+\cdots+a_l))+(a_{l+1}+\cdots+a_n).
\]
Oba výpoèty tak vedou ke stejnému výsledku podle axiomu (A1).
\end{proof}

Vlastnosti tìles hodnì závisí na následujícím èíselném parametru tìles.

\begin{definition}\label{D:charakteristika}
Existuje-li kladné celé èíslo $n$ takové, ¾e v tìlese $\TT$ platí
\[
\underbrace{1+1+\cdots+1}_{n}=0,
\]
pak nejmen¹í takové kladné èíslo nazýváme \emph{charakteristika} tìlesa $\TT$.

Pokud ¾ádné takové kladné celé èíslo $n$ neexistuje, tak øíkáme, ¾e tìleso $\TT$ má \emph{charakteristiku} $0$.
\end{definition}

\begin{theorem}\label{V:charakteristika}
Charakteristika ka¾dého tìlesa je buï \,$0$ nebo prvoèíslo.
\end{theorem}

\begin{proof}
Jestli¾e charakteristika tìlesa $\TT$ není rovná $0$, pak existuje nìjaké kladné celé èíslo $n\geq 2$, pro které platí
\[
\underbrace{1+1+\cdots+1}_{n}=0.
\]
Jestli¾e je $n$ slo¾ené èíslo, platí $n=kl$ pro nìjaká kladná celá èísla $k,l<n$. V dùsledku axiomu distributivity (D) platí
\[
(\underbrace{1+1+\cdots+1}_{k})(\underbrace{1+1+\cdots+1}_{l})=\underbrace{1+1+\cdots+1}_{kl=n}=0.
\]
Podle Tvrzení~\ref{T:otelesech}.8 mù¾e být souèin dvou prvkù v tìlese rovný $0$ pouze pokud je aspoò jeden z èinitelù rovný $0$. Proto je buï
\[
\underbrace{1+1+\cdots+1}_{k}=0
\]
nebo
\[
\underbrace{1+1+\cdots+1}_{l}=0.
\]
V ka¾dém pøípadì nemù¾e být slo¾ené èíslo $n\geq 2$ nejmen¹ím kladným celým èíslem, pro které platí
\[
\underbrace{1+1+\cdots+1}_{n}=0.
\] 
Proto¾e je $1\ne 0$ podle axiomu netriviality (N), musí být nejmen¹í takové èíslo vìt¹í nebo rovné $2$ a proto musí být prvoèíslem.
\end{proof}

\begin{cviceni}
Zjistìte charakteristiky tìles $\ZZ_2$, $\ZZ_3$, $\QQ$, $\RR$ a $\CC$. Jakou má charakteristiku koneèné tìleso, které má $p^n$ prvkù?
\end{cviceni}

Koneèná tìlesa, zejména tìlesa charakteristiky $2$, hrají zcela základní roli v teorii \emph{samoopravných kódù}, o kterých si øekneme více v nìkteré z pøí¹tích kapitol. V této kapitole si uká¾eme aplikaci v oblasti kryptologie. Je¹tì pøedtím jednu definici.

\begin{definition}\label{D:vandermond}
Je-li $\TT$ tìleso a $x_0,x_1,\dots,x_{n-1}\in\TT$, pak matici
\[
\left(\begin{array}{ccccc}
1&x_0&x_0^2&\cdots&x_0^{n-1}\\
1&x_1&x_1^2&\cdots&x_1^{n-1}\\
1&x_2&x_2^2&\cdots&x_2^{n-1}\\
\vdots &\vdots &\vdots &\ddots &\vdots\\
1&x_{n-1}&x_{n-1}^2&\cdots&x_{n-1}^{n-1}\\
\end{array}\right)
\]
nazýváme \emph{Vandermondova} matice urèená prvky $x_0,x_1,\dots,x_{n-1}\in\TT$.
\end{definition}

Základní vlastnost Vandermondových matic je obsahem následujícího tvrzení, které si doká¾eme pozdìji.

\begin{proposition}\label{T:vandermond}
Vandermondova matice urèená prvky $x_0,x_1,\dots,x_{n-1}\in\TT$ je regulární právì kdy¾ jsou prvky $x_0,x_1,\dots,x_{n-1}$ navzájem rùzné.
\end{proposition}


\bigskip
\noindent{\bf Secret sharing}
\smallskip

Secret sharing, èesky je asi nejvhodnìj¹í výraz \emph{sdílení klíèe}, je metoda, jak nìjakou informaci rozdìlit mezi $n\geq 2$ subjektù tak, aby ji mohlo rekonstruovat libovolných $k\leq n$ subjektù, ale ¾ádných $k-1$ subjektù. Uká¾eme si \emph{Shamirovo schéma} pro sdílení klíèe. Americký matematik Adi Shamir se proslavil pøedev¹ím spoluautorstvím návrhu nejèastìji pou¾ívaného systému ¹ifrování s veøejným klíèem RSA. Písmeno \emph{S} je v názvu právì kvùli Adi Shamirovi. 

Shamirovo schéma pro sdílení klíèe závisí na následujícím tvrzení, které je podstatným zobecnìním Úlohy 1.1.

\begin{proposition}\label{T:interpolace}
Buï $\TT$ libovolné tìleso obsahující aspoò $n\geq 2$ prvkù. Nech» $x_0,x_1,\dots,x_{n-1}$ je $n$ navzájem rùzných prvkù tìlesa $\TT$. Dále pøedpokládáme, ¾e $b_0,b_1,\dots,b_{n-1}$ jsou libovolné prvky tìlesa $\TT$. Potom existuje právì jedna funkce $f:\TT\to\TT$ definovaná pøedpisem
\[
f(x)=a_0+a_1x+a_2x^2+\cdots+a_{n-1}x^{n-1}=\sum_{i=0}^{n-1}a_ix^i,
\]
kde koeficienty $a_0,a_1,\dots,a_{n-1}\in\TT$ a hodnotu $f(x)$ poèítáme v tìlese $\TT$, pro kterou platí
\[
f(x_i)=b_i\ \ \hbox{\rm pro ka¾dé }\ i=0,1,\dots,n-1.
\]
\end{proposition}

\begin{proof}
Pro ka¾dé $i=0,1,\dots,n-1$ musí neznámé koeficienty $a_0,a_1,\dots,$ $a_{n-1}$ splòovat lineární rovnici
\[
a_0+a_1x_i+a_2x_i^2+\cdots+a_{n-1}x_i^{n-1}=b_i.
\]
Hledané koeficienty $a_0,a_1,\dots,a_{n-1}$ tak musí vyhovovat soustavì $n$ lineárních rovnic o $n$ neznámých
\begin{eqnarray*}
a_0+a_1x_0+a_2x_0^2+\cdots+a_{n-1}x_0^{n-1}&=&b_0\\
a_0+a_1x_1+a_2x_1^2+\cdots+a_{n-1}x_1^{n-1}&=&b_1\\
                                           &\vdots&\\
a_0+a_1x_{n-1}+a_2x_{n-1}^2+\cdots+a_{n-1}x_{n-1}^{n-1}&=&b_{n-1}.
\end{eqnarray*}

Matice této soustavy je Vandermondova matice urèená prvky $x_0,x_1,\dots,$ $x_{n-1}$. Podle Tvrzení~\ref{T:vandermond} je matice soustavy regulární. Podle Vìty~\ref{V:obecres} má tato soustava právì jedno øe¹ení $a_0,a_1,\dots,a_{n-1}$.
\end{proof}

Funkce $f(x)=a_0+a_1x+a_2x^2+\cdots+a_{n-1}x^{n-1}$ se nazývá \emph{polynom} s koeficienty v tìlese $\TT$. Právì dokázané tvrzení tak øíká, ¾e existuje právì jeden polynom stupnì $n-1$ s koeficienty v tìlese $\TT$, který má pøedepsané hodnoty v $n$ rùzných bodech.

Jak vyu¾ijeme Tvrzení~\ref{T:interpolace} k rozdìlení nìjaké informace mezi $n$ subjektù tak, aby ji mohlo rekonstruovat libovolných $k\leq n$ subjektù, ale ¾ádných $k-1$ subjektù nemohlo získat ¾ádnou relevantní informaci?

Zvolíme nìjaké kódování mo¾ných informací pomocí prvkù nìjakého koneèného tìlesa $\TT$, napø. tìlesa $\ZZ_p$, kde $p$ je dostateènì velké prvoèíslo.  Pokud je informací, kterou chceme sdílet, tøeba ètyømístný PIN, staèí zvolit $p=10007$, za pøedpokladu ¾e $n<10007$. Sdílené informaci odpovídá nìjaký prvek $a_0\in\TT$. Dále vybereme zcela náhodnì koeficienty $a_1,a_2,\dots,a_{k-1}\in\TT$. Dostaneme tak následující polynom stupnì $k-1$ s koeficienty v tìlese $\TT$
\[
f(x)=a_0+a_1x+a_2x^2+\cdots+a_{k-1}x^{k-1}.
\]
V¹imnìte si, ¾e $f(0)=a_0$. Sdílenou informaci tak známe, pokud známe polynom $f(x)$. Nyní zcela náhodnì vybereme $n$ navzájem rùzných \emph{nenulových} prvkù $x_0,x_1,\dots,$ $x_{n-1}\in\TT$. Subjektu $i$ pøidìlíme informaci $x_i\in\TT$ a $b_i=f(x_i)\in\TT$ pro $i=0,1,\dots,n-1$. 

Pokud se sejde $k$ subjektù, pak z jejich hodnot $x_i$ a $b_i=f(x_i)$ mù¾eme rekonstruovat polynom $f$, nebo» je to polynom stupnì $k-1$, u kterého známe hodnoty v $k$ rùzných bodech, a takový polynom je podle Tvrzení~\ref{T:interpolace} pouze jeden, tj. $f$. Absolutní èlen tohoto polynomu je pak sdílená informace.

A co kdy¾ se sejde pouze $k-1$ subjektù? Nemohou získat spoleènì aspoò èásteènou informaci o prvku $a_0\in \TT$? Pokud známe pouze $k-1$ hodnot $x_i$ a $b_i$, mù¾eme si k nim pøidat libovolný prvek $b\in\TT$ a pova¾ovat jej za hodnotu hledaného polynomu v bodì $0$. Podle Tvrzení~\ref{T:interpolace} existuje právì jeden polynom $g$ stupnì $k-1$ s koeficienty v tìlese $\TT$, který má pøedepsané hodnoty $b_i$ v $k-1$ bodech $x_i$ a hodnotu $b$ v bodì $0$. Zde vyu¾íváme pøedpokladu, ¾e v¹echny prvky $x_0,x_1,\dots,x_{n-1}\in\TT$ jsou rùzné a nenulové. Pro ka¾dou mo¾nou hodnotu sdílené informace $b$ tak existuje právì jeden polynom $g$, který má absolutní èlen rovný $b$ a pøedepsané hodnoty $b_0,b_1,\dots,b_{n-1}\in\TT$ v  $k-1$ bodech $x_0,x_1,\dots,x_{n-1}\in\TT$. V¹echny mo¾né hodnoty absolutního èlenu $b$ jsou tedy stejnì pravdìpodobné a ze znalosti $k-1$ hodnot $x_i$ a $b_i$ tak nemù¾eme získat ¾ádnou relevantní informaci o prvku $a_0\in\TT$.  

\begin{cviceni}
Rozdìlte informaci o ètyømístném PINu mezi tøi kamarády tak, aby ¾ádný z nich PIN neznal, ale ka¾dá dvojice jej mohla vypoèítat. Napi¹te program pro výpoèet PINu ze znalosti informací, které má libovolná dvojice k dispozici. Zkuste navrhnout vlastní schema pro sdílení informace o PINu.
\end{cviceni}



\chapter{Vektorové prostory}

V pøedchozí kapitole jsme podstatným zpùsobem roz¹íøili na¹i pøedstavu o tom, co je to èíslo. Nadále jsou pro nás dùle¾ité pøedev¹ím vlastnosti operací sèítání a násobení èísel, o kterých pouze pøedpokládáme, ¾e splòují podmínky Definice~\ref{D:teleso}. Samotná èísla tak dùle¾itá nejsou. 

Podobnì nyní roz¹íøíme pojem vektoru tak, aby jeho souøadnice mohly pocházet z libovolného tìlesa $\TT$. Následující definice bezprostøednì zobecòuje Definici~\ref{D:realvektory}.

\begin{definition}\label{D:vektor}
Pøedpokládáme, ¾e $\TT$ je nìjaké tìleso. \emph{Vektor} dimenze $n$ nad tìlesem $\TT$ je uspoøádaná $n$-tice  $(x_1,x_2,\dots,x_n)$ prvkù tìlesa $\TT$. Èíslo $x_i$ nazýváme $i$-tá \emph{souøadnice} tohoto vektoru. Jsou-li vektory $(x_1,x_2,\dots,x_n)$ a $(y_1,y_2,\dots,y_n)$ stejné dimenze $n$ a nad tìlesem $\TT$, pak jejich \emph{souètem} rozumíme vektor
\[
(x_1,x_2,\dots,x_n)+(y_1,y_2,\dots,y_n)=(x_1+y_1,x_2+y_2,\dots,x_n+y_n).
\]
Souèet dvou vektorù dimenze $n$ nad tìlesem $\TT$ je tedy opìt vektor dimenze $n$ nad tìlesem $\TT$.

Je-li $a\in\TT$, pak \emph{souèinem} prvku $a$ a vektoru $(x_1,x_2,\dots,x_n)$ rozumíme vektor
\[
a(x_1,x_2,\dots,x_n)=(ax_1,ax_2,\dots,ax_n).
\]
Souèin prvku $a\in\TT$ a vektoru dimenze $n$ nad tìlesem $\TT$ je proto opìt vektor dimenze $n$ nad tìlesem $\TT$.

Mno¾inu v¹ech vektorù dimenze $n$ nad tìlesem $\TT$ spolu s právì definovanými operacemi sèítání vektorù a násobení vektoru prvkem tìlesa $\TT$ nazýváme \emph{aritmetický vektorový prostor} dimenze $n$ nad tìlesem $\TT$. Oznaèovat jej budeme $\TTT^n$.  
\end{definition}

Sèítání vektorù stejné dimenze nad tìlesem $\TT$ a jejich násobení prvky z tìlesa $\TT$ má øadu vlastností spoleèných se sèítáním a násobením prvkù tìlesa $\TT$. Mù¾ete si to snadno ovìøit v následujícím cvièení.

\begin{cviceni}
Doka¾te, ¾e v aritmetickém vektorovém prostoru $\TTT^n$ nad tìlesem $\TT$ pro libovolné tøi vektory $\vex,\vey,\vez\in\TTT^n$ a prvky $a,b\in\TT$ platí
\begin{enumerate}
	\item $\vex+(\vey+\vez)=(\vex+\vey)+\vez$,
	\item $\vex+\vey=\vey+\vex$,
	\item pro \emph{nulový vektor} $\mathbf{0}=\underbrace{(0,0,\dots,0)}_{n}$ platí $\mathbf{0}+\vex=\vex$,
	\item je-li $\vex=(x_1,x_2,\dots,x_n)$ a oznaèíme-li $-\vex=(-x_1,-x_2,\dots,-x_n)$ \emph{opaèný vektor} k vektoru $\vex$, pak platí $(-\vex)+\vex=\mathbf{0}$,
	\item $1\vex=\vex$,
	\item $a(b\vex)=(ab)\vex$,
	\item $(a+b)\vex=a\vex+b\vex$,
	\item $a(\vex+\vey)=a\vex+a\vey$.
\end{enumerate}
\end{cviceni}

Pokud se vrátíte ke Cvièení~\ref{C:aritmetikamatic}, tak zjistíte, ¾e sèítání reálných matic tvaru $m\times n$ a násobení tìchto matic reálnými èísly má zcela stejné vlastnosti. Stejné vlastnosti má také sèítání matic tvaru $m\times n$ s prvky z tìlesa $\TT$ a jejich násobení prvky tìlesa $\TT$. 

Existuje øada dal¹ích pøíkladù mno¾in, jejich¾ prvky lze sèítat a násobit prvky nìjakého tìlesa a tyto operace mají vlastnosti vyèíslené v pøedchozím cvièení. Podobnì jako v pøípadì tìles není dùle¾itá konkrétní podoba prvkù tìchto mno¾in, ale algebraické vlastnosti operací sèítání a násobení prvky tìlesa $\TT$. Následující dùle¾itá definice shrnuje vlastnosti poèítání s vektory a maticemi, které pova¾ujeme za dùle¾ité.

\begin{definition}\label{D:vectorspace}
Pøedpokládáme, ¾e $\TT$ je tìleso. Dále pøedpokládáme, ¾e $\VVV$ je nìjaká mno¾ina, na které je definovaná operace sèítání a násobení prvkù tìlesa $\TT$ s prvky mno¾iny $\VVV$. Pokud tyto operace splòují následující podmínky, pak øíkáme, ¾e mno¾ina $\VVV$ spolu s tìmito operacemi tvoøí \emph{vektorový prostor nad tìlesem} $\TT$. Podmínky pro sèítání jsou
\begin{description}
 	 \item [(A0)] souèet $\vex+\vey\in\VVV$ pro libovolné prvky $\vex,\vey\in\VVV$,
   \item [(A1)] platí $(\vex+\vey)+\vez=\vex+(\vey+\vez)$ pro libovolné $\vex,\vey,\vez\in\VVV$,
   \item [(A2)] platí $\vex+\vey=\vey+\vex$ pro libovolné dva prvky $\vex,\vey\in\VVV$,
	 \item [(A3)] existuje prvek $\mathbf{0}\in\VVV$ takový, ¾e $\mathbf{0}+\vex=\vex$ pro ka¾dý prvek $\vex\in\VVV$,
	 \item [(A4)] ke ka¾dému prvku $\vex\in\VVV$ existuje prvek $-\vex\in\VVV$, pro který platí, ¾e $(-\vex)+\vex=\mathbf{0}$.
\end{description}	 
Dále následují axiomy pro násobení prvkù tìlesa $\TT$ s prvky mno¾iny $\VVV$:
\begin{description}
	\item[(N0)] souèin $a\vex\in\VVV$ pro libovolné prvky $a\in\TT$ a $\vex\in\VVV$,
	\item[(N1)] platí $1\vex=\vex$ pro jednotkový prvek $1\in\TT$ a libovolný prvek $\vex\in\VVV$,
	\item[(N2)] platí $a(b\vex)=(ab)\vex$ pro libovolné dva prvky $a,b\in\TT$ a ka¾dý prvek $\vex\in\VVV$,
	\item[(N3)] platí $(a+b)\vex=a\vex+b\vex$  pro libovolné dva prvky $a,b\in\TT$ a ka¾dý prvek $\vex\in\VVV$,
	\item[(N4)] platí $a(\vex+\vey)=a\vex+a\vey$ pro libovolný prvek $a\in\TT$ a ka¾dé dva prvky $\vex,\vey\in\VVV$.
\end{description}
Prvky vektorového prostoru $\VVV$ nazýváme také \emph{vektory} a prvkùm tìlesa $\TT$ v takovém pøípadì øíkáme  \emph{skaláry}.	 
\end{definition}

Axiomy pro sèítání prvkù vektorového prostoru jsou zcela stejné jako axiomy pro sèítání v nìjakém tìlese. Dal¹í komentáø nepotøebují. Naproti tomu axiomy pro násobení skalárù s vektory jsou zcela jiné ne¾ axiomy pro násobení prvkù nìjakého tìlesa. Pøedev¹ím je tøeba si uvìdomit, ¾e není definován souèin dvou vektorù, ale souèin skaláru a vektoru (v tomto poøadí!). Souèin vektoru se skalárem $\vex a$ jsme \emph{nedefinovali}. Proto také nemá smysl mluvit o komutativitì násobení ve vektorovém prostoru -- jeden z obou souèinù prostì nemá smysl. Ze stejného dùvodu jsme museli uvést dva rùzné axiomy distributivity (N3) a (N4). Axiom asociativity násobení ve vektorovém prostoru (N2) je také tøeba upravit kvùli jinému charakteru násobení ve vektorovém prostoru. A nakonec axiom (N1) øíká, ¾e jednotkový prvek tìlesa $\TT$ je neutrální vzhledem k násobení ve vektorovém prostoru. 

Stejnì jako v pøípadì tìles nejdøíve uvedeme nìkolik bezprostøedních dùsledkù axiomù vektorového prostoru.

\begin{proposition}\label{T:oprostorech}
V ka¾dém vektorovém prostoru $\VVV$ nad tìlesem $\TT$ platí 
\begin{enumerate}  
  \item nulový vektor $\nul$ je urèený jednoznaènì
	\item opaèný vektor $-\vex$ je urèený vektorem $\vex$ jednoznaènì,
	\item $-(-\vex)=\vex$ pro ka¾dý vektor $\vex\in\VVV$,
	\item $0\vex=\mathbf{0}$ pro ka¾dý vektor $\vex\in\VVV$,
	\item $a\mathbf{0}=\mathbf{0}$ pro ka¾dý skalár $a\in\TT$,
	\item $-\vex=(-1)\vex$ pro ka¾dý vektor $\vex\in\VVV$,
	\item jestli¾e $a\vex=\mathbf{0}$, pak buï $a=0$ nebo $\vex=\nul$.
\end{enumerate}
\end{proposition}

\begin{proof}
Dùkazy jsou ve stejném duchu jako dùkazy jednotlivých vlastností tìles v Tvrzení~\ref{T:otelesech}. Nebudeme proto uvádìt pro ka¾dou rovnost ze kterého axiomu, pøípadnì døíve dokázané vlastnosti vektorových prostorù, plyne. Mù¾ete si to v pøípadì pochybností ovìøit sami.

Vlastnosti 1, 2, 3 a 4 se dokazují úplnì stejnì jako vlastnosti 1, 2, 3 a 4 v Tvrzení~\ref{T:otelesech}. 

Podobnì jako vlastnost 4 se dokazuje také vlastnost 5: z axiomù (N4) a (A3) plyne
\[
a\nul=a(\nul+\nul)=a\nul+a\nul.
\]   
Pøiètením vektoru $-(a\nul)$ k obìma stranám rovnosti $a\nul=a\nul+a\nul$ dostaneme $\nul=a\nul$.

6. Pøímým výpoètem dostaneme (v¹imnìte si pou¾ití axiomu (N2))
\[
\nul=0\vex=(-1+1)\vex=(-1)\vex+1\vex=(-1)\vex+\vex.
\]
Z jednoznaènosti opaèného vektoru k vektoru $\vex$ plyne rovnost $-\vex=(-1)\vex$.

7. Je-li $a\ne 0$, pak mù¾eme rovnost $a\vex=\nul$ vynásobit skalárem $a^{-1}$. Dostaneme tak
\[
\vex=1\vex=(a^{-1}a)\vex=a^{-1}(a\vex)=a^{-1}\nul=\nul.
\]
\end{proof}

Aritmetický vektorový prostor $\TTT^n$ dimenze $n$ nad tìlesem $\TT$ je základním pøíkladem vektorového prostoru. Ze Cvièení~\ref{C:aritmetikamatic} plyne, ¾e také mno¾ina $\RRR^{m\times n}$ reálných matic tvaru $m\times n$ spolu s operacemi sèítání matic a násobení matic reálnými èísly je vektorový prostor nad tìlesem reálných èísel $\RR$. Podobnì mno¾ina $\TTT^{m\times n}$ v¹ech matic tvaru $m\times n$ s prvky z tìlesa $\TT$ spolu s operacemi sèítání matic a násobení matic prvky tìlesa $\TT$ je vektorový prostor nad tìlesem $\TT$. 

Následují pøíklady vektorových prostorù, jejich¾ prvky nejsou ani vektory v obvyklém smyslu slova ani matice.

\begin{example}\label{P:polynomy}
Mno¾ina $\RR[x]$ v¹ech reálných polynomù spolu s operacemi sèítání a násobení polynomù reálným èíslem tvoøí vektorový prostor nad tìlesem reálných èísel $\RR$. (Ovìøte v¹echny axiomy!) 

Podobnì tvoøí vektorový prostor nad tìlesem $\RR$ mno¾ina $\RR_{\leq n}[x]$ v¹ech reálných polynomù stupnì nejvý¹e $n$ (vèetnì nulového polynomu) spolu s operacemi sèítání polynomù a násobení polynomù reálným èíslem.

Reálná èísla v pøedchozích dvou odstavcích nejsou dùle¾itá. Stejnì tak mù¾eme uva¾ovat mno¾inu $\TT[x]$ polynomù jedné promìnné s koeficienty v libovolném tìlese $\TT$. Spolu s operacemi sèítání polynomù a násobení polynomù prvky tìlesa $\TT$ tvoøí mno¾ina $\TT[x]$ vektorový prostor nad tìlesem $\TT$.

Také mno¾ina $\TT_{\leq n}[x]$ v¹ech polynomù stupnì nejvý¹e $n$ (vèetnì nulového polynomu) s koeficienty v tìlese $\TT$ tvoøí s operacemi sèítání polynomù a násobení polynomù prvky tìlesa $\TT$ vektorový prostor nad $\TT$.
\end{example}

Dal¹í pøíklady vektorových prostorù jsou tvoøené funkcemi.

\begin{example}
Mno¾ina v¹ech reálných funkcí $f:[0,1]\to\RR$ definovaných na uzavøeném intervalu $[0,1]$ tvoøí vektorový prostor nad $\RR$ spolu s operacemi
\[
(f+g)(x)=f(x)+g(x),\ \ \ \ (kf)(x)=kf(x).
\] 

Se stejnì definovanými operacemi tvoøí vektorový prostor nad $\RR$ také mno¾ina v¹ech \emph{spojitých} reálných funkcí definovaných na intervalu $[0,1]$.

Dal¹í vektorový prostor nad $\RR$ tvoøí mno¾ina v¹ech \emph{diferencovatelných} funkcí $f:[0,1]\to\RR$ spolu se stejnými operacemi jako v pøedchozích dvou odstavcích. (Ovìøte si ve v¹ech tøech pøípadech platnost v¹ech axiomù vektorového prostoru.)
\end{example} 

Ka¾dá diferencovatelná funkce $f:[0,1]\to\RR$ je spojitá na celém intervalu $[0,1]$. Mno¾ina v¹ech diferencovatelných funkcí definovaných na intervalu $[0,1]$ je tak podmno¾inou mno¾iny spojitých funkcí na intervalu $[0,1]$. Souèet$f+g$ dvou diferencovatelných funkcí $f,g:[0,1]\to\RR$ nezávisí na tom, sèítáme-li je jako diferencovatelné funkce nebo jako spojité funkce. Dùle¾ité ale je, ¾e jsou-li $f,g$ diferencovatelné, pak také jejich souèet $f+g$ je diferencovatelná funkce. Podobnì ani souèin $kf$ reálného èísla $k$ s diferencovatelnou funkcí $f$ nezávisí na tom, pova¾ujeme-li $f$ za diferencovatelnou funkci nebo za spojitou. Podstatné je, ¾e souèin $kf$ je diferencovatelná funkce, pokud je $f$ diferencovatelná funkce. 

Prostor diferencovatelných reálných funkcí definovaných na intervalu $[0,1]$ je obsa¾ený v prostoru spojitých funkcí na $[0,1]$ nejen ve smyslu inkluze, ale také tím, ¾e se v nìm poèítá s diferencovatelnými funkcemi stejnì, jako bychom s nimi poèítali ve vìt¹ím prostoru spojitých funkcí. Tento vztah mezi dvìma vektorovými prostory nad stejným tìlesem je dùle¾itý a je obsahem následující definice.

\begin{definition}\label{D:podprostor}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Je-li neprázdná mno¾ina $\UUU\subseteq\VVV$ vektorový prostor nad tìlesem $\TT$ spolu s operacemi definovanými v prostoru $\VVV$, tj. splòuje-li axiomy (A0)-(A4) a (N0)-(N4), pak øíkáme, ¾e prostor $\UUU$ je  \emph{podprostorem} prostoru $\VVV$.
\end{definition}

Ve skuteènosti není nutné ovìøovat platnost v¹ech 10 axiomù vektorového prostoru pro operace definované na podmno¾inì $\UUU$.
\begin{uloha}\label{U:uzavrenost}
Neprázdná podmno¾ina $\UUU$ vektorového prostoru $\VVV$ nad tìlesem $\TT$ spolu s operacemi definovanými v prostoru $\VVV$ je podprostor prostoru $\VVV$ právì kdy¾ splòuje oba axiomy uzavøenosti (A0) a (N0). Doka¾te.
\end{uloha}
 
\begin{reseni}
Pokud je $\UUU$ podprostor prostoru $\VVV$, musí splòovat \emph{v¹echny} axiomy vektorového prostoru, nejen (A0) a (N0).

Naopak, pokud $\UUU$ splòuje oba axiomy uzavøenosti, vezmeme libovolný prvek $\vex\in\UUU$ (mno¾ina $\UUU$ je neprázdná!). Podle axiomu (N0) také $(-1)\vex=-\vex\in\UUU$. Proto podle axiomu (A0) platí také $\nul=-\vex+\vex\in\UUU$. Operace sèítání na mno¾inì $\UUU$ tak splòuje axiomy (A3) a (A4). Asociativita (A1) a komutativita (A2) platí proto, ¾e operace sèítání prvkù mno¾iny $\UUU$ se shoduje s operací sèítání tìchto prvkù v prostoru $\VVV$, která komutativní a asociativní je.

Ze stejného dùvodu platí pro operaci násobení prvkù tìlesa $\TT$ s prvky mno¾iny $\UUU$ v¹echny axiomy (N1)-(N4).
\end{reseni}

Ka¾dý vektorový prostor $\VVV$ nad tìlesem $\TT$ má urèitì dva podprostory. Jenodprvkový podprostor $\NNN=\{\nul\}$ a celý prostor $\VVV$. Tìmto podprostorùm øíkáme \emph{triviální} podprostory.

\begin{uloha}\label{U:podprostory}
Najdìte v¹echny podprostory aritmetického reálného prostoru $\RRR^2$.
\end{uloha}

\begin{reseni}
Pro ka¾dý nenulový vektor $\vea=(a_1,a_2)^T$ oznaèíme symbolem $\LLL(\vea)$ mno¾inu $\{(ka_1,ka_2)^T : k\in\RR\}$. Snadno ovìøíme, ¾e mno¾ina $\LLL(\vea)$ splòuje oba axiomy uzavøenosti a urèuje tak podprostor prostoru $\RRR^2$.

Nyní budeme uva¾ovat podprostor $\LLL(\vea)$ a vektor $\veb=(b_1,b_2)^T\not\in\LLL(\vea)$. To znamená, ¾e $(b_1,b_2)^T\ne(ka_1,ka_2)^T$ pro libovolné reálné èíslo $k$. Pro jakýkoliv vektor $\cc=(c_1,c_2)^T\in\RRR^2$ uva¾ujeme soustavu lineárních rovnic
\begin{eqnarray*}
a_1x+b_1y&=&c_1\\
a_2x+b_2y&=&c_2.
\end{eqnarray*}
Z pøedpokladu $(b_1,b_2)^T\ne(ka_1,ka_2)^T$ vyplývá, ¾e (sloupcová) hodnost matice 
\[
\left(\begin{array}{cc}
a_1 & b_1\\
a_2 & b_2
\end{array}\right)
\]
této soustavy se rovná $2$, proto¾e hodnost této matice a matice k ní transponované se rovnají podle Tvrzení~\ref{V:rovnosthodnosti}. Soustava má proto jednoznaèné øe¹ení. Existují tedy reálná èísla $x,y$, pro která platí
\[
x\vea + y\veb=\cc.
\]
Ka¾dý podprostor prostoru $\RRR^2$ obsahující vektory $\vea$ a $\veb$ musí obsahovat vektory $x\vea$ a $y\veb$ vzhledem k axiomu uzavøenosti (N0) a kvùli axiomu uzavøenosti na sèítání (A0) také vektor $x\vea+y\veb=\cc$. Ka¾dý podprostor prostoru $\RRR^2$ obsahující vektory $\vea$ a $\veb\not\in\LLL(\vea)$ se proto rovná celému prostoru $\RRR^2$. Kromì triviálních podprostorù $\{\nul\}$ a $\RRR^2$ jsou tak podprostory $\LLL(\vea)=\{(ka_1,ka_2)^T : k\in\RR\}$ jedinými netriviálními podprostory $\RRR^2$ . 
\end{reseni}

Ka¾dý podprostor $\LLL(\vea)=\{k\vea:k\in\RR\}$ je pøímka procházející poèátkem. Podobnì jako v pøedchozí úloze mù¾ete vyøe¹it následující cvièení.

\begin{cviceni} 
Doka¾te, ¾e netriviální podprostory tøídimenzionálního reálného aritmetického prostoru jsou pøímky a roviny procházející poèátkem.
\end{cviceni}

\begin{cviceni}
Tìleso reálných èísel lze v pøedchozí úloze a cvièení bez problémù nahradit obecným tìlesem $\TT$. Najdìte v¹echny netriviální podprostory aritmetických vektorových prostorù $\TTT^2$ a $\TTT^3$ nad tìlesem $\TT$.
\end{cviceni}

Nyní se vrátíme k Úloze~\ref{U:podprostory} a budeme se zabývat tam zji¹tìným faktem, ¾e ka¾dý podprostor $\RRR^2$ obsahující dva vektory $\vea\ne\nul$ a $\veb\not\in\LLL{\vea}$ se u¾ musí rovnat celému prostoru $\RRR^2$. Tuto skuteènost vyjadøujeme slovy, ¾e vektory $\vea,\veb$ \emph{generují} prostor $\RRR^2$. Abychom mohli pojem ``generuje" definovat obecnì, doká¾eme v následující úloze dva bezprostøední dùsledky definice podprostoru vektorového prostoru.

\begin{uloha}\label{U:prunik}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Doka¾te, ¾e
\begin{itemize}
	\item prùnik libovolných podprostorù $\UUU_i$, $i\in I$, prostoru $\VVV$ je opìt podprostor prostoru $\VVV$,
	\item pro ka¾dou podmno¾inu $X\subseteq\VVV$ existuje nejmen¹í (vzhledem k inkluzi) podprostor prostoru $\VVV$ obsahující mno¾inu $X$.
\end{itemize}
\end{uloha}

\begin{reseni}
Oznaèíme si
\[
\UUU=\bigcap_{i\in I}\UUU_i.
\] 
Abychom dokázali, ¾e $\UUU$ je podprostor $\VVV$, potøebujeme podle Úlohy~\ref{U:uzavrenost} ovìøit, ¾e mno¾ina $\UUU$ splòuje oba axiomy uzavøenosti (A0) a (N0).Jsou-li $\vex,\vey\in\UUU$ dva vektory, pak $\vex,\vey\in\UUU_i$ pro ka¾dé $i\in I$. Ka¾dá mno¾ina $\UUU_i$, $i\in I$, je podprostor $\VVV$, splòuje proto axiom uzavøenosti (A0), proto také $\vex+\vey\in\UUU_i$ pro ka¾dé $i\in I$. Tudí¾ $\vex+\vey\in\UUU$.

Zcela stejnì se doká¾e také uzavøenost mno¾iny $\UUU$ na násobení skaláry. Je-li $\vex\in\UUU$, pak $\vex\in\UUU_i$ pro ka¾dé $i\in I$. Je-li $a\in\TT$, pak také $a\vex\in\UUU_i$ pro ka¾dé $i\in I$, proto rovnì¾ $a\vex\in\UUU$. Mno¾ina $\UUU$ tak splòuje oba axiomy uzavøenosti (A0) a (N0) a je tedy podprostor prostoru $\VVV$.

Je-li nyní $X$ libovolná podmno¾ina prostoru $\VVV$, oznaèíme $\{\UUU_i:i\in I\}$ mno¾inu v¹ech podprostorù $\VVV$ obsahujících mno¾inu $X$. Právì jsme dokázali, ¾e 
\[
\UUU=\bigcap_{i\in I}\UUU_i
\]
je také podprostor $\VVV$ a zøejmì $X\subseteq \UUU$. Ka¾dý podprostor $\VVV$ obsahující mno¾inu $X$ se rovná podprostoru $\UUU_i$ pro nìjaké $i\in I$, proto $\UUU\subseteq\UUU_i$. Podprostor $\UUU$ je tedy nejmen¹í podprostor (vzhledem k inluzi) obsahující mno¾inu $X$.
\end{reseni}

\begin{definition}\label{D:linobal}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Je-li $X\subseteq\VVV$, pak nejmen¹í podprostor $\VVV$ obsahující mno¾inu $X$, jeho¾ existenci jsme dokázali v Úloze~\ref{U:prunik}, nazýváme \emph{lineární obal} mno¾iny $X$ a oznaèujeme jej $\LLL(X)$. Øíkáme také, ¾e mno¾ina $X$ \emph{generuje} podprostor $\LLL(X)$ nebo ¾e podprostor $\LLL(X)$ je \emph{generovaný} mno¾inou $X$. Je-li $X=\{\vex_1,\dots,\vex_n\}$ koneèná mno¾ina, pak místo $\LLL(\{\vex_1,\dots,\vex_n\})$ budeme psát $\LLL(\vex_1,\dots,\vex_n)$. 
\end{definition}

Zavedené oznaèení lineárního obalu mno¾iny $X$ je v souladu s døíve pou¾ívaným oznaèením $\LLL(\vea)=\{k\vea:k\in \RR\}$, nebo» tato mno¾ina je zøejmì podprostor prostoru $\RRR^2$ a ka¾dý podprostor $\RRR^2$ obsahující vektor $\vea$ musí podle axiomu (N0) obsahovat v¹echny vektory $k\vea$ pro $k\in \RR$ a tedy celou mno¾inu $\{k\vea:k\in \RR\}$. V¹imnìte si také, ¾e ka¾dý podprostor prostoru $\VVV$ musí obsahovat nulový vektor $\nul$ a proto $\LLL(\emptyset)=\{\nul\}$.

Následující tvrzení udává ``vnitøní" popis lineárního obalu $\LLL(X)$ mno¾iny $X$.

\begin{proposition}\label{T:linobal}
Je-li $X$ podmno¾ina vektorového prostoru $\VVV$ nad tìlesem $\TT$, pak platí
\[
\LLL(X)=\{\sum_{i=1}^n a_i\vex_i:n\geq 0, a_i\in\TT, \vex_i\in X\ \hbox{\rm pro } i=1,2,\dots,n\}.
\]
\end{proposition} 
Mno¾ina na pravé stranì rovnosti je mno¾ina v¹ech mo¾ných lineárních kombinací prvkù mno¾iny $X$. Aby rovnost platila také pro prázdnou mno¾inu $X$, musíme pova¾ovat prázdný souèet za rovný $\nul$.

\begin{proof}
Mno¾inu na pravé stranì rovnosti si oznaèíme $\UUU$. Doká¾eme napøed, ¾e $\UUU$ je podprostor prostoru $\VVV$. Snaz¹í je dokázat uzavøenost na násobení skaláry. Je-li toti¾
\[
\vex=\sum_{i=1}^n a_i\vex_i\in\UUU,
\]
pak také
\[
k\vex=k\sum_{i=1}^n a_i\vex_i=\sum_{i=1}^n (ka_i)\vex_i\in\UUU.
\]

Je-li dále 
\[
\vey=\sum_{j=1}^m b_j\vey_j
\]
dal¹í prvek mno¾iny $\UUU$, mù¾eme v pøípadì potøeby pøidat k obìma vyjádøením vektorù $\vex$ a $\vey$ dal¹í vektory s nulovými koeficienty tak, aby oba vektory $\vex$ a $\vey$ byly lineární kombinací stejných vektorù $\{\vez_1,\vez_2,\dots,\vez_p\}\subseteq X$:
\[
\vex=\sum_{k=1}^p c_k\vez_k,\ \ \ \ \vey=\sum_{k=1}^p d_k\vez_k.
\]
Potom
\[
\vex+\vey=\sum_{k=1}^p (c_k+d_k)\vez_k.
\]
Mno¾ina $\UUU$ je tedy podprostor prostoru $\VVV$.

Zbývá dokázat, ¾e $\UUU$ je \emph{nejmen¹í} podprostor prostoru $\VVV$ obsahující mno¾inu $X$. Je-li $\WWW$ libovolný podprostor $\VVV$ obsahující mno¾inu $X$ a 
\[
\vex=\sum_{i=1}^n a_i\vex_i\in\UUU,
\]
pak podle definice mno¾iny $\UUU$ platí $\vex_i\in X\subseteq\WWW$ pro ka¾dé $i=1,2,\dots,n$. Proto také $a_i\vex_i\in\WWW$ pro ka¾dé $i=1,2,\dots,n$ (axiom (N0)). Vzhledem k axiomu uzavøenosti (A0) pak také
\[
\vex=\sum_{i=1}^n a_i\vex_i\in\WWW.
\]
Proto $\UUU\subseteq\WWW$ pro ka¾dý podprostor $\WWW$ prostoru $\VVV$ obsahující mno¾inu $X$. Proto¾e u¾ víme, ¾e $\UUU$ je podprostor $\VVV$, dokázali jsme tak $\LLL(X)=\UUU$.
\end{proof}

V pøípadì, ¾e je mno¾ina $X$ koneèná, tj. $X=\{\vex_1,\vex_2,\dots,\vex_n\}$, pak mù¾eme lineární obal $X$ vyjádøit jednodu¹eji.

\begin{corollary}\label{C:linobal}
Pokud je $X=\{\vex_1,\vex_2,\dots,\vex_n\}$, pak
\[
\LLL(X)=\{\sum_{i=1}^n a_i\vex_i: a_i\in\TT\}.
\]
\end{corollary}

\begin{proof}
Oznaème si
\[
\UUU=\{\sum_{i=1}^n a_i\vex_i: a_i\in\TT\}.
\]
Podle Tvrzení~\ref{T:linobal} platí $\UUU\subseteq\LLL(X)$. Zbývá dokázat opaènou inkluzi a tu doká¾eme tím, ¾e se pøesvìdèíme, ¾e $\UUU$ je podprostor prostoru $\VVV$. To je ale snadné. Pokud
\[
\vex=\sum_{i=1}^n a_i\vex_i\in\UUU\ \ \ \ \hbox{\rm a }\ \ \ \vey=\sum_{i=1}^n b_i\vex_i\in\UUU,
\]
pak také
\[
\vex+\vey=\sum_{i=1}^n(a_i+b_i\vex_i\in\UUU\ \ \ \hbox{\rm a\ }\ \ \ k\vex=\sum_{i=1}^n (ka_i)\vex_i\in\UUU   
\]
pro libovolný prvek $k\in\TT$.
\end{proof}

\bigskip
\noindent{\bf Podprostory urèené maticí}
\smallskip

Ka¾dá matice urèuje ètyøi podprostory vhodných aritmetických vektorových prostorù. 

\begin{definition}\label{D:podprostorymatice}
Je-li $\bAA=(a_{ij})$ matice tvaru $m\times n$ s prvky z tìlesa $\TT$, pak \emph{sloupcový prostor} matice $\bAA$ je lineární obal
\[
\SSS(\bAA)=\LLL(\bAA_{*1},\bAA_{*2},\dots,\bAA_{*n})\subseteq\TTT^m
\]
sloupcových vektorù matice $\bAA$.

\emph{Øádkový prostor} matice $\bAA$ je lineární obal
\[
\RRR(\bAA)=\LLL(\bAA_{1*},\bAA_{2*},\dots,\bAA_{m*})\subseteq\TTT^n
\] 
øádkových vektorù matice $\bAA$.
\end{definition}  

Následující jednoduché tvrzení udává ekvivalentní popis sloupcového a øádkového prostoru matice.

\begin{proposition}\label{T:obory hodnot}
Pro matici $\bAA=(a_{ij})$ tvaru $m\times n$ s prvky z tìlesa $\TT$ platí
\begin{itemize}
	\item $\SSS(\bAA)=\{\bAA\vex:\vex\in\TTT^n\}$,
	\item $\RRR(\bAA)=\{\vey^T\bAA:\vey\in\TTT^m\}$.
\end{itemize}
\end{proposition}

\begin{proof}
Obì tvrzení jsou jednoduchá a jsou pøímým dùsledkem definic. 

Je-li $\vez\in\SSS(\bAA)$, pak existují podle Dùsledku~\ref{C:linobal} skaláry $x_1,x_2,\dots,x_n\in\TT$, pro které platí
\[
\vez=\sum_{i=1}^n x_i\bAA_{*i}.
\]  
Oznaèíme-li $\vex=(x_1,x_2,\dots,x_n)^T\in\TTT^n$, pak 
\[
\sum_{k=1}^n x_k\bAA_{*k}=\bAA\vex
\]
podle Tvrzení~\ref{T:strukturasoucinu}.

V¹echny implikace v pøedchozí èásti dùkazu mù¾eme obrátit. Pokud $\vez=\bAA\vex^T$ pro nìjaký vektor $\vex=(x_1,x_2,\dots,x_n)^T\in\TTT^n$, pak podle Tvrzení~\ref{T:strukturasoucinu} platí
\[
\vez=\bAA\vex^T=\sum_{j=1}^n x_j\bAA_{*j},
\] 
tj. $\vez\in\SSS(\bAA)$ podle Dùsledku~\ref{C:linobal}.

Druhou èást tvrzení doká¾eme zcela stejnì. Platí
\[
\vez\in\RRR(\bAA)
\]
právì kdy¾ existují prvky $y_1,y_2,\dots,y_m\in\TT$ takové, ¾e
\[
\vez=\sum_{j=1}^m y_m\bAA_{j*}.
\] 
Oznaèíme-li $\vey=(y_1,y_2,\dots,y_m)^T\in\TTT^m$, pak podle Tvrzení~\ref{T:strukturasoucinu} 
\[
\sum_{j=1}^m y_j\bAA_{j*}=\vey^T\bAA.
\]
\end{proof}

Dal¹í dva podprostory urèené maticí $\bAA$ závisí na následujícím tvrzení.

\begin{proposition}\label{T:nuloveprostory}
Je-li $\bAA$ matice tvaru $m\times n$ s prvky z tìlesa $\TT$, pak platí
\begin{itemize}
	\item mno¾ina $\NNN(\bAA)=\{\vex\in\TTT^n:\bAA\vex=\nul\}$ je podprostor prostoru $\TTT^n$,
	\item mno¾ina $\MMM(\bAA)=\{\vey\in\TTT^m:\vey^T\bAA=\nul\}$ je podprostor prostoru $\TTT^m$.
\end{itemize} 
\end{proposition}

\begin{proof}
Obì tvrzení jsou opìt snadná. Doká¾eme pouze první z nich. Potøebujeme dokázat, ¾e mno¾ina $\NNN(\bAA)=\{\vex\in\TTT^n:\bAA\vex=\nul\}$ splòuje oba axiomy uzavøenosti (A0) a (N0). Jsou-li $\vex,\vey\in\NNN(\bAA)$, pak platí $\bAA\vex=\nul$ a $\bAA\vex=\nul$. Proto¾e násobení matic je distributivní vzhledem ke sèítání podle Tvrzení~\ref{T:aritmatic}, platí
\[
\bAA(\vex+\vey)=\bAA\vex+\bAA\vey=\nul.
\] 
Rovnì¾
\[
\bAA(k\vex)=k(\bAA\vex)=k\nul=\nul
\]
podle Cvièení~\ref{C:matice}.

Druhá èást tvrzení se doká¾e zcela stejnì.
\end{proof}

\begin{definition}\label{D:nulprostor}
Je-li $\bAA$ matice tvaru $m\times n$ s prvky z tìlesa $\TT$, pak podprostor $\NNN(\bAA)$ prostoru $\TTT^n$ nazýváme \emph{(pravý) nulový prostor} matice $\bAA$. Podprostor $\MMM(\bAA)$ prostoru $\TTT^m$ nazýváme 
\emph{levý nulový prostor} matice $\bAA$.
\end{definition}

Následující cvièení je snadným dùsledkem poslední èásti Vìty~\ref{T:homo}.

\begin{cviceni}\label{C:nuloveprostory}
Je-li $\bAA$ matice tvaru $m\times n$ s prvky z tìlesa $\TT$, pak platí
\begin{itemize}
	\item $\NNN(\bAA)=\{\nul\}$ právì kdy¾ pro hodnost matice $\bAA$ platí $r(\bAA)=n$,
	\item $\MMM(\bAA)=\{\nul\}$ právì kdy¾ pro hodnost matice $\bAA$ platí $r(\bAA)=m$.
\end{itemize}
\end{cviceni}


\chapter{Lineární (ne)závislost}

Také tuto kapitolu zahájíme základní definicí.

\begin{definition}\label{D:linnezavislost}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Øíkáme, ¾e posloupnost vektorù $\vex_1,\vex_2,\dots,\vex_n$ prostoru $\VVV$ je \emph{lineárnì nezávislá,} jestli¾e z rovnosti
\[
a_1\vex_1+a_2\vex_2+\cdots +a_n\vex_n=\nul
\]
plyne, ¾e $a_1=a_2=\cdots=a_n=0$. V opaèném pøípadì øíkáme, ¾e posloupnost $\vex_1,\vex_2,\dots,\vex_n$ je \emph{lineárnì závislá}.
\end{definition}

Je dùle¾ité uvìdomit si explicitnì, co znamená, ¾e posloupnost vektorù $\vex_1,\vex_2,\dots,\vex_n\in\VVV$ není lineárnì nezávislá, tj. ¾e je lineárnì závislá. Znamená to, ¾e existují skaláry $a_1,a_2,\dots,a_n\in\TT$, z nich¾ aspoò jeden je nenulový, a pro které platí 
\[
a_1\vex_1+a_2\vex_2+\cdots +a_n\vex_n=\nul.
\] 

\begin{uloha}\label{U:regmatice}
Doka¾te, ¾e pro ka¾dou regulární matici $\PP$ øádu $n$ s prvky z tìlesa $\TT$ je posloupnost sloupcových vektorù 
\[
\PP_{*1},\PP_{*2},\dots,\PP_{*n}
\] 
lineárnì nezávislá v aritmetickém $n$-dimenzionálním prostoru $\TTT^n$.
\end{uloha}

\begin{reseni}
Jsou-li $a_1,a_2,\dots,a_n\in\TT$ libovolné skaláry, pro které platí
\[
a_1\PP_{*1}+a_2\PP_{*2}+\cdots+a_n\PP_{*n}=\nul,
\]
oznaèíme $\vea=(a_1,a_2,\dots,a_n)^T$ sloupcový vektor tìchto skalárù. Tento vektor je øe¹ením homogenní soustavy rovnic
$\PP\vex=\nul$. Proto¾e matice $\PP$ této soustavy je regulární, má soustava pouze nulové øe¹ení podle Vìty~\ref{T:homo}. Proto $a_1=a_2=\cdots=a_n=0$.
\end{reseni}

\begin{cviceni}
Je posloupnost vektorù $\ee_1=(1,0,0)^T,\ee_2=(0,1,0)^T,\ee_3=(0,0,1)^T\in\RRR^3$ lineárnì závislá nebo nezávislá? Mù¾e se na tomto faktu zmìnit nìco tím, ¾e pova¾ujeme posloupnost $\ee_1,\ee_2,\ee_3$ za posloupnost vektorù z aritmetického prostoru $\TTT^3$ nad libovolným tìlesem $\TT$? Prozkoumejte lineární závislost nebo nezávislost nìkolika dal¹ích posloupností vektorù z $\RRR^3$. Mù¾e být nìjaká posloupnost ètyø vektorù z $\RRR^3$ lineárnì nezávislá?
\end{cviceni}

\begin{cviceni}\label{C:nezradky}
Doka¾te, ¾e pro ka¾dou regulární matici $\PP$ øádu $n$ s prvky z tìlesa $\TT$ je posloupnost øádkových vektorù 
\[
\PP_{1*},\PP_{2*},\dots,\PP_{n*}
\]
lineárnì nezávislá.
\end{cviceni}

Také následující cvièení je jednoduché a plyne bezprostøednì z definice.

\begin{cviceni}\label{C:triviality}
Doka¾te, ¾e posloupnost vektorù $\vex_1,\vex_2,\dots,\vex_n\in\VVV$ je lineárnì závislá, pokud
\begin{itemize}
	\item obsahuje nìjaký nulový vektor $\vex_i=\nul$,
	\item obsahuje dva stejné vektory $\vex_i=\vex_j$ pro $i\ne j$.
\end{itemize}
Jaké koeficienty $a_1,a_2,\dots,a_n$ staèí zvolit v obou pøípadech?
\end{cviceni}

Druhé tvrzení v posledním cvièení øíká, ¾e v lineárnì nezávislé posloupnosti vektorù jsou v¹echny prvky navzájem rùzné. 
Proto¾e sèítání vektorù ve vektorovém prostoru je komutativní, plyne z lineární nezávislosti posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ lineární nezávislost jakékoliv posloupnosti $\vex_{i_1},\vex_{i_2},\dots$, $\vex_{i_n}$, kterou dostaneme z posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ pøeházením poøadí jejich prvkù. Jinak øeèeno, indexy $i_1,i_2,\dots,i_n$ jsou navzájem rùzné prvky mno¾iny $\{1,2,\dots,n\}$. To znamená, ¾e lineární nezávislost posloupnosti $\vex_1,\vex_2,\dots$, $\vex_n\in\VVV$ závisí pouze na prvcích této posloupnosti, nikoliv na jejich poøadí. To vede k následující definici.

\begin{definition}\label{D:linnezsets}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Mno¾ina $\{\vex_1,\vex_2,\dots,\vex_n\}\subseteq\VVV$ je \emph{lineárnì nezávislá,} jestli¾e z rovnosti
\[
\sum_{i=1}^n a_i\vex_i=\nul
\]
plyne $a_1=a_2=\dots=a_n=0$. Øíkáme, ¾e mno¾ina $\{\vex_1,\vex_2,\dots,\vex_n\}$ je \emph{lineárnì závislá,} pokud není lineárnì nezávislá. Nekoneèná mno¾ina $X\subseteq\VVV$ je \emph{lineárnì nezávislá,} je-li ka¾dá její koneèná podmno¾ina lineárnì nezávislá. V opaèném pøípadì je \emph{lineárnì závislá}.
\end{definition}

\begin{cviceni}
Najdìte nìjakou nekoneènou lineárnì nezávislou podmno¾inu prostoru v¹ech polynomù s reálnými koeficienty. Najdìte nìjakou nekoneènou lineárnì nezávislou podmno¾inu prostoru v¹ech spojitých reálných funkcí definovaných na intervalu $[0,1]$. Mù¾ete najít nekoneènou lineárnì nezávislou podmno¾inu v prostoru v¹ech diferencovatelných funkcí na intervalu $[0,1]$?
\end{cviceni}

\begin{uloha}\label{U:linnezposl}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Doka¾te, ¾e platí
\begin{itemize}
	\item je-li $\vex_1,\vex_2,\dots,\vex_n$ lineárnì nezávislá posloupnost vektorù z $\VVV$ a $1\leq j_1<j_2<\cdots<j_k\leq n$, pak podposloupnost $\vex_{j_1},\vex_{j_2},\dots,\vex_{j_k}$ posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ je také lineárnì nezávislá,
	\item je-li naopak $\vex_{j_1},\vex_{j_2},\dots,\vex_{j_k}$ lineárnì závislá podposloupnost posloupnosti $\vex_1,\vex_2,\dots,\vex_n$, pak je také posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì závislá,
	\item je-li $\vex_1,\vex_2,\dots,\vex_n$ lineárnì nezávislá posloupnost a $\vey\in\VVV$, pak posloupnost $\vex_1,\vex_2,\dots,\vex_n,\vey$ je lineárnì závislá právì kdy¾ platí $\vey\in\LLL(\vex_1,\vex_2,\dots,\vex_n)$. 
\end{itemize}
\end{uloha}

\begin{reseni}
Pokud jde o první tvrzení, je-li 
\[
a_{j_1}\vex_{j_1}+a_{j_2}\vex_{j_2}+\cdots+a_{j_k}\vex_{j_k}=\nul,
\]
polo¾íme $a_i=0$ pro $i\ne j_1,j_2,\dots,j_k$. Potom platí také
\[
a_1\vex_1+a_2\vex_2+\cdots+a_n\vex_n=\nul.
\]
Z lineární nezávislosti posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ plyne $a_1=a_2=\cdots=a_n=0$, speciálnì tedy také $a_{j_1}=a_{j_2}=\cdots=a_{j_k}=0$.

Druhé tvrzení plyne bezprostøednì z prvního.

Tøetí tvrzení vy¾aduje dokázat dvì implikace. Pokud je posloupnost $\vex_1,\vex_2,\dots,\vex_n,\vey$ lineárnì závislá, existují prvky $a_1,a_2,\dots,a_n,b\in\TT$, které nejsou v¹echny rovné $0$, a pro které platí
\[
a_1\vex_1+a_2\vex_2+\cdots+a_n\vex_n+b\vey=\nul.
\]
Proto¾e posloupnost $\vex_1,\vex_2,\dots,\vex_n$ je lineárnì nezávislá, musí být $b\ne 0$. Vektor $\vey$ tak mù¾eme vyjádøit jako lineární kombinaci vektorù $\vex_1,\vex_2,\dots,\vex_n$:
\[
\vey=(-a_1/b)\vex_1-(a_2/b)\vex_2-\cdots-(a_n/b)\vex_n.
\]
Podle Dùsledku~\ref{C:linobal} platí, ¾e $\vey\in\LLL(\vex_1,\vex_2,\dots,\vex_n)$.

Je-li naopak $\vey\in\LLL(\vex_1,\vex_2,\dots,\vex_n)$, existují podle stejného Dùsledku~\ref{C:linobal} skaláry $b_1,b_2,\dots,b_n\in\TT$, pro které platí
\[
\vey=b_1\vex_1+b_2\vex_2+\cdots+b_n\vex_n.
\] 
Potom ale
\[
b_1\vex_1+b_2\vex_2+\cdots+b_n\vex_n+(-1)\vey=\nul.
\]
Proto¾e v této lineární kombinaci nejsou v¹echny koeficienty rovné $0$, je posloupnost $\vex_1,\vex_2,\dots,\vex_n,\vey$ lineárnì závislá.
\end{reseni}

Zcela stejnì doká¾eme podobné vlastnosti lineární (ne)závislosti mno¾in.

\begin{cviceni}\label{C:linnezsubsets}
Doka¾te, ¾e ve vektorovém prostoru $\VVV$ nad tìlesem $\TT$ platí
\begin{itemize}
	\item podmno¾ina lineárnì nezávislé mno¾iny $X\subseteq\VVV$ je lineárnì nezávislá,
	\item je-li $Y\subseteq X\subseteq\VVV$ a $Y$ je lineárnì závislá mno¾ina, pak také $X$ je lineárnì závislá,
	\item je-li $X\subseteq\VVV$ lineárnì nezávislá mno¾ina a $\vey\in\VVV\setminus X$, pak je mno¾ina $X\cup\{\vey\}$ lineárnì nezávislá právì kdy¾ $\vey\not\in\LLL(X)$.
\end{itemize}
V¹imnìte si, ¾e nikde nepøedpokládáme, ¾e mno¾iny $X,Y$ jsou koneèné.	 
\end{cviceni}

Pro porozumìní následujícího tvrzení je dobré si znovu pøipomenout Definici~\ref{D:linzavislost}.

\begin{proposition}\label{T:linnezseq}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$ a $\vex_1,\vex_2,\dots,\vex_n\in\VVV$ jsou libovolné vektory. Následující tvrzení jsou ekvivalentní
\begin{enumerate}
	\item posloupnost $\vex_1,\vex_2,\dots,\vex_n$ je lineárnì závislá,
	\item existuje vektor $\vex_j$, $j\in\{1,2,\dots,n\}$, který lze vyjádøit jako lineární kombinaci vektorù $\vex_i$, $i\ne j$,
	\item existuje vektor $\vex_k$, $k\in\{1,2,\dots,n\}$, který lze vyjádøit jako lineární kombinaci vektorù $\vex_i$, $i<k$.
\end{enumerate}
\end{proposition}

\begin{proof}
$1\Rightarrow 2$. Je-li posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì závislá, existují skaláry $a_1,a_2,\dots,a_n\in\TT$, pro které platí
\[
a_1\vex_1+a_2\vex_2+\cdots +a_n\vex_n=\nul,
\]
a aspoò jeden z nich je rùzný od $0$. Nech» je to skalár $a_j$. Potom
\[
\vex_j=\sum_{i\ne j}(-a_i/a_j)\vex_i,
\] 
co¾ dokazuje, ¾e $\vex_j$ je lineární kombinací vektorù $\vex_i$, $i\ne j$.

$2\Rightarrow 3$. Je-li vektor $\vex_j$ lineární kombinací vektorù $\vex_i$, $i\ne j$, existují skaláry $b_i$, $i\ne j$, pro které platí
\[
\vex_j=\sum_{i\ne j}b_i\vex_i.
\]
Oznaèíme-li $b_j=-1$, dostaneme rovnost
\[
b_1\vex_1+b_2\vex_2+\cdots+b_n\vex_n=\nul.
\]
Je-li $k$ nejvìt¹í index takový, ¾e $b_k\ne 0$, potom
\[
\vex_k=(-b_1/b_k)\vex_1+(-b_2/b_k)\vex_2+\cdots+(-b_{k-1}/b_k)\vex_{k-1}.
\]
Aspoò jeden takový index $k$ existuje, nebo» $b_j=-1$. Vektor $\vex_k$ je tak lineární kombinací vektorù $\vex_i$ pro $i<k$.

$3\Rightarrow 1$. Pokud je vektor $\vex_k$ lineární kombinací vektorù $\vex_i$, $i<k$, existují skaláry $c_1,\dots,c_{k-1}$, pro které platí
\[
\vex_k=c_1\vex_1+\cdots c_{k-1}\vex_{k-1}.
\]
Potom 
\[
c_1\vex_1+c_2\vex_2+\cdots+c_{k-1}\vex_{k-1}+(-1)\vex_k+0\vex_{k+1}+\cdots+0\vex_n,
\]
proto je posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì závislá.
\end{proof}

Následující tvrzení bývá èasto nazýváno {\bf Steinitzova vìta o výmìnì.}

\begin{proposition}\label{T:Steinitz}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$ a $\vex_1,\vex_2,\dots,\vex_n\in\VVV$ je lineárnì nezávislá posloupnost vektorù. Je-li $\nul\ne\vey\in\LLL(\vex_1,\vex_2,\dots,\vex_n)$, pak existuje vektor $\vex_k$ pro nìjaké $k\in\{1,2,\dots,n\}$ takový, ¾e posloupnost
\[
\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n
\]
je lineárnì nezávislá a
\[
\LLL(\vex_1,\vex_2,\dots,\vex_n)=\LLL(\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n).
\]
\end{proposition}

\begin{proof}
Podle Tvrzení~\ref{T:linnezseq} je posloupnost vektorù
\[
\vey,\vex_1,\dots,\vex_n
\]
lineárnì závislá, nebo» jeden její prvek -- vektor $\vey$ -- je lineární kombinací ostatních vektorù v posloupnosti, vektorù $\vex_1,\dots,\vex_n$. Podle tého¾ Tvrzení~\ref{T:linnezseq} existuje vektor této posloupnosti, který je lineárnì závislý na pøedchozích vektorech. Kvùli pøedpokladu $\vey\ne\nul$ to nemù¾e být vektor $\vey$. Je to tedy nìjaký vektor $\vex_k$ pro $k\in\{1,2,\dots,n\}$. Platí proto
\[
\vex_k=a_0\vey+\sum_{i=1}^{k-1}a_i\vex_i
\]
pro nìjaké skaláry $a_0,a_1,\dots,a_{k-1}\in\TT$. Posloupnost $\vex_1,\vex_2,\dots,\vex_n$ je lineárnì nezávislá, proto podle tého¾ Tvrzení~\ref{T:linnezseq} vektor $\vex_k$ {\bf není} lineární kombinací vektorù $\vex_1,\dots,\vex_{k-1}$. Proto musí být $a_0\ne 0$. Z poslední rovnosti proto mù¾eme vyjádøit
\[
\vey=\sum_{i=1}^{k-1}(-a_ia_0^{-1})\vex_i+a_0^{-1}\vex_k.
\]

Abychom dokázali, ¾e posloupnost $\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n$ je lineárnì nezávislá, uva¾ujeme libovolné skaláry $b_0,b_1,\dots,b_{k-1},b_{k+1},\dots,b_n$, pro které platí
\[
b_0\vey+\sum_{j\ne k}b_j\vex_j=\nul.
\]
Za vektor $\vey$ dosadíme pøedchozí vyjádøení a dostaneme
\[
\sum_{i=1}^{k-1}(-b_0a_ia_0^{-1})\vex_i+b_0a_0^{-1}\vex_k+\sum_{j\ne k}b_j\vex_j=\nul, 
\]
tj.
\[
\sum_{i=1}^{k-1}(-b_0a_ia_0^{-1}+b_i)\vex_i+b_0a_0^{-1}\vex_k+\sum_{j=k+1}^nb_j\vex_j=\nul.
\]
Z lineární nezávislosti posloupnosti $\vex_1,\dots,\vex_n$ vyplývá, ¾e platí $b_0=b_{k+1}=\cdots=b_n=0$ a po dosazení za $b_0$ do koeficientù u $\vex_1,\dots,\vex_{k-1}$ rovnì¾ $b_1=\cdots=b_{k-1}=0$. Tím je dokázáno, ¾e také posloupnost $\vey,\vex_1,\dots,\vex_{k-1}$, $\vex_{k+1},\dots,\vex_n$ je lineárnì nezávislá.

Zbývá dokázat rovnost
\[
\LLL(\vex_1,\vex_2,\dots,\vex_n)=\LLL(\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n).
\]
Proto¾e $\vey$ je lineární kombinací vektorù $\vex_1,\dots,\vex_n$, platí
\[
\{\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n\}\subseteq\LLL(\vex_1,\vex_2,\dots,\vex_n),
\]
a proto také
\[
\LLL(\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n)\subseteq\LLL(\vex_1,\vex_2,\dots,\vex_n).
\]
Opaènou inkluzi doká¾eme zcela stejnì. Proto¾e
\[
\vex_k=a_0\vey+\sum_{i=1}^{k-1}a_i\vex_i,
\]
platí
\[
\{\vex_1,\vex_2,\dots,\vex_n\}\subseteq\LLL(\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n) 
\]
a proto také
\[
\LLL(\vex_1,\vex_2,\dots,\vex_n)\subseteq\LLL(\vey,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n).
\]
\end{proof}

\begin{corollary}\label{C:Steinitz}
Je-li $X\subseteq\VVV$ koneèná a lineárnì nezávislá, a $\nul\ne\vey\in\LLL(X)$, pak existuje vektor $\vex\in X$, pro který platí, ¾e mno¾ina $(X\setminus\{\vex\})\cup\{\vey\}$ je také lineárnì nezávislá a 
\[
\LLL(X)=\LLL((X\setminus\{\vex\})\cup\{\vey\}).
\]
\end{corollary}

Steinitzovu vìtu o výmìnì budeme pou¾ívat pro zkoumání vztahù mezi rùznými lineárnì nezávislými posloupnostmi a mno¾inami ve vektorových prostorech. 
\begin{definition}\label{D:baze}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor nad tìlesem $\TT$. Posloupnost $\vex_1,\dots,\vex_n\in\VVV$ se nazývá \emph{báze} prostoru $\VVV$, je-li lineárnì nezávislá a souèasnì $\LLL(\vex_1,\dots,\vex_n)=\VVV$. Prostor $\VVV$ se nazývá \emph{koneènì-dimenzionální,} pokud v nìm existuje koneèná báze. 

Nekoneèná mno¾ina $X\subseteq\VVV$ se nazývá \emph{báze} prostoru $\VVV$, je-li lineárnì nezávislá a souèasnì generuje celý prostor $\VVV$, tj. $\LLL(X)=\VVV$.
\end{definition}

\begin{cviceni}\label{P:baze}
Doka¾te, ¾e posloupnost vektorù $\ee_1,\ee_2,\dots,\ee_n\in\TTT^n$, kde vektor $\ee_i$ má v¹echny souøadnice $0$ s výjimkou $i$-té souøadnice, která se rovná $1$, je báze v prostoru $\TTT^n$. Této bázi se øíká \emph{standardní báze} v $\TTT^n$. 

Najdìte nìjakou bázi v prostoru $\RR[x]$ reálných polynomù jedné promìnné. Najdìte nìjakou bázi v prostoru $\RR_{\leq n}[x]$. Kolik má prvkù? 

Existuje báze v nulovém prostoru $\NNN=\{\nul\}$?

Umìli byste najít nìjakou bázi v prostoru v¹ech reálných funkcí definovaných na intervalu $[0,1]$?
\end{cviceni}

Lineární algebra se zabývá pøedev¹ím koneènì-dimenzionálními vektorovými prostory. Nekoneènì-dimenzionální prostory jsou zkoumány ve \emph{funkcionální analýze}. Proto budeme v následujícím textu prakticky v¾dy pøedpokládat, ¾e $\VVV$ je koneènì-dimenzionální vektorový prostor nad nìjakým tìlesem $\TT$.

\begin{proposition}\label{T:stejnebaze}
Pøedpokládáme, ¾e $\VVV$ je koneènì-dimenzionální vektorový prostor nad tìlesem $\TT$ a $\vex_1,\vex_2,\dots,\vex_n$ je nìjaká báze ve $\VVV$. Jestli¾e je posloupnost $\vey_1,\vey_2,\dots,\vey_m$ lineárnì nezávislá ve $\VVV$, pak $m\leq n$, a pokud $m<n$, pak mù¾eme roz¹íøit posloupnost $\vey_1,\vey_2,\dots,\vey_m$ do báze pøipojením nìjakých prvkù báze $\vex_1,\vex_2,\dots,\vex_n$.

Libovolné dvì báze v prostoru $\VVV$ mají stejný poèet prvkù.
\end{proposition}

\begin{proof}
Obì posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ a $\vey_1,\vey_2,\dots,\vey_m$ jsou lineárnì nezávislé. Naproti tomu  posloupnost 
\[
\vey_m,\vex_1,\vex_2,\dots,\vex_n
\]
je lineárnì závislá podle Tvrzení~\ref{T:linnezseq}, proto¾e $\vey_m\in\LLL(\vex_1,\vex_2,\dots,\vex_n)$. V této posloupnosti tedy existuje nìjaký vektor, který je lineární kombinací pøedcházejících vektorù. Proto¾e je $\vey_m\ne\nul$ (nebo» $\vey_1,\vey_2,\dots,\vey_m$ je lineárnì nezávislá posloupnost a nemù¾e proto obsahovat vektor $\nul$), existuje podle Steinitzovy vìty o výmìnì, tj. podle Tvrzení~\ref{T:Steinitz}, vektor $\vex_k$ takový, ¾e posloupnost
\[
\vey_m,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n
\]
je lineárnì nezávislá a 
\[
\LLL(\vey_m,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n)=\LLL(\vex_1,\vex_2,\dots,\vex_n)=\VVV.
\]
Posloupnost $\vey_m,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n$ je tedy rovnì¾ báze prostoru $\VVV$ a mù¾eme celý postup znovu opakovat s posloupností
\[
\vey_{m-1},\vey_m,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n.
\]
Tato posloupnost je opìt lineárnì závislá, nebo» 
\[
\vey_{m-1}\in\LLL(\vey_m,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n)=\VVV.
\]
Existuje v ní proto vektor, který je lineární kombinací pøedchozích vektorù. Nemù¾e to být ¾ádný z vektorù $\vey_{m-1}$ a $\vey_m$, proto¾e posloupnost $\vey_{m-1},\vey_m$ je lineárnì nezávislá coby podposloupnost lineárnì nezávislé posloupnosti $\vey_1,\vey_2,\dots,\vey_m$. Musí to tedy být jeden z vektorù $\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n$. Ten mù¾eme v bázi $\vey_m,\vex_1,\dots,\vex_{k-1},\vex_{k+1},\dots,\vex_n$ nahradit vektorem $\vey_{m-1}$ a dostaneme tak novou bázi, její¾ první dva prvky jsou $\vey_{m-1},\vey_m$ a zbývajících $n-2$ prvkù pochází z vektorù $\vex_1,\dots,\vex_n$.

Opakujeme tento postup v¾dy tak, ¾e pøed bázi získanou v pøedchozím kroku pøipí¹eme dal¹í vektor $\vey_i$. Formální dùkaz bychom udìlali indukcí podle $m$. 

Nemù¾eme døíve vyèerpat posloupnost $\vex_1,\dots,\vex_n$ ne¾ vyèerpáme posloupnost $\vey_1,\dots,\vey_m$. Kdyby toti¾ bylo $m>n$, dostali bychom po $n$ krocích pøedchozího postupu bázi $\vey_{m-n+1},\dots,\vey_m$ a vektor $\vey_1$ by tak byl lineární kombinací vektorù $\vey_{m-n+1},\dots,\vey_m$, co¾ je spor s lineární nezávislostí posloupnosti $\vey_1,\dots,\vey_m$. Tím je dokázáno, ¾e $m\leq n$, a pokud $m<n$, tak potom dostaneme po $m$ krocích pøedchozího dùkazu bázi
\[
\vey_1,\dots,\vey_m,\vex_{i_1},\dots,\vex_{i_{n-m}}.
\]

Jsou-li $\vey_1,\dots,\vey_m$ a $\vex_1,\dots,\vex_n$ dvì báze prostoru $\VVV$, pak je podle pøedchozího odstavce $m\leq n$, nebo» posloupnost $\vey_1,\dots,\vey_m$ je lineárnì nezávislá. Ze stejného dùvodu (také posloupnost $\vex_1,\dots,\vex_n$ je lineárnì nezávislá) platí rovnì¾ $n\leq m$. Tím je rovnost $m=n$ dokázána.
\end{proof}

Poslední tvrzení ospravedlòuje následující definici.
\begin{definition}\label{D:dimenze}
Je-li $\VVV$ koneènì-dimenzionální vektorový prostor nad tìlesem $\TT$, pak poèet prvkù libovolné báze prostoru $\VVV$ nazýváme \emph{dimenze} prostoru $\VVV$ a oznaèujeme jej $\dim\,\VVV$.
\end{definition}

\begin{cviceni}
Jaká je dimenze aritmetického vektorového prostoru $\TTT^n$ nad tìlesem $\TT$?

Jaká je dimenze nulového prostoru $\NNN=\{\nul\}$?

Jaká je dimenze prostoru reálných polynomù $\RR_{\leq n}[x]$ stupnì nejvý¹e $n$?

Má prostor v¹ech reálných polynomù jedné promìnné $\RR[x]$ koneènou dimenzi? Pokud ano, èemu se rovná?
\end{cviceni}

Nejdøíve si doká¾eme nìkolik jednoduchých vlastností vektorových prostorù dimenze $n$.

\begin{proposition}\label{T:obazich}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor dimenze $n$ nad tìlesem $\TT$. Potom
\begin{itemize}
	\item ka¾dá lineárnì nezávislá posloupnost $\vex_1,\dots,\vex_n$ prvkù $\VVV$ je báze prostoru $\VVV$,
	\item ka¾dá posloupnost $\vey_1,\dots,\vey_n$ prvkù $\VVV$, pro kterou platí $\LLL(\vey_1,\dots,\vey_n)=\VVV$, je báze $\VVV$.
\end{itemize}
\end{proposition}

\begin{proof}
První tvrzení doká¾eme tím, ¾e uká¾eme platnost rovnosti mno¾in $\LLL(\vex_1,\dots,\vex_n)=\VVV$. Urèitì platí $\LLL(\vex_1,\dots,\vex_n)\subseteq\VVV$. Kdyby byly mno¾iny $\LLL(\vex_1,\dots,\vex_n)$ a $\VVV$ rùzné, vzali bychom libovolný vektor $\vez\in\VVV\setminus\LLL(\vex_1,\dots,\vex_n)$. Podle tøetí èásti Úlohy~\ref{U:linnezposl} je posloupnost
$\vex_1,\dots,\vex_n,\vez$ lineárnì nezávislá. To je ve sporu s Tvrzením~\ref{T:stejnebaze}, které øíká, ¾e ka¾dá lineárnì nezávislá posloupnost v prostoru dimenze $n$ má nejvý¹e $n$ prvkù. Proto platí rovnost $\LLL(\vex_1,\dots,\vex_n)=\VVV$.

Abychom dokázali druhou èást tvrzení, musíme ukázat, ¾e posloupnost $\vey_1,\dots,\vey_n$ je lineárnì nezávislá. Opìt budeme pokraèovat sporem. Kdyby byla lineárnì závislá, existoval by podle Tvrzení~\ref{T:linnezseq} vektor $\vey_k$, který lze vyjádøit jako lineární kombinaci vektorù $\vey_1,\dots,\vey_{k-1}$. Potom platí
\[
\LLL(\vey_1,\vey_2,\dots,\vey_n)=\LLL(\vey_1,\dots,\vey_{k-1},\vey_{k+1},\dots,\vey_n).
\] 
Inkluze $\LLL(\vey_1,\dots,\vey_{k-1},\vey_{k+1},\dots,\vey_n)\subseteq\LLL(\vey_1,\vey_2,\dots,\vey_n)$ je zøejmá. Opaèná inkluze plyne z toho, ¾e $\{\vey_1,\vey_2,\dots,\vey_n\}\subseteq\LLL(\vey_1,\dots,\vey_{k-1},\vey_{k+1},\dots,\vey_n)$. Kdyby byla posloupnost
$\vey_1,\dots,\vey_{k-1},\vey_{k+1},\dots,\vey_n$ lineárnì nezávislá, byla by bází prostoru $\VVV$, která by mìla ménì ne¾ $n$ prvkù, co¾ je spor s Tvrzením~\ref{T:stejnebaze}.

Zbývá mo¾nost, ¾e ani posloupnost $\vey_1,\dots,\vey_{k-1},\vey_{k+1},\dots,\vey_n$ není lineárnì nezávislá. Potom mù¾eme celý postup opakovat. Najdeme vektor $\vey_j$, který je lineární kombinací pøedcházejících vektorù. Ten mù¾eme z posloupnosti vyhodit a zbylá posloupnost bude stále generovat celý prostor $\VVV$. Je-li navíc lineárnì nezávislá, je to báze prostoru $\VVV$, která má $n-2$ prvkù, opìt spor s druhou èástí Tvrzení~\ref{T:stejnebaze}. Pokud je lineárnì závislá, celý postup znovu opakujeme.

Po nìkolika krocích nakonec dostaneme lineárnì nezávislou podposloupnost posloupnosti $\vey_1,\vey_2,\dots,\vey_n$, která má ménì ne¾ $n$ prvkù a stále je¹tì generuje celý prostor $\VVV$. To je znovu spor s Tvrzením~\ref{T:stejnebaze}. To, ¾e postupným vy¹krtáváním vektorù z posloupnosti $\vey_1,\vey_2,\dots,\vey_n$ musíme nakonec dostat nìjakou lineárnì nezávislou posloupnost, vyplývá z toho, ¾e prázdná posloupnost je lineárnì nezávislá.   
\end{proof}

Následující vìta je intuitivnì zøejmá, je ale nutné ji dokázat.

\begin{theorem}\label{V:dimpodprostoru}
Pøedpokládáme, ¾e $\VVV$ je vektorový prostor dimenze $n$ nad tìlesem $\TT$ a $\UUU\subseteq\VVV$ je podprostor prostoru $\VVV$. Potom je prostor $\UUU$ také koneènì-dimenzionální a $\dim\,\UUU\leq\dim\,\VVV$.
\end{theorem}

\begin{proof}
Je-li $\UUU=\{\nul\}$, potom prázdná mno¾ina $\emptyset$ je báze $\UUU$ a $\dim\,\UUU=0\leq\dim\,\VVV$. Pokud je $\UUU\ne\{\nul\}$, existuje nenulový vektor $\vey_1\in\UUU$. Posloupnost $\vey_1$ je lineárnì nezávislá a pokud je $\LLL(\vey_1)=\UUU$, je to báze podprostoru $\UUU$. Proto $\dim\,\UUU=1\leq\dim\,\VVV$ podle Tvrzení~\ref{T:stejnebaze}, nebo» posloupnost $\vey_1$ je lineárnì nezávislá také v prostoru $\VVV$.

Pokud je $\LLL(\vey_1)\ne\UUU$, existuje vektor $\vey_2\in\UUU\setminus\LLL(\vey_1)$. Posloupnost $\vey_1,\vey_2$ je lineárnì nezávislá jak v $\UUU$ tak i v celém prostoru $\VVV$ podle Tvrzení~\ref{T:linnezseq}. Je-li $\LLL(\vey_1,\vey_2)=\UUU$, je to báze $\UUU$ a $\dim\,\UUU=2\leq\dim\,\VVV$ podle Tvrzení~\ref{T:stejnebaze}.

Je-li $\LLL(\vey_1,\vey_2)\ne\UUU$, existuje vektor $\vey_2\in\UUU\setminus\LLL(\vey_1,\vey_2)$, atd. Pokud jsme ji¾  pro nìjaké $k\leq\dim\,\VVV=n$ sestrojili lineárnì nezávislou posloupnost $\vey_1,\dots,\vey_k$ prvkù podprostoru $\UUU$ a stále $\LL(\vey_1,\dots,\vey_k)\ne\UUU$, vezmeme libovolný vektor $\vey_{k+1}\in\UUU\setminus\LL(\vey_1,\dots,\vey_k)$. Posloupnost $\vey_1,\dots,\vey_k,\vey_{k+1}$ je potom opìt lineárnì nezávislá podle Tvrzení~\ref{T:linnezseq}. Proto rovnì¾ $k+1\leq\dim\,\VVV=n$ podle Tvrzení~\ref{T:stejnebaze}.

Proto musí existovat $k\leq n$, pro které platí $\LLL(\vey_1,\dots,\vey_k)=\UUU$. V takovém pøípadì je $\vey_1,\dots,\vey_k$ báze prostoru $\UUU$, prostor $\UUU$ koneènou dimenzi a platí $\dim\,\UUU\leq\dim\,\VVV$.
\end{proof}

\bigskip
\noindent{\bf Souøadnice vektoru vzhledem k bázi}
\smallskip

Zaèneme jednoduchou úlohou.

\begin{uloha}\label{U:souradnice}
Pøedpokládáme, ¾e $\vex_1,\vex_2,\dots,\vex_n$ je báze vektorového prostoru $\VVV$ nad tìlesem $\TT$. Zvolíme libovolný prvek $\vez\in\VVV$. Jsou-li 
\[
\vez=a_1\vex_1+a_2\vex_2+\cdots+a_n\vex_n
\]
a
\[
\vez=b_1\vex_1+b_2\vex_2+\cdots+b_n\vex_n
\]
dvì vyjádøení vektoru $\vez$ jako lineární kombinace prvkù báze $\vex_1,\dots,\vex_n$, potom $a_i=b_i$ pro ka¾dé $i=1,2,\dots,n$.   
\end{uloha}

\begin{reseni}
Odeèteme-li obì vyjádøení, dostaneme
\[
\nul=(a_1-b_1)\vex_1+(a_2-b_2)\vex_2+\cdots+(a_n-b_n)\vex_n.
\]
Proto¾e je posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì nezávislá, platí $a_i-b_i=0$, tj. $a_i=b_i$, pro ka¾dé $i=1,2,\dots,n$.
\end{reseni}

V dùsledku pøedchozí úlohy jsme oprávnìni pøijmout následující definici.

\begin{definition}\label{D:souradnice}
Je-li $\vex_1,\vex_2,\dots,\vex_n$ báze vektorového prostoru $\VVV$ nad tìlesem $\TT$ a 
\[
\vez=a_1\vex_1+a_2\vex_2+\cdots+a_n\vex_n
\]
vyjádøení vektoru $\vez\in\VVV$ jako lineární kombinace prvkù báze $\vex_1,\vex_2,\dots,\vex_n$, pak vektor
$(a_1,a_2,\dots,a_n)^T$ nazýváme \emph{souøadnice vektoru} $\vez$ \emph{vzhledem k bázi} $\vex_1,\vex_2,\dots,\vex_n$. 
\end{definition}

\begin{cviceni}
Zvolte nìkolik bází v prostoru $\RRR^3$ a najdìte souøadnice nìkolika rùzných vektorù vzhledem k tìmto bázím. Jaké jsou souøadnice vektoru $(1,2,3)^T$ vzhledem ke standardní bázi $\ee_1,\ee_2,\ee_3$? Jaké jsou souøadnice tého¾ vektoru vzhledem k bázi $\ee_2,\ee_1,\ee_3$?
\end{cviceni}

\begin{cviceni}
Pøedpokládáme, ¾e $\vex_1,\vex_2,\dots,\vex_n$ je báze vektorového prostoru $\VVV$ nad tìlesem $\TT$. Jsou-li $(a_1,a_2,\dots,a_n)^T$ souøadnice vektoru $\vey\in\VVV$ vzhledem k bázi $\vex_1,\vex_2,\dots,\vex_n$, pak souøadnice vektoru $k\vey$ vzhledem k té¾e bázi jsou $(ka_1,ka_2,\dots,ka_n)^T$. Pokud jsou dále $(b_1,b_2,\dots,b_n)^T$   souøadnice dal¹ího vektoru $\vez$ vzhledem k bázi $\vex_1,\vex_2,\dots,\vex_n$, pak jsou souøadnice souètu $\vey+\vez$ vzhledem k té¾e bázi rovné $(a_1+b_1,a_2+b_2,\dots,a_n+b_n)^T$. Doka¾te.
\end{cviceni}

\bigskip
\noindent{\bf Elementární transformace posloupnosti vektorù}
\smallskip

Elementární (øádkové i sloupcové) transformace matice zobecníme na libovolné posloupnosti prvkù obecného vektorového prostoru $\VVV$ nad tìlesem $\TT$ pomocí následující definice. 

\begin{definition}\label{D:eltransformace}
Je-li $\vex_1,\vex_2,\dots,\vex_n$ posloupnost prvkù vektorového prostoru $\VVV$ nad tìlesem $\TT$, pak \emph{elementární transformací} této posloupnosti rozumíme jednu z následujících tøí úprav:
\begin{enumerate}
	\item prohození dvou vektorù $\vex_i$ a $\vex_j$,
	\item nahrazení vektoru $\vex_i$ vektorem $c\vex_i$ pro nìjaké $0\ne c\in\TT$,
	\item nahrazení vektoru $\vex_j$ vektorem $\vex_j +c\vex_i$ pro nìjaké $c\in\TT$ a $i\ne j$.
\end{enumerate}
\end{definition}

Stejnì jako v pøípadì elementárních øádkových úprav matice jsou také elementární transformace posloupnosti vektorù \emph{vratné} jak si mù¾ete snadno sami ovìøit. Následující cvièení je o nìco slo¾itìj¹í.

\begin{cviceni}
Doka¾te, ¾e efektu první elementární transformace mù¾eme docílit také vhodnou posloupností elementárních transformací druhého a tøetího typu.
\end{cviceni}

Následující tvrzení je rovnì¾ jednoduchým dùsledkem definic.

\begin{proposition}\label{T:eltransformace}
Pøedpokládáme, ¾e $\vex_1,\vex_2,\dots,\vex_n$ je posloupnost prvkù vektorového prostoru $\VVV$ nad tìlesem $\TT$, a ¾e posloupnost $\vey_1,\vey_2,\dots,\vey_n$ jsme dostali z posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ pomocí posloupnosti elementárních transformací. Potom platí
\begin{itemize}
	\item $\LLL(\vex_1,\vex_2,\dots,\vex_n)=\LLL(\vey_1,\vey_2,\dots,\vey_n)$,
	\item posloupnost $\vex_1,\vex_2,\dots,\vex_n$ je lineárnì nezávislá právì kdy¾ je také posloupnost $\vey_1,\vey_2,\dots,\vey_n$ lineárnì nezávislá,
	\item posloupnost $\vex_1,\vex_2,\dots,\vex_n$ je báze prostoru $\VVV$ právì kdy¾ je posloupnost $\vey_1,\vey_2,\dots,\vey_n$ také báze $\VVV$.
\end{itemize}
\end{proposition}

\begin{proof}
Tvrzení staèí dokázat pouze pro pøípad, ¾e $\vey_1,\vey_2,\dots,\vey_n$ dostaneme z $\vex_1,\vex_2,\dots,\vex_n$  jednou elementární transformací. V tom pøípadì je ka¾dý prvek posloupnosti $\vey_1,\vey_2,\dots,\vey_n$ lineární kombinací nìjakých (nejvý¹e dvou) prvkù posloupnosti $\vex_1,\vex_2,\dots,\vex_n$.
Proto
\[
\{\vey_1,\vey_2,\dots,\vey_n\}\subseteq\LLL(\vex_1,\vex_2,\dots,\vex_n)
\]
a tedy 
\[
\LLL(\vey_1,\vey_2,\dots,\vey_n)\subseteq\LLL(\vex_1,\vex_2,\dots,\vex_n).
\]
Vzhledem k tomu, ¾e ka¾dá elementární transformace je vratná, dostaneme také posloupnost $\vex_1,\vex_2,\dots,\vex_n$ z posloupnosti $\vey_1,\vey_2,\dots,\vey_n$ jednou elementární transformací. Proto platí také opaèná inkluze
\[
\LLL(\vex_1,\vex_2,\dots,\vex_n)\subseteq\LLL(\vey_1,\vey_2,\dots,\vey_n).
\]

Je-li posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì nezávislá a dostaneme-li z ní posloupnost $\vey_1,\vey_2,\dots,\vey_n$ první elementární transformací, obsahují obì posloupnosti stejné prvky a proto je také posloupnost $\vey_1,\vey_2,\dots,\vey_n$ lineárnì nezávislá.

Pokud dostaneme $\vey_1,\vey_2,\dots,\vey_n$ z posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ druhou elementární transformací, platí $\vey_i=c\vex_i$ pro nìjaké $i$ a $0\ne c\in\TT$, a dále $\vey_j=\vex_j$ pro $j\ne i$. Platí-li 
\[
a_1\vey_1+a_2\vey_2+\cdots+a_n\vey_n=\nul,
\]
pak také
\[
(a_ic)\vex_i+\sum_{j\ne i}a_j\vex_j=\nul.
\]
Proto¾e je posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì nezávislá, plyne odtud $a_j=0$ pro $j\ne i$ a dále $ca_i=0$. Vzhledem k tomu, ¾e je $c\ne 0$, platí rovnì¾ $a_i=0$. Posloupnost $\vey_1,\vey_2,\dots,\vey_n$ je tedy lineárnì nezávislá. Vzhledem k tomu, ¾e posloupnost $\vex_1,\vex_2,\dots,\vex_n$ dostaneme z $\vey_1,\vey_2,\dots,\vey_n$ také druhou elementární transformací -- vynásobením vektoru $\vey_i=c\vex_i$ skalárem $c^{-1}\ne 0$ -- plyne z lineární nezávislosti  $\vey_1,\vey_2,\dots,\vey_n$ také lineární nezávislost posloupnosti $\vex_1,\vex_2,\dots,\vex_n$.

Pokud dostaneme $\vey_1,\vey_2,\dots,\vey_n$ z posloupnosti $\vex_1,\vex_2,\dots,\vex_n$ tøetí elementární transformací, platí $\vey_k=\vex_k$ pro v¹echny indexy $k\ne j$ a $\vey_j=\vex_j+c\vex_i$ pro $i\ne j$. Platí-li
\[
\sum_{k=1}^na_k\vey_k=\nul
\] 
pro nìjaké skaláry $a_1,\dots,a_n\in\TT$, dostaneme po dosazení za vektory $\vey_k$ a pøerovnání
\[
\sum_{k\ne j}a_k\vex_k+a_j(\vex_j+c\vex_i)=\nul,
\]
tj. po dal¹ím pøerovnání
\[
\sum_{k\ne i}a_k\vex_k+(a_i+a_jc)\vex_i=\nul.
\]
Proto¾e je posloupnost $\vex_1,\vex_2,\dots,\vex_n$ lineárnì nezávislá, platí $a_k=0$ pro v¹echna $k\ne i$ a rovnì¾ $a_i+a_jc=0$. Proto¾e je $a_j=0$, plyne odtud rovnì¾ $a_i=0$. Posloupnost $\vey_1,\vey_2,\dots,\vey_n$ je proto také lineárnì nezávislá.

Proto¾e dostaneme také $\vex_1,\vex_2,\dots,\vex_n$ z posloupnosti $\vey_1,\vey_2,\dots,\vey_n$ pomocí tøetí elementární transformace -- k prvku $\vey_j=\vex_j+c\vex_i$ pøièteme prvek $-c\vex_i=-c\vey_i$ -- plyne naopak z lineární nezávislosti posloupnosti $\vey_1,\vey_2,\dots,\vey_n$ lineární nezávislost posloupnosti $\vex_1,\vex_2,\dots,\vex_n$.

Tøetí tvrzení plyne bezprostøednì z prvních dvou.
\end{proof}

Dále pou¾ijeme poznatky z této kapitoly pro ujasnìní si nìkterých vlastností matic.

\begin{uloha}\label{U:radkovahodnost}
Doka¾e, ¾e pro ka¾dou matici $\bAA=(a_{ij})$ tvaru $m\times n$ s prvky z tìlesa $\TT$ platí
\begin{itemize}
	\item je-li $\PP$ regulární matice øádu $m$, pak $\RRR(\bAA)=\RRR(\PP\bAA)$,
	\item $r(\bAA)=\dim\,\RRR(\bAA)$.
\end{itemize}
\end{uloha}

\begin{reseni}
Pokud jde o první tvrzení, staèí si uvìdomit, ¾e vynásobit matici $\bAA$ zleva nìjakou regulární maticí $\PP$ øádu $m$  je toté¾ jako ji upravit posloupností elementárních øádkových úprav, jak vyplývá z Tvrzení~\ref{T:elementregular} a poznámek doprovázejících definice jednotlivých elementárních matic. Dále je zøejmé, ¾e posloupnost $[\PP\bAA]_{1*},[\PP\bAA]_{2*},\dots,[\PP\bAA]_{m*}$ øádkových vektorù matice $\PP\bAA$ dostaneme z posloupnosti $\bAA_{1*},\bAA_{2*},\dots,\bAA_{m*}$ øádkových vektorù matice $\bAA$ pomocí elementárních transformací. Podle první èásti pøedchozího Tvrzení~\ref{T:eltransformace} pak platí, ¾e 
\begin{eqnarray*}
\RRR(\bAA)&=&\LLL(\bAA_{1*},\bAA_{2*},\dots,\bAA_{m*})=\\
{}&=&\LLL([\PP\bAA]_{1*},[\PP\bAA]_{2*},\dots,[\PP\bAA]_{m*})=\\
{}&=&\RRR(\PP\bAA).
\end{eqnarray*}

Abychom dokázali druhou èást úlohy, najdeme posloupnost elementárních øádkových úprav matice $\bAA$, která ji pøevede do matice $\UU$ v redukovaném øádkovì odstupòovaném tvaru, neboli regulární matici $\PP$ øádu $m$, takovou, ¾e $\PP\bAA=\UU$. Podle pøedchozího odstavce víme, ¾e $\dim\,\RRR(\bAA)=\dim\,\RRR(\UU)$. Oznaème si indexy bázových sloupcù matice $\UU$ postupnì $1\leq j_1<j_2<\cdots<j_r\leq n$, kde $r=r(\UU)=r(\bAA)$ je hodnost matice $\bAA$. Uká¾eme, ¾e nenulové øádky matice $\UU$ jsou lineárnì nezávislé a tvoøí tak bázi øádkového prostoru $\RRR(\UU)$ matice $\UU$. Nech» je 
\[
c_1\UU_{1*}+c_2\UU_{2*}+\cdots+c_r\UU_{r*}=\nul.
\]
Podíváme se, jak vypadá $j_k$-tá souøadnice lineární kombinace øádkových vektorù na levé stranì poslední rovnosti pro $k=1,2,\dots,r$. Z vektorù $\UU_{1*},\UU_{2*},\dots,\UU_{r*}$ má nenulovou $j_k$-tou souøadnici pouze vektor $\UU_{k*}$ a u nìho se tato souøadnice rovná $1$. Proto je $j_k$-tá souøadnice lineární kombinace na levé stranì poslední rovnosti rovna $c_k$. Z poslední rovnosti tak plyne, ¾e $c_k=0$ pro $k=1,2,\dots,r$. Nenulové øádkové vektory matice $\UU$ jsou tedy lineárnì nezávislé, a proto $\dim\,\RRR(\UU)=r$. Shrneme-li v¹echny rovnosti pro hodnosti a dimenze dokázané v tomto paragrafu, dostáváme
\[
\dim\,\RRR(\bAA)=\dim\,\RRR(\UU)=r=r(\UU)=r(\bAA).
\] 
\end{reseni}

Formule $r(\bAA)=\dim\,\RRR(\bAA)$ z pøedcházející úlohy ukazuje alternativní definici (øádkové) hodnosti matice, která je v uèebnicích lineární algebry pou¾ívána mnohem èastìji ne¾ Definice~\ref{D:rank}. Èastìji pou¾ívaná definice øíká, ¾e \emph{øádková hodnost matice se rovná dimenzi øádkového prostoru této matice.} Pokud vyjdeme z této definice, pak musíme ukázat postup, jak dimenzi øádkového prostoru matice spoèítat. Tento postup spoèívá v tom, ¾e matici pøevedeme  pomocí elementárních øádkových úprav do øádkovì odstupòovaného tvaru, a doká¾eme, ¾e poèet nenulových øádkù v øádkovì odstupòovaném tvaru se rovná dimenzi øádkového prostoru matice. My jsme obvyklý postup pouze obrátili, vy¹li jsme z ``algoritmické" definice hodnosti matice a teprve mnohem pozdìji jsme dokázali, ¾e takto definovaná hodnost matice je vlastnì dimenze øádkového prostoru matice. 

Pro øe¹ení následující úlohy je dobré pøipomenout si Tvrzení~\ref{T:sloupcovevztahy}.

\begin{uloha}\label{U:sloupcovahodnost}
Dostaneme-li matici $\BB$ posloupností elementárních øádkových úprav z matice $\bAA$ tvaru $m\times n$, potom platí
\[
\dim\,\SSS(\bAA)=\dim\,\SSS(\BB).
\]
\end{uloha}

\begin{reseni}
Víme u¾, ¾e platí $\BB=\PP\bAA$ pro nìjakou regulární matici $\PP$ øádu $m$ -- viz Tvrzení~\ref{T:elementregular}. Dále uká¾eme , ¾e jsou-li $1\leq j_1<j_2<\cdots<j_r\leq n$ nìjaké sloupcové indexy, $j\ne j_1,\dots,j_r$, pak 
\[
\bAA_{*j}=\sum_{k=1}^r c_k\bAA_{*j_k}\ \ \ \hbox{\rm právì kdy¾}\ \ \ \BB_{*j}=\sum_{k=1}^r c_k\BB_{*j_k}.
\]
Jinak øeèeno, platí
\[
\bAA_{*j}\in\LLL(\bAA_{*j_1},\bAA_{*j_2},\dots,\bAA_{*j_r})
\]
právì kdy¾ 
\[
\BB_{*j}\in\LLL(\BB_{*j_1},\BB_{*j_2},\dots,\BB_{*j_r}).
\]
Odtud okam¾itì plyne, ¾e posloupnost sloupcových vektorù $\bAA_{*j_1},\bAA_{*j_2},\dots$, $\bAA_{*j_r}$ generuje sloupcový prostor $\SSS(\bAA)$ právì kdy¾ posloupnost $\BB_{*j_1},\BB_{*j_2}$, $\dots,\BB_{*j_r}$ generuje sloupcový prostor $\SSS(\BB)$ matice $\BB$. 

Vyu¾ijeme-li rovnì¾ Tvrzení~\ref{T:linnezseq}, dostaneme také, ¾e posloupnost $\bAA_{*j_1}$, $\bAA_{*j_2},\dots,\bAA_{*j_r}$ je lineárnì nezávislá právì kdy¾ je lineárnì nezávislá posloupnost $\BB_{*j_1},\BB_{*j_2},\dots,\BB_{*j_r}$. Platí proto, ¾e posloupnost $\bAA_{*j_1},\bAA_{*j_2},\dots,\bAA_{*j_r}$ je báze sloupcového prostoru  $\SSS(\bAA)$ matice $\bAA$ právì kdy¾ je posloupnost $\BB_{*j_1},\BB_{*j_2},\dots,\BB_{*j_r}$ báze sloupcového prostoru $\SSS(\BB)$ matice $\BB$. Oba sloupcové prostory $\SSS(\bAA)$ a $\SSS(\BB)$ proto mají stejnou dimenzi.
\end{reseni}

Dimenzi sloupcového prostoru $\SSS(\bAA)$ matice $\bAA$  obvykle nazýváme \emph{sloupcová hodnost} matice $\bAA$. Rovná se (øádkové) hodnosti transponované matice $\bAA^T$. Spojíme-li zji¹tìní posledních dvou úloh, dostaneme následující vìtu, kterou jsme ji¾ dokázali jednou, viz Vìta~\ref{V:rovnosthodnosti}.

\begin{theorem}\label{V:rovnosthodnostib}
Pro ka¾dou matici $\bAA$ tvaru $m\times n$ s prvky z tìlesa $\TT$ platí
\[
\dim\,\RRR(\bAA)=\dim\,\SSS(\bAA).
\]
\end{theorem}

\begin{proof}
Matici $\bAA$ pøevedeme pomocí elementárních øádkových úprav do matice $\UU$, která je v øádkovì odstupòovaném tvaru. To znamená, ¾e najdeme regulární matici $\PP$, pro kterou platí $\PP\bAA=\UU$. Podle pøedchozích dvou úloh platí $\RRR(\bAA)=\RRR(\UU)$, tj. rovnì¾ $\dim\,\RRR(\bAA)=\dim\,\RRR(\UU)$ , a také $\dim\,\SSS(\bAA)=\dim\,\SSS(\UU)$. Staèí proto dokázat, ¾e platí rovnost $\dim\,\RRR(\UU)=\dim\,\SSS(\UU)$. 

Pøi øe¹ení Úlohy~\ref{U:radkovahodnost} jsme ukázali, ¾e nenulové øádky matice $\UU$ tvoøí bázi øádkového prostoru $\RRR(\UU)$ matice $\UU$. Oznaèíme-li $r$ poèet nenulových øádkù matice $\UU$, pak platí $r=\dim\,\RRR(\UU)$.

Jsou-li $\UU_{*j_1},\UU_{*j_2},\dots,\UU_{*j_r}$ bázové sloupce matice $\UU$, pak $\UU_{*j_k}=\ee_k$ pro $k=1,\dots,r$. Bázové sloupce tak tvoøí prvních $r$ vektorù standardní báze aritmetického vektorového prostoru $\TTT^m$. Posloupnost bázových sloupcù je proto lineárné nezávislá. Doká¾eme-li, ¾e bázové sloupce také generují sloupcový prostor $\SSS(\UU)$, dostaneme ¾e platí také $r=\dim\,\SSS(\UU)$.

K tomu staèí ukázat, ¾e ka¾dý sloupcový vektor $\UU_{*j}$ matice $\UU$ je lineární kombinací bázových sloupcù $\UU_{*j_1},\UU_{*j_2},\dots,\UU_{*j_r}$. Proto¾e v matici $\UU$ je pouze prvních $r$ øádkù nenulových, platí
$\UU_{*j}=(c_1,\dots,c_r,0,\dots,0)^T$ pro nìjaké prvky $c_1,\dots,c_r\in\TT$. Potom
\[
\UU_{*j}=\sum_{k=1}^r c_k\ee_k=\sum_{k=1}^r c_k\UU_{*j_k},
\]
a to znamená, ¾e 
\[
\SSS(\UU)=\LLL(\UU_{*1},\UU_{*2},\dots,\UU_{*n})=\LLL(\UU_{*j_1},\UU_{*j_2},\dots,\UU_{*j_r}).
\]
\end{proof}

Je vhodné je¹tì jednou si pøipomenout, jak probíhal druhý dùkaz rovnosti øádkové a sloupcové hodnosti matice. Nejdøíve jsme v Úloze~\ref{U:radkovahodnost} dokázali, ¾e elementární øádkové úpravy nemìní øádkový prostor matice. Potom jsme v Úloze~\ref{U:sloupcovahodnost} ukázali, ¾e elementární øádkové úpravy nemìní dimenzi sloupcového prostoru matice. Snadno si sami najdete pøíklad, ¾e elementární øádkové úpravy mohou zmìnit samotný sloupcový prostor. Nemìní ale jeho dimenzi. A nakonec jsme dokázali, ¾e pro matici v redukovaném øádkovì odstupòovaném tvaru platí rovnost dimenzí øádkového a sloupcového prostoru. Spolu s faktem, ¾e ka¾dou matici mù¾eme pøevést pomocí elementárních øádkových úprav do redukovaného øádkovì odstupòovaného tvaru, to zavr¹ilo dùkaz rovnosti øádkové a sloupcové hodnosti matice. Druhý dùkaz je názornìj¹í ne¾ první dùkaz ve Vìtì~\ref{V:rovnosthodnosti}, který byl zalo¾en pouze na poèítání s maticemi. 

\bigskip
\noindent{\bf Komprimace dat}
\smallskip

Máme-li uchovat velkou matici s malou hodností, mù¾eme vyu¾ít na¹ich znalostí k tomu, abychom podstatnì zmen¹ili objem dat, která musíme uchovávat. Tak napøíklad, máme-li ètvercovou matici øádu $10^3$ a víme-li, ¾e její hodnost je $10^2$, nemusíme uchovávat v¹ech $10^6$ prvkù matice. Staèí uchovat pouze $10^2$ bázových sloupcù a pro ka¾dý ze zbývajících $900$ sloupcových vektorù uchovat pouze $100$ koeficientù lineární kombinace bázových sloupcù, která se danému nebázovému sloupci rovná. Staèí tak ulo¾it pouze $10^2\cdot10^3=10^5$ skalárù z bázových sloupcù a dále $9\cdot10^2\cdot10^2=9\cdot10^4<10^5$ koeficientù lineárních kombinací pro nebázové sloupce. Tímto zpùsobem jsme dokázali sní¾it poèet skalárù, které je nutno uchovávat, na ménì ne¾ jednu pìtinu, ani¾ bychom jakkoliv zmen¹ili obsah ulo¾ené informace.

\bigskip
\noindent{\bf Dùkaz jednoznaènosti redukovaného øádkovì odstupòovaného tva\-ru matice}
\smallskip

Podívejme se blí¾e na posloupnost $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$ sloupcových vektorù matice $\UU$ tvaru $m\times n$, která je v redukovaném øádkovì odstupòovaném tvaru. První bázový sloupec $\UU_{*j_1}$ je první nenulový sloupec matice $\UU$. V posloupnosti sloupcových vektorù $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$ je to tedy první vektor, který není lineární kombinací pøedcházejících vektorù. Podle Definice~\ref{D:RREF} redukovaného øádkovì odstupòovaného tvaru matice je ve vektoru $\UU_{*j_1}$ jediný nenulový prvek èíslo $1$ v prvním øádku, platí tedy $\UU_{*j_1}=\ee_1$, tj. $\UU_{*j_1}$ je první prvek standardní báze prostoru $\TTT^m$. 

Druhý bázový sloupcový vektor $\UU_{*j_2}$ má jediný nenulový prvek èíslo $1$ ve druhém øádku. V¹echny prvky matice $\UU$ le¾ící ve druhém øádku a prvních $j_2-1$ sloupcích matice $\UU$ jsou rovné $0$ podle definice redukovaného øádkovì odstupòovaného tvaru. Sloupcový vektor $\UU_{*j_2}$ proto není lineární kombinací pøedchozích vektorù v posloupnosti $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$. Zcela stejnì doká¾eme, ¾e libovolný bázový sloupcový vektor $\UU_{*j_k}$ pro $k=1,2,\dots,r=r(\UU)$ není lineární kombinací pøedchozích vektorù v posloupnosti $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$. Vektor $\UU_{*j_k}$ obsahuje prvek $1$ v $k$-tém øádku, zatímco v¹echny pøedcházející vektory v posloupnosti $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$ mají v $k$-tém øádku pouze prvky $0$.

Je-li naproti tomu $\UU_{*j}=(c_1,c_2,\dots,c_m)^T$ nìjaký nebázový sloupec matice $\UU$, a dále $\UU_{*j_k}$ pro nìjaké $k=1,2,\dots,r$ je bázový sloupec, který je nejbli¾¹í ke sloupci $\UU_j$ zleva, jsou ve sloupci $\UU_{*j}$ v¹echny prvky pod $k$-tým øádkem rovné $0$. Platí proto $c_{k+1}=\cdots=c_m=0$ a 
\[
\UU_{*j}=\sum_{p=1}^kc_k\UU_{*j_k},
\]
tj. nebázový sloupcový vektor $\UU_{*j}$ je lineární kombinací pøedcházejících bázových vektorù v posloupnosti $\UU_{*1},\UU_{*2},\dots$, $\UU_{*n}$. Dokázali jsme tak, ¾e bázové sloupce v matici $\UU$ jsou právì ty sloupcové vektory v posloupnosti $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$, které nejsou lineární kombinací pøedcházejících sloupcù. Pro nebázové sloupce jsme na¹li konkrétní vyjádøení jako lineární kombinace pøedcházejících bázových sloupcových vektorù.

Je-li nyní $\bAA\in\TTT^{m\times n}$ libovolná matice, pøevedeme ji pomocí elementárních øádkových úprav do matice $\UU$ v øádkovì odstupòovaném tvaru. Podle Tvrzení~\ref{T:sloupcovevztahy} je nìjaký sloupcový vektor $\bAA_{*j}$ lineární kombinací pøedcházejících vektorù v posloupnosti $\bAA_{*1},\bAA_{*2},\dots,\bAA_{*n}$ právì kdy¾ je sloupcový vektor $\UU_{*j}$ lineární kombinací pøedcházejících vektorù v posloupnosti $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$. To znamená, ¾e bázové sloupce v matici $\UU$ jsou jednoznaènì urèené maticí $\bAA$ -- $\UU_{*j}$ je bázový sloupec v matici $\UU$ právì kdy¾ $\UU_{*j}$ není lineární kombinací pøedcházejících vektorù v posloupnosti vektorù $\UU_{*1},\UU_{*2},\dots,\UU_{*n}$, jak jsme dokázali v pøedchozích odstavcích. To je podle Tvrzení~\ref{T:sloupcovevztahy} právì kdy¾ sloupcový vektor $\bAA_{*j}$ není lineární kombinací pøedcházejících vektorù v posloupnosti $\bAA_{*1},\bAA_{*2},\dots,\bAA_{*n}$. 

To ukazuje, ¾e bázové sloupce v matici $\UU$ jsou jednoznaènì urèené maticí $\bAA$. Nech» jsou to sloupce $\UU_{*j_1},\UU_{*j_2},\dots,\UU_{*j_r}$. Bázové sloupce v matici $\UU$ hodnosti $r$, která je v øádkovì odstupòovaném tvaru, se rovnají prvním $r$ prvkùm standardní báze $\ee_1,\ee_2,\dots,\ee_r$ v prostoru $\TTT^m$. Víme tedy, ¾e nejen umístìní, ale i tvar bázových sloupcù v matici $\UU$ jsou jednoznaènì urèené maticí $\bAA$.

Zbývá dokázat jednoznaènost nebázových sloupcových vektorù $\UU_{*j}$. V tom pøípadì je sloupcový vektor $\bAA_{*j}$ lineární kombinací pøedcházejících vektorù v posloupnosti $\bAA_{*1},\bAA_{*2},\dots,\bAA_{*n}$, tj. $\bAA_{*j}\in\LLL(\bAA_{*1},\bAA_{*2},\dots,\bAA_{*j-1})$. Je-li nìkterý z vektorù $\bAA_{*1},\bAA_{*2},\dots,\bAA_{*j-1}$ lineární kombinací pøedcházejících vektorù, mù¾eme jej z posloupnosti vy¹krtnout, ani¾ zmìníme lineární obal této posloupnosti. To znamená, ¾e $\bAA_{*j}\in\LLL(\bAA_{*j_1},\bAA_{*j_2},\dots,\bAA_{*j_k})$, kde $\UU_{*j_1},\UU_{*j_2},\dots,\UU_{*j_k}$ jsou v¹echny bázové sloupce v matici $\UU$, které jsou vlevo od sloupce $\UU_{*j}$. Platí proto
\[
\bAA_{*j}=\sum_{p=1}^k d_p\bAA_{*j_p}
\]
pro nìjaké skaláry $d_p\in\TT$, $p=1,\dots,k$. Opìt podle Tvrzení~\ref{T:sloupcovevztahy} platí
\[
\UU_{*j}=\sum_{p=1}^k d_p\UU_{*j_p}=\sum_{p=1}^k d_p\ee_p=(d_1,d_2,\dots,d_k,0,\dots,0)^T.
\]
Poslední rovnost tak jednoznaènì urèuje ka¾dý nebázový vektor matice $\UU$. V¹echny sloupcové vektory matice $\UU$, a tedy také celá matice $\UU$, jsou tak jednoznaènì urèené maticí $\bAA$. Tím jsme doplnili {\bf dùkaz Tvrzení~\ref{T:EAunique}}.

Nyní také mù¾eme snadno doplnit {\bf dùkaz Tvrzení~\ref{T:pivotposition}}. Pokud pøevedeme matici $\bAA$ pomocí elementárních øádkových úprav do matice $\EE$ v øádkovì odstupòovaném tvaru, mù¾eme matici $\EE$ dále pøevést do redukovaného øádkovì odstupòovaného tvaru $\UU$ tak, ¾e napøed vynásobíme ka¾dý nenulový øádek matice $\EE$ vhodným nenulovým èíslem tak, aby byl pivot rovný $1$. Potom vynulujeme prvky nad ka¾dým pivotem pomocí elementárních øádkových úprav tøetího druhu. Tìmito úpravami se nezmìní poloha pivotù, pivoty v matici $\UU$ budou na stejných místech, jako pivoty v matici $\EE$. Proto¾e je matice $\UU$ urèená maticí $\bAA$ jednoznaènì, jsou také místa pro pivoty v matici $\UU$ urèená jednoznaènì. Proto jsou i místa pro pivoty v matici $\EE$ urèená jednoznaènì.

Pokud nìjaké tvrzení dokazujeme mnohem pozdìji, ne¾ jsme je zformulovali, a pou¾íváme k tomu dal¹í tvrzení, která jsme mezitím dokázali, musíme v¾dy dát pozor, abychom neudìlali \emph{dùkaz kruhem}. To znamená, jestli k dùkazu nepou¾íváme nìjaké tvrzení, které jsme dokázali pomocí nedokázaného tvrzení, které se sna¾íme dokázat teprve nyní. V na¹em pøípadì je ovìøení, ¾e jsme nepostupovali kruhem, pomìrnì jednoduché. K dùkazu Tvrzení~\ref{T:EAunique} a Tvrzení~\ref{T:pivotposition} jsme potøebovali Tvrzení~\ref{T:sloupcovevztahy}, které závisí pouze na definici lineární kombinace vektorù a vlastnostech souèinu matic z Tvrzení~\ref{T:strukturasoucinu}, které vycházelo pouze z definice souèinu matic. Dále jsme potøebovali nìjaké výsledky o lineárních obalech z páté a ¹esté kapitoly, která jsme dokázali pouze na základì axiomù vektorového prostoru. Ani v jednom pøípadì jsme nepotøebovali nic, co by jakýmkoliv zpùsobem vycházelo z jednoznaènosti matice v redukovaném øádkovì odstupòovaném tvaru, kterou dostaneme z dané matice $\bAA$ pomocí elementárních øádkových úprav.

\bigskip
\noindent{\bf Znovu o podprostorech urèených maticí}
\smallskip

Zaèneme tvrzením, které udává jak najít bázi levého nulového prostoru $\MMM(\bAA)$ matice $\bAA$.

\begin{proposition}\label{T:levynulprostor}
Pøedpokládáme, ¾e $\bAA$ je matice hodnosti $r(\bAA)=r$, tvaru $m\times n$ a s prvky z tìlesa $\TT$. Je-li $\PP$ regulární matice øádu $m$ taková, ¾e souèin $\PP\bAA=\UU$ je v øádkovì odstupòovaném tvaru, pak 
\[
\MMM(\bAA)=\LLL(\PP_{r+1*},\PP_{r+2*},\dots,\PP_{m*}),
\]  
neboli levý nulový prostor $\MMM(\bAA)$ matice $\bAA$ se rovná lineárnímu obalu posledních $m-r$ øádkù matice $\PP$.

Dále platí, ¾e $\dim\,\MMM(\bAA)=m-r$.
\end{proposition}

\begin{proof}
Matici $\UU$ napí¹eme ve tvaru
\[
\left(\begin{array}{c}
\CC\\
\nul
\end{array}\right),
\]
kde $\CC$ je matice tvaru $r\times n$ a hodnosti $r$ (nebo» øádky matice $\CC$ jsou lineárnì nezávislé) a $\nul$ je nulová matice tvaru $(m-r)\times n$.

Podobnì také matici $\PP$ napí¹eme v blokovém tvaru
\[
\left(\begin{array}{c}
\PP_1\\
\PP_2
\end{array}\right),
\]
kde matice $\PP_1$ má tvar $r\times m$ a matice $\PP_2$ má tvar $(m-r)\times m$.

Z rovnosti $\PP\bAA=\UU$ vyplývá $\PP_2\bAA=\nul$, a to znamená, ¾e øádkový prostor
\[
\RRR(\PP_2)=\LLL(\PP_{r+1*},\PP_{r+2*},\dots,\PP_{m*})\subseteq\MMM(\bAA).
\]

Pro dùkaz opaèné inkluze si napí¹eme také inverzní matici $\PP^{-1}$ v blokovém tvaru $\PP^{-1}=\left(\begin{array}{cc}\QQ_1&\QQ_2\end{array}\right)$, kde matice $\QQ_1$ má tvar $m\times r$ a matice $\QQ_2$ musí proto mít tvar $m\times(m-r)$. Potom platí
\[
\PP^{-1}\UU=\left(\begin{array}{cc}\QQ_1&\QQ_2\end{array}\right)
\left(\begin{array}{c}
\CC\\
\nul
\end{array}\right)=\QQ_1\CC+\QQ_2\nul=\QQ_1\CC.
\]

Dále z rovnosti
\[
\II_m=\PP\PP^{-1}=
\left(\begin{array}{c}
\PP_1\\
\PP_2
\end{array}\right)
\left(\begin{array}{cc}\QQ_1&\QQ_2\end{array}\right)=
\left(\begin{array}{cc}\PP_1\QQ_1&\PP_1\QQ_2\\
                       \PP_2\QQ_1&\PP_2\QQ_2\end{array}\right)
\]
plyne $\PP_1\QQ_1=\II_r$. Vynásobíme-li matice $\PP^{-1}$ a $\PP$ v opaèném poøadí, dostaneme
\[
\II_m=\PP^{-1}\PP=\left(\begin{array}{cc}\QQ_1&\QQ_2\end{array}\right)
\left(\begin{array}{c}
\PP_1\\
\PP_2
\end{array}\right)=
\QQ_1\PP_1+\QQ_2\PP_2,
\]
tj. $\QQ_1\PP_1=\II_m-\QQ_2\PP_2$.

Abychom dokázali opaènou inkluzi $\MMM(\bAA)\subseteq\LLL(\PP_{r+1*},\PP_{r+2*},\dots,\PP_{m*})$, vezmeme libovolný vektor
\[
\vey=(c_1,c_2,\dots,c_m)\in\MMM(\bAA).
\]
To znamená, ¾e
\[
\nul=\vey\bAA=\vey\PP^{-1}\UU=\vey\QQ_1\CC.
\]

Proto¾e $r(\UU)=r$, plyne odtud a z druhé èásti Cvièení~\ref{C:nuloveprostory}, ¾e $\vey\QQ_1=\nul$. Tuto rovnost vynásobíme zprava maticí $\PP_1$ a dostaneme rovnost
\[
\nul=\nul\PP_1=\vey\QQ_1\PP_1=\vey(\II_m-\QQ_2\PP_2)=\vey-\vey\QQ_2\PP_2, 
\] 
neboli
\[
\vey=\vey\QQ_2\PP_2=(\vey\QQ_2)\PP_2.
\]
Odtud plyne, ¾e $\vey\in\RRR(\PP_2)$, tj.
\[
\vey\in\LLL(\PP_{r+1*},\PP_{r+2*},\dots,\PP_{m*}).
\]

K dùkazu druhé èásti tvrzení staèí si uvìdomit, ¾e øádkové vektory regulární matice jsou lineárnì nezávislé podle Cvièení~\ref{C:nezradky}.
\end{proof}

Pou¾ijeme-li pøedchozí tvrzení na transponovanou matici $\bAA^T$, dostaneme následující dùsledek.

\begin{corollary}\label{C:nulprostor}
Pro ka¾dou matici $\bAA$ tvaru $m\times n$ s prvky z tìlesa $\TT$ platí $\dim\,\SSS(\bAA)=n-r(\bAA)$. $\Box$
\end{corollary}

\begin{uloha}\label{U:levynulprostor}
Najdìte nìjakou generující mno¾inu levého nulového prostoru $\MMM(\bAA)$ matice
\[
\bAA=\left(\begin{array}{cccc}
1&2&2&3\\
2&4&1&3\\
3&6&1&4
\end{array}\right).
\]
\end{uloha}

\begin{reseni}
Najdeme posloupnost elementárních matic $\EE_k,\dots,\EE_1$ øádu $m$, pro kterou platí $\EE_k\cdots\EE_1\bAA=\UU$, kde $\UU$ je matice v øádkovì odstupòovaném tvaru. Potom platí $\PP=\EE_k\cdots\EE_1\II_3$, tj. matici $\PP$ dostaneme tak, ¾e stejnou posloupnost elementárních øádkových úprav udìláme na jednotkovou matici $\II_3$. Postupujeme tedy obdobnì jako pøi výpoètu inverzní matice. Pøipí¹eme si jednotkovou matici $\II_3$ k matici $\bAA$ a dìláme tyté¾ elementární øádkové úpravy souèasnì na obì matice $\bAA$ a $\II_3$:
\[
\left(\begin{array}{ccccccc}
1&2&2&3&1&0&0\\
2&4&1&3&0&1&0\\
3&6&1&4&0&0&1
\end{array}\right)\sim
\left(\begin{array}{ccccccc}
1&2&0&1&-1/3&2/3&0\\
0&0&1&1&2/3&-1/3&0\\
0&0&0&0&1/3&-5/3&1
\end{array}\right).
\] 
Proto
\[
\PP=\left(\begin{array}{cccc}
-1/3&2/3&0\\
2/3&-1/3&0\\
1/3&-5/3&1
\end{array}\right)
\]
a tedy $\MMM(\bAA)=\LLL((1/3,-5/3,1))$.
\end{reseni}

Následující tvrzení shrnuje dosud získané poznatky o dimenzi a bázích ètyøech podprostorù definovaných maticí.

\begin{proposition}\label{T:ctyriprostory}
Pøedpokládáme, ¾e $\bAA$ je matice hodnosti $r(\bAA)=r$, tvaru $m\times n$ a s prvky z tìlesa $\TT$. Potom platí
\begin{itemize}
	\item $\dim\,\SSS(\bAA)=r$ a bázové sloupce matice $\bAA$ tvoøí bázi prostoru $\SSS(\bAA)$.
\end{itemize}

Jestli¾e $\PP$ je regulární matice øádu $m$ a souèin $\PP\bAA=\UU$ je v øádkovì odstupòovaném tvaru, pak
\begin{itemize}
	\item $\dim\,\RRR(\bAA)=r$ a nenulové øádky matice $\UU$ tvoøí bázi prostoru $\RRR(\bAA)$,
	\item $\dim\,\MMM(\bAA)=m-r$ a posledních $m-r$ øádkù matice $\PP$ tvoøí bázi prostoru $\MMM(\bAA)$.
\end{itemize}

A nakonec, je-li $\vex=x_{f_1}\veh_1+x_{f_2}\veh_2+\cdots+x_{f_{n-r}}\veh_{n-r}$ obecné øe¹ení homogenní soustavy $\bAA\vex=\nul$, pak platí
\begin{itemize}
	\item $\dim\,\NNN(\bAA)=n-r$ a vektory $\veh_1,\veh_2,\dots,\veh_{n-r}$ tvoøí bázi prostoru $\NNN(\bAA)$.
\end{itemize}
\end{proposition}

\begin{proof}
Jediné, co jsme je¹tì nedokázali, je lineární nezávislost vektorù $\veh_1,\veh_2,\dots,\veh_{n-r}$. Z Dùsledku~\ref{C:nulprostor} plyne, ¾e $\dim\,\NNN(\bAA)=n-r$. Proto¾e vektory $\veh_1,\veh_2,\dots,\veh_{n-r}$ generují podprostor $\NNN(\bAA)$ podle Vìty~\ref{T:homo}, plyne jejich lineární nezávislost z druhé èásti Tvrzení~\ref{T:obazich}.
\end{proof}

Následující dùsledek je natolik dùle¾itý, ¾e jej uvedeme jako vìtu.

\begin{theorem}\label{V:rankanulita}
Pro ka¾dou matici tvaru $m\times n$ s prvky z tìlesa $\TT$ platí
\[
\dim\,\SSS(\bAA)+\dim\,\NNN(\bAA)=n.
\]
$\Box$
\end{theorem}

\begin{cviceni}
Na základì øe¹ení Úlohy~\ref{U:levynulprostor} zformulujte analogický algoritmus pro øe¹ení homogenní soustavy $m$ lineárních rovnic o $n$ neznámých $\bAA\vex=\nul$. Porovnejte výpoèetní nároènost tohoto algoritmu s výpoèetní nároèností algoritmu zalo¾eného na Gaussovì eliminaci a zpìtné substituci.
\end{cviceni}

\bigskip
\noindent{\bf Hodnost souèinu matic}
\smallskip

\begin{proposition}\label{T:hodnostsoucinu}
Jsou-li $\bAA$ matice tvaru $m\times n$ a $\BB$ matice tvaru $n\times p$, obì s prvky z tìlesa $\TT$, pak platí
\[
r(\bAA\BB)=r(\BB)-\dim\,\NNN(\bAA)\cap\SSS(\BB).
\]
\end{proposition}

\begin{proof}

\end{proof}
\end{document}

Také dal¹í tvrzení je pøímým dùsledkem definic a ji¾ známých vlastností matic.

\begin{proposition}\label{T:equalranges}
Pro dvì matice $\bAA$ a $\BB$ stejného tvaru $m\times n$ s prvky z tìlesa $\TT$ platí
\begin{itemize}
	\item $\SSS(\bAA)=\SSS(\BB)$ právì kdy¾ existuje regulární matice $\PP$ øádu $m$, pro kterou platí $\bAA=\BB\PP$,
	\item $\RRR(\bAA)=\RRR(\BB)$ právì kdy¾ existuje regulární matice $\QQ$ øádu $n$, pro kterou platí $\bAA=\QQ\BB$.
\end{itemize}
\end{proposition}

